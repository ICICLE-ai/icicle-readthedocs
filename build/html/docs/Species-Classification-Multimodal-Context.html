<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Species Classification using Multimodal Heterogeneous Context &#8212; ICICLE-READTHEDOCS  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=cb25574f" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Store_Closure_Website (Version 1)" href="Store_Closure_Website.html" />
    <link rel="prev" title="Region2vec" href="Region2vec.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="species-classification-using-multimodal-heterogeneous-context">
<span id="id1"></span><h1>Species Classification using Multimodal Heterogeneous Context<a class="headerlink" href="#species-classification-using-multimodal-heterogeneous-context" title="Link to this heading">¶</a></h1>
<p>We present a species classification model that utilizes heterogeneous image contexts organized in a multimodal knowledge graph. The multimodal knowledge graph may include diverse forms of heterogeneous contexts that pertain to different modalities, such as numerical information for locations and time, categorical data for species/taxon IDs, and visual content such as images.</p>
<p><strong>Authors</strong>: Vardaan Pahuja, Weidi Luo, Yu Gu, Cheng-Hao Tu, Hong-You Chen, Tanya Berger-Wolf, Charles Stewart, Song Gao, Wei-Lun Chao, Yu Su</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<section id="species-classification-on-a-single-image-input">
<h3>Species classification on a single image input<a class="headerlink" href="#species-classification-on-a-single-image-input" title="Link to this heading">¶</a></h3>
<p>Note: Some sample camera trap species images are available in the dir. <code class="docutils literal notranslate"><span class="pre">data/sample_images/</span></code>. During training, we utlize multiple heterogeneous contexts in the multimodal KG. However, at inference time, only the image is used to perform species classification.</p>
<ol class="arabic simple">
<li><p>Download the required data <code class="docutils literal notranslate"><span class="pre">bash</span> <span class="pre">download_data.sh</span></code>.</p></li>
<li><p>Evaluate the pretrained model on a given image.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">eval_image</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">ckpt</span><span class="o">-</span><span class="n">path</span> <span class="o">&lt;</span><span class="n">PATH</span> <span class="n">TO</span> <span class="n">TRAINED</span> <span class="n">CKPT</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">img</span><span class="o">-</span><span class="n">path</span> <span class="o">&lt;</span><span class="n">PATH</span> <span class="n">TO</span> <span class="n">IMG</span> <span class="n">FILE</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="data-preprocessing">
<h2>Data Preprocessing<a class="headerlink" href="#data-preprocessing" title="Link to this heading">¶</a></h2>
<p>This will download the iWildCam2020-WILDS dataset and Open Tree of Life taxonomy and pre-process them.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bash</span> <span class="n">preprocess</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Note: The dir. <code class="docutils literal notranslate"><span class="pre">data/iwildcam_v2.0/train/</span></code> contains images for all splits.</p>
</section>
<section id="training-a-model-from-scratch">
<h2>Training a model from scratch<a class="headerlink" href="#training-a-model-from-scratch" title="Link to this heading">¶</a></h2>
<p>We consider different training settings that comprise of combination of different context types such as taxonomy, location, and time.</p>
<section id="train-using-only-images-linked-to-species-labels">
<h3>Train using only images linked to species labels<a class="headerlink" href="#train-using-only-images-linked-to-species-labels" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">u</span> <span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">iwildcam_v2</span><span class="mf">.0</span><span class="o">/</span> <span class="o">--</span><span class="n">img</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">iwildcam_v2</span><span class="mf">.0</span><span class="o">/</span><span class="n">train</span><span class="o">/</span> <span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="nb">dir</span> <span class="n">CKPT_DIR</span> <span class="o">&gt;</span> <span class="n">CKPT_DIR</span><span class="o">/</span><span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</section>
<section id="train-using-species-labels-and-taxonomy-contexts">
<h3>Train using species labels and taxonomy contexts<a class="headerlink" href="#train-using-species-labels-and-taxonomy-contexts" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">u</span> <span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">iwildcam_v2</span><span class="mf">.0</span><span class="o">/</span> <span class="o">--</span><span class="n">img</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">iwildcam_v2</span><span class="mf">.0</span><span class="o">/</span><span class="n">train</span><span class="o">/</span> <span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="nb">dir</span> <span class="n">CKPT_DIR</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="nb">id</span><span class="o">-</span><span class="nb">id</span> <span class="o">&gt;</span> <span class="n">CKPT_DIR</span><span class="o">/</span><span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</section>
<section id="train-using-species-labels-and-location-contexts">
<h3>Train using species labels and location contexts<a class="headerlink" href="#train-using-species-labels-and-location-contexts" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">u</span> <span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">iwildcam_v2</span><span class="mf">.0</span><span class="o">/</span> <span class="o">--</span><span class="n">img</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">iwildcam_v2</span><span class="mf">.0</span><span class="o">/</span><span class="n">train</span><span class="o">/</span> <span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="nb">dir</span> <span class="n">CKPT_DIR</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">image</span><span class="o">-</span><span class="n">location</span> <span class="o">&gt;</span> <span class="n">CKPT_DIR</span><span class="o">/</span><span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</section>
<section id="train-using-species-labels-and-time-contexts">
<h3>Train using species labels and time contexts<a class="headerlink" href="#train-using-species-labels-and-time-contexts" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">u</span> <span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">iwildcam_v2</span><span class="mf">.0</span><span class="o">/</span> <span class="o">--</span><span class="n">img</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">iwildcam_v2</span><span class="mf">.0</span><span class="o">/</span><span class="n">train</span><span class="o">/</span> <span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="nb">dir</span> <span class="n">CKPT_DIR</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">image</span><span class="o">-</span><span class="n">time</span> <span class="o">&gt;</span> <span class="n">CKPT_DIR</span><span class="o">/</span><span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</section>
<section id="train-using-species-labels-taxonomy-and-time-contexts">
<h3>Train using species labels, taxonomy, and time contexts<a class="headerlink" href="#train-using-species-labels-taxonomy-and-time-contexts" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">u</span> <span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">iwildcam_v2</span><span class="mf">.0</span><span class="o">/</span> <span class="o">--</span><span class="n">img</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">iwildcam_v2</span><span class="mf">.0</span><span class="o">/</span><span class="n">train</span><span class="o">/</span> <span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="nb">dir</span> <span class="n">CKPT_DIR</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="nb">id</span><span class="o">-</span><span class="nb">id</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">image</span><span class="o">-</span><span class="n">time</span> <span class="o">&gt;</span> <span class="n">CKPT_DIR</span><span class="o">/</span><span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</section>
<section id="train-using-species-labels-taxonomy-and-location-contexts">
<h3>Train using species labels, taxonomy, and location contexts<a class="headerlink" href="#train-using-species-labels-taxonomy-and-location-contexts" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">u</span> <span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">iwildcam_v2</span><span class="mf">.0</span><span class="o">/</span> <span class="o">--</span><span class="n">img</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">iwildcam_v2</span><span class="mf">.0</span><span class="o">/</span><span class="n">train</span><span class="o">/</span> <span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="nb">dir</span> <span class="n">CKPT_DIR</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="nb">id</span><span class="o">-</span><span class="nb">id</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">image</span><span class="o">-</span><span class="n">location</span> <span class="o">&gt;</span> <span class="n">CKPT_DIR</span><span class="o">/</span><span class="n">log</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</section>
<section id="evaluate-a-model-specify-split-val-test-id-val-id-test">
<h3>evaluate a model (specify split=val/test/id_val/id_test)<a class="headerlink" href="#evaluate-a-model-specify-split-val-test-id-val-id-test" title="Link to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="nb">eval</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">ckpt</span><span class="o">-</span><span class="n">path</span> <span class="o">&lt;</span><span class="n">PATH</span> <span class="n">TO</span> <span class="n">TRAINED</span> <span class="n">CKPT</span><span class="o">&gt;</span> <span class="o">--</span><span class="n">split</span> <span class="n">test</span> <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">iwildcam_v2</span><span class="mf">.0</span><span class="o">/</span> <span class="o">--</span><span class="n">img</span><span class="o">-</span><span class="nb">dir</span> <span class="n">data</span><span class="o">/</span><span class="n">iwildcam_v2</span><span class="mf">.0</span><span class="o">/</span><span class="n">train</span><span class="o">/</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="acknowledgements">
<h1>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Link to this heading">¶</a></h1>
<p><em>This work has been funded by grants from the National Science Foundation, including the ICICLE AI Institute (OAC 2112606)</em></p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">ICICLE-READTHEDOCS</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">AI for CI-for-AI</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ICICLE_Foodshed_Parser.html">Constrained Language Models Yield Few-Shot Semantic Parsers</a></li>
<li class="toctree-l1"><a class="reference internal" href="PPOD_CA.html">PPOD_CA</a></li>
<li class="toctree-l1"><a class="reference internal" href="Region2vec.html">Region2vec</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Species Classification using Multimodal Heterogeneous Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="#acknowledgements">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="Store_Closure_Website.html">Store_Closure_Website (Version 1)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AI for CI-for-AI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../harp/README.html">HARP - HPC Application Runtime Predictor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../harp/README.html#acknowledgements">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../iSpLib/README.html">iSpLib - An Intelligent Sparse Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../iSpLib/README.html#acknowledgements">Acknowledgements</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software Architecture and Design</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tapis-project/README.html">Base ICICLE Tapis Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../event-engine/README.html">Event Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../event-engine/README.html#acknowledgement">Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hello_icicle_auth_clients/README.html">Hello ICICLE Authentication Clients</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="Region2vec.html" title="previous chapter">Region2vec</a></li>
      <li>Next: <a href="Store_Closure_Website.html" title="next chapter">Store_Closure_Website (Version 1)</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, ICICLE.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/docs/Species-Classification-Multimodal-Context.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>