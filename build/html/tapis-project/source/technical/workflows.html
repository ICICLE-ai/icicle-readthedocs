<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Workflows &mdash; ICICLE-READTHEDOCS  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="https://aiinstitutes.org/wp-content/uploads/2022/07/icicle.jpeg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">AI for CI-for-AI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/ICICLE_Foodshed_Parser.html">Constrained Language Models Yield Few-Shot Semantic Parsers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/PPOD_CA.html">PPOD_CA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/Region2vec.html">Region2vec</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/Species-Classification-Multimodal-Context.html">Species Classification using Multimodal Heterogeneous Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/Store_Closure_Website.html">Store_Closure_Website (Version 1)</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ICICLE-READTHEDOCS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Workflows</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/tapis-project/source/technical/workflows.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="workflows">
<span id="id1"></span><h1>Workflows<a class="headerlink" href="#workflows" title="Link to this heading"></a></h1>
<p>The Workflows Service is an API and workflow exectuor that enables users to automate and execute their research computing
tasks in the Tapis Ecosystem.</p>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>Before getting into the details about how to create and run a workflow, here are some important concepts you must understand in order to properly use <em>Tapis Workflows</em></p>
<section id="important-concepts">
<h3>Important Concepts<a class="headerlink" href="#important-concepts" title="Link to this heading"></a></h3>
<ul>
<li><p><strong>Group</strong>: A <em>group</em> is a collection of Tapis users that own or have access to workflow resources. In order to create your first workflow, you must first belong to, or create your own <em>group</em>.</p></li>
<li><p><strong>Pipeline</strong>: A <em>pipeline</em> is a collection of tasks and a set of rules governing how those tasks are to be executed.</p></li>
<li><p><strong>Archive</strong>: An <em>archive</em> is the storage medium for the results created during a pipeline run. By default, the results produced by each task are deleted at the end of a pipeline run.</p></li>
<li><p><strong>Identity</strong>: An <em>identity</em> is a mapping between a <em>Tapis identity</em> and an <em>external</em> identity. An example of an external identity is a <em>Github</em> account or <em>Dockerhub</em> account.</p></li>
<li><p><strong>Task</strong>: <em>Tasks</em> are discrete units of work performed during the execution of a workflow. They can be represented as nodes on a directed acyclic graph (DAG), with the order of their execution determined by their dependencies, and where all tasks without dependencies are executed first. There are different types of <em>tasks</em> that users can leverage to perform diffent types of work. These are called task primitives and they will be discussed in detail later:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Supported</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>image_build</p></td>
<td><p>Builds Docker and Singularity images from recipe files and pushes the to repositories</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>request</p></td>
<td><p>Sends requests using various protocols to resources external to the workflow (Only HTTP protocol and GET currently fully supported)</p></td>
<td><p>partial</p></td>
</tr>
<tr class="row-even"><td><p>tapis_job</p></td>
<td><p>Submits a <em>Tapis job</em></p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>tapis_actor</p></td>
<td><p>Executes an <em>Tapis actor</em></p></td>
<td><p>no</p></td>
</tr>
<tr class="row-even"><td><p>container_run</p></td>
<td><p>Runs a container based on the provided image and tag</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-odd"><td><p>function</p></td>
<td><p>Runs user-defined code in the language and runtime of their choice</p></td>
<td><p>yes</p></td>
</tr>
</tbody>
</table>
</li>
</ul>
<hr class="docutils" />
</section>
</section>
<hr class="docutils" />
<section id="quick-start">
<h2>Quick start<a class="headerlink" href="#quick-start" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>We will be creating a pipeline that</dt><dd><ul class="simple">
<li><p>pulls code from a private Github repository</p></li>
<li><p>builds an image from a Dockerfile located in that source code</p></li>
<li><p>then pushes the resultant image to a Dockerhub image registry</p></li>
</ul>
</dd>
</dl>
<p>In the examples below we assume you are using the TACC tenant with a base URL of <code class="docutils literal notranslate"><span class="pre">tacc.tapis.io</span></code> and that you have
authenticated using PySDK or obtained an authorization token and stored it in the environment variable JWT,
or perhaps both.</p>
<section id="summary-of-steps">
<h3>Summary of Steps<a class="headerlink" href="#summary-of-steps" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Create a <em>Group</em></p></li>
<li><p>Create the <em>Identities</em> that the workflow executor will use to access both Github and Dockerhub on your behalf</p></li>
<li><p>Create an <em>Archive</em> to which the results of the pipeline run will be persisted</p></li>
<li><p>Create the <em>Pipeline</em> and its <em>Tasks</em> which act as instructions to the workflow executor</p></li>
</ol>
</section>
<section id="creating-a-group">
<h3>Creating a Group<a class="headerlink" href="#creating-a-group" title="Link to this heading"></a></h3>
<p>Create a local file named <code class="docutils literal notranslate"><span class="pre">group.json</span></code> with json similar to the following:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;group_id&gt;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;users&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;user_id&gt;&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;is_admin&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You do not need to add your own Tapis id to the users list. The owner of the Group is added by default.</p>
</div>
<p>Replace <em>&lt;group_id&gt;</em> with your desired group id and <em>&lt;user_id&gt;</em> in the user objects with
the tapis user ids of the other users that you want to grant access to this group’s workflow resources.</p>
<p>Submit the definition.</p>
</section>
<hr class="docutils" />
<section id="creating-identities">
<h3>Creating Identities<a class="headerlink" href="#creating-identities" title="Link to this heading"></a></h3>
<p>We will be creating 2 identity mappings. One for Github and one for Dockerhub. After creating
the identities, we will need to retrieve the UUIDs of the newly created identities. You can do
this in a separate call, or simple grab the UUID from the url in the result after each operation.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do <strong>NOT</strong> commit these files to source control!</p>
</div>
<p>Create the first file named <code class="docutils literal notranslate"><span class="pre">github-identity.json</span></code> with the following json:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;github&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;my-github-identity&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;My github identity&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;credentials&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;github_username&gt;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;personal_access_token&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;github_personal_access_token&gt;&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then submit the definition</p>
<p>Create the second file named <code class="docutils literal notranslate"><span class="pre">dockerhub-identity.json</span></code> with the following json</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dockerhub&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;my-dockerhub-identity&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;My Dockerhub identity&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;credentials&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;docerkhub_username&gt;&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;token&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;dockerhub_access_token&gt;&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then submit the definition</p>
</section>
<hr class="docutils" />
<section id="creating-an-archive">
<h3>Creating an Archive<a class="headerlink" href="#creating-an-archive" title="Link to this heading"></a></h3>
<p>In this step, we create the Archive. The results of the pipeline run will be persisted to the archive.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This step requires that you have “<strong>MODIFY</strong>” permissions on some Tapis System. If you do not have access to one, you can create it following the instruction in the “Systems” section.</p>
</div>
<p>Create a local file named <code class="docutils literal notranslate"><span class="pre">archive.json</span></code> with json similar to the following:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;my-sample-archive&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;system&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;system_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;your-tapis-system-id&gt;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;archive_dir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/workflows/archive/&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The archive_dir is relative to your system’s rootDir. You can change this value to whatever you like.</p>
</div>
</section>
<hr class="docutils" />
<section id="creating-a-pipeline">
<h3>Creating a Pipeline<a class="headerlink" href="#creating-a-pipeline" title="Link to this heading"></a></h3>
<p>In this step, we define the pipeline. There are many more properties that can be defined
at both the pipeline and task level, but for simplicity, we will be leaving them out.</p>
<p>Create a local file named <code class="docutils literal notranslate"><span class="pre">pipeline.json</span></code> with json similar to the following:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;my-sample-workflow&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;archives&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;&lt;archive_id&gt;&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">  </span><span class="nt">&quot;tasks&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;my-image-build&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;image_build&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;builder&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;kaniko&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;context&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;branch&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;main&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;build_file_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;path/to&gt;/Dockerfile&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;sub_path&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;github&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;account&gt;/&lt;repo&gt;&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;visibility&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;private&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;identity_uuid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;github_identity_uuid&gt;&quot;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;destination&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;tag&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;some_image_tag&gt;&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dockerhub&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;account&gt;/&lt;registry&gt;&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;identity_uuid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;dockerhub_identity_uuid&gt;&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Go through the definition above and replace all of the placeholders with the correct values.</p>
</section>
<hr class="docutils" />
<section id="triggering-the-workflow">
<h3>Triggering the Workflow<a class="headerlink" href="#triggering-the-workflow" title="Link to this heading"></a></h3>
<p>Now it’s time to run the pipeline.</p>
<p>After the pipeline has finished running, take a look in your Dockerhub image repository
and you will find your newly pushed image.</p>
<p>If you SSH into the <em>Tapis System</em> that you selected as your archive, you will also find
that you have some new directories and files in your <strong>rootDir</strong>;</p>
<p><code class="docutils literal notranslate"><span class="pre">/workflows/archive/&lt;UUID</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">pipeline</span> <span class="pre">run&gt;/my-image-build/output/.stdout</span></code>.</p>
<p>If you want to find the output for any task for a given pipeline run, simply navigate
to the archive directory, <code class="docutils literal notranslate"><span class="pre">cd</span></code> into directory with the pipline run UUID, then <code class="docutils literal notranslate"><span class="pre">cd</span></code> into
the directory with that task’s name. Inside the <code class="docutils literal notranslate"><span class="pre">output/</span></code> directory, you will find all of
the data created by that task.</p>
</section>
</section>
<hr class="docutils" />
<section id="groups">
<h2>Groups<a class="headerlink" href="#groups" title="Link to this heading"></a></h2>
<p>A <em>group</em> is a collection of Tapis users that own or have access to workflow resources.
In order to create your first workflow, you must first belong to, or create a <em>group</em>. A group
and all of its resources are tied to a particular tenant which is resolved from the url of the
request to create the group.</p>
<p>Groups have an <em>id</em> which must be unique within the tenant to which it belongs. Groups
also have <em>users</em>. This is a simple list of user objects where <code class="docutils literal notranslate"><span class="pre">user.username</span></code> is the Tapis
username/id and <code class="docutils literal notranslate"><span class="pre">is_admin</span></code> is a Boolean. Users with <strong>admin</strong> permissions i.e. <code class="docutils literal notranslate"><span class="pre">is_admin</span> <span class="pre">==</span> <span class="pre">true</span></code> are able to add and
remove users from a group. Only the <strong>owner</strong> of a group may add or delete other admin users.</p>
<section id="group-attributes-table">
<h3>Group Attributes Table<a class="headerlink" href="#group-attributes-table" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>String</p></td>
<td><p>my.group</p></td>
<td><ul class="simple">
<li><p>Must be unique within the tenant.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>owner</p></td>
<td><p>String</p></td>
<td><p>someuser</p></td>
<td><ul class="simple">
<li><p>Cannot be removed from group unless ownership is transferred.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>tenant_id</p></td>
<td><p>String</p></td>
<td><p>tacc</p></td>
<td><ul class="simple">
<li><p>Automatically set at create-time. Determined from the url of the request. Does not need to be specified.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>uuid</p></td>
<td><p>String(UUIDv4)</p></td>
<td><p>e48ada7a-56b4-4d48-974c-7574d51a8789</p></td>
<td><ul class="simple">
<li><p>Automatically set at create-time</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>users</p></td>
<td><p>Array(Users)</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<section id="groupuser-attributes-table">
<h4>GroupUser Attributes Table<a class="headerlink" href="#groupuser-attributes-table" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>username</p></td>
<td><p>String</p></td>
<td><p>jsmith</p></td>
<td><ul class="simple">
<li><p>Must be unique within the group.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>is_admin</p></td>
<td><p>Boolean</p></td>
<td><p>True</p></td>
<td><ul class="simple">
<li><p>Must be an admin or group owner to add a user as admin</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>uuid</p></td>
<td><p>String(UUIDv4)</p></td>
<td><p>e48ada7a-56b4-4d48-974c-7574d51a8789</p></td>
<td><ul class="simple">
<li><p>Automatically set at create-time</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>group</p></td>
<td><p>String(UUIDv4)</p></td>
<td><p>e48ada7a-56b4-4d48-974c-7574d51a8789</p></td>
<td><ul class="simple">
<li><p>Automatically set at create-time</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="retrieval">
<h3>Retrieval<a class="headerlink" href="#retrieval" title="Link to this heading"></a></h3>
<p>Retrieve details for a specific group</p>
<p>The response should look similar to the following</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;success&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Success&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;result&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;my.group&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;owner&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;someuser&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tenant_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tacc&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;uuid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;f60fdf8a-4ceb-4273-b49f-4c0dd94111c3&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;users&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;group&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;f60fdf8a-4ceb-4273-b49f-4c0dd94111c3&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;someuser&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;is_admin&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;uuid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;c6b7acfd-da4b-4a1d-acbd-adbfa6aa4057&quot;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;group&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;f60fdf8a-4ceb-4273-b49f-4c0dd94111c3&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;anotheruser&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;is_admin&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;uuid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;d6ca476a-2c19-4168-8054-264bcaaa70e7&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="deletion">
<h3>Deletion<a class="headerlink" href="#deletion" title="Link to this heading"></a></h3>
<p>Groups may only be deleted by the group <strong>owner</strong>. Upon deletion of a group, every workflow
object owned by the group will also be deleted; pipelines, tasks, archives, etc.</p>
</section>
</section>
<hr class="docutils" />
<section id="pipelines">
<h2>Pipelines<a class="headerlink" href="#pipelines" title="Link to this heading"></a></h2>
<p>A <em>pipeline</em> is a collection of tasks and a set of rules governing how those tasks are to be executed.</p>
<section id="pipeline-attributes-table">
<h3>Pipeline Attributes Table<a class="headerlink" href="#pipeline-attributes-table" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>String</p></td>
<td><p>my.pipeline</p></td>
<td><ul class="simple">
<li><p>Must be unique within the group</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>uuid</p></td>
<td><p>String(UUIDv4)</p></td>
<td><p>e48ada7a-56b4-4d48-974c-7574d51a8789</p></td>
<td><ul class="simple">
<li><p>Globally unique identifier for the pipeline</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>owner</p></td>
<td><p>String</p></td>
<td><p>jsmith</p></td>
<td><ul class="simple">
<li><p>The only user that can delete the pipeline</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>group</p></td>
<td><p>String(UUIDv4)</p></td>
<td><p>e48ada7a-56b4-4d48-974c-7574d51a8789</p></td>
<td><ul class="simple">
<li><p>The uuid of the group that owns this pipeline</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>last_run</p></td>
<td><p>String(UUIDv4)</p></td>
<td><p>e48ada7a-56b4-4d48-974c-7574d51a8789</p></td>
<td><ul class="simple">
<li><p>The UUID of the previous pipeline run</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>current_run</p></td>
<td><p>String(UUIDv4)</p></td>
<td><p>e48ada7a-56b4-4d48-974c-7574d51a8789</p></td>
<td><ul class="simple">
<li><p>The UUID of the current running pipeline</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>tasks</p></td>
<td><p>Array[Task]</p></td>
<td><p><strong>See the Task section for the Task object</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>execution_profile</p></td>
<td><p>Object</p></td>
<td><p><strong>See table below</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>env</p></td>
<td><p>Object</p></td>
<td><p><strong>See Pipeline Envrionment section below</strong></p></td>
<td><ul class="simple">
<li><p>Environment variables to be used by tasks in a pipeline run</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<section id="execution-profile-attributes-table">
<h4>Execution Profile Attributes Table<a class="headerlink" href="#execution-profile-attributes-table" title="Link to this heading"></a></h4>
<p>Overrides the default behavior of the Workflow Executor regarding task retries,
backoff algorithm, max lifetime of the pipeline, etc. All Execution Profile properties of the
pipeline are inherited by the tasks that belong to the pipeline unless otherwise specified in the
task definition.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_retries</p></td>
<td><p>Int</p></td>
<td><p>0, 3, 10</p></td>
<td><ul class="simple">
<li><p>The number of times that the Workflow Executor will try to rerun the task if it fails. Defualts to <strong>0</strong></p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>invocation_mode</p></td>
<td><p>Enum</p></td>
<td><p>async, sync</p></td>
<td><ul class="simple">
<li><p>Default is “async”. When “async” is selected, all tasks will be executed concurrently. Currently, async is the only support option</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>retry_policy</p></td>
<td><p>Enum</p></td>
<td><p>exponential_backoff</p></td>
<td><ul class="simple">
<li><p>Dictates which policy to employ when restarting tasks. Default(and only supported option) is exponential_backoff</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>max_exec_time</p></td>
<td><p>Int</p></td>
<td><p>60, 3600, 10800</p></td>
<td><ul class="simple">
<li><p>The maximum amount of time in seconds that a pipeline(or task) is permitted to run. As soon as the sum of all task runs equals this limit, the pipeline(or task) is terminated. Defaults to 3600 seconds(1 hour)</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="pipeline-envrionment">
<h4>Pipeline Envrionment<a class="headerlink" href="#pipeline-envrionment" title="Link to this heading"></a></h4>
<p>The Pipeline Envrionment (the <em>env</em> property of a pipeline definition) is a mechanism for exposing
static global data to task inputs. The Pipeline Envrionment is an object in which the keys are the
name of the variables and the value is either a scalar data (string, number, etc) or an object
with a  <em>value_from</em> property which references data from a source external to the the
workflow (ex. Tapis Security Kernel).</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;env&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;TAPIS_SYSTEM_ID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tapisv3-exec&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;MANIFEST_FILES_DIR&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/path/to/manifest/files&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;TAPIS_USERNAME&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;someusername&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;TAPIS_PASSWORD&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;value_from&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;tapis-security-kernel&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;some+sk+id&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="id2">
<h3>Retrieval<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<p>Retrieve details for a specific pipeline</p>
<p>The response should look similar to the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
   <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
   <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Success&quot;</span><span class="p">,</span>
   <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;some_pipeline_id&quot;</span><span class="p">,</span>
     <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;c487c25f-6c6e-457d-a781-85120df9f10b&quot;</span><span class="p">,</span>
     <span class="s2">&quot;invocation_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;async&quot;</span><span class="p">,</span>
     <span class="s2">&quot;max_exec_time&quot;</span><span class="p">:</span> <span class="mi">10800</span><span class="p">,</span>
     <span class="s2">&quot;max_retries&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
     <span class="s2">&quot;retry_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;exponential_backoff&quot;</span><span class="p">,</span>
     <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;e48ada7a-56b4-4d48-974c-7574d51a8789&quot;</span><span class="p">,</span>
     <span class="s2">&quot;current_run&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
     <span class="s2">&quot;last_run&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
     <span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">[</span>
       <span class="p">{</span>
         <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;build&quot;</span><span class="p">,</span>
         <span class="s2">&quot;cache&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
         <span class="s2">&quot;depends_on&quot;</span><span class="p">:</span> <span class="p">[],</span>
         <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Build an image from a repository and push it to an image registry&quot;</span><span class="p">,</span>
         <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
         <span class="s2">&quot;invocation_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;async&quot;</span><span class="p">,</span>
         <span class="s2">&quot;max_exec_time&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
         <span class="s2">&quot;max_retries&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
         <span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
         <span class="s2">&quot;pipeline&quot;</span><span class="p">:</span> <span class="s2">&quot;e48ada7a-56b4-4d48-974c-7574d51a8789&quot;</span><span class="p">,</span>
         <span class="s2">&quot;poll&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
         <span class="s2">&quot;retry_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;exponential_backoff&quot;</span><span class="p">,</span>
         <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;image_build&quot;</span><span class="p">,</span>
         <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;e442b5df-8a9e-4d55-b4da-c51b7241a79f&quot;</span><span class="p">,</span>
         <span class="s2">&quot;builder&quot;</span><span class="p">:</span> <span class="s2">&quot;singularity&quot;</span><span class="p">,</span>
         <span class="s2">&quot;context&quot;</span><span class="p">:</span> <span class="s2">&quot;5bd771ab-8df5-43cd-a059-fbaa2323841b&quot;</span><span class="p">,</span>
         <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="s2">&quot;b34d1439-d2c9-4238-ab74-13b5fd7f3b1f&quot;</span><span class="p">,</span>
         <span class="s2">&quot;auth&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
         <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
         <span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
         <span class="s2">&quot;http_method&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
         <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
         <span class="s2">&quot;query_params&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
         <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
         <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
         <span class="s2">&quot;tapis_job_def&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
         <span class="s2">&quot;tapis_actor_id&quot;</span><span class="p">:</span> <span class="n">null</span>
       <span class="p">}</span>
     <span class="p">]</span>
   <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3>Deletion<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<p>Deleting a Pipeline will delete all of it’s tasks. This operation
can only be performed the owner of the pipeline.</p>
</section>
</section>
<hr class="docutils" />
<section id="tasks">
<h2>Tasks<a class="headerlink" href="#tasks" title="Link to this heading"></a></h2>
<p>Tasks are discrete units of work performed during the execution of a workflow.
They can be represented as nodes on a directed acyclic graph (DAG), with the order of their
execution determined by their dependencies, and where all tasks without dependencies are
executed first.</p>
<p>Tasks can be defined when creating pipeline, or after the pipelines creation. Every task
must have an <code class="docutils literal notranslate"><span class="pre">id</span></code> that is unique within the pipeline.</p>
<p>Task may also specify their dependencies in a number of ways. The first way is by
declaring the dependency explicity in the <code class="docutils literal notranslate"><span class="pre">depends_on</span></code> property. This is an <em>Array</em> of
<strong>TaskDependency</strong> objects which only have 2 attributes. The <code class="docutils literal notranslate"><span class="pre">id</span></code>, which is the id of the task
that it depends on, and the <code class="docutils literal notranslate"><span class="pre">can_fail</span></code> attribute(Boolean) which specifies whether the dependent
task is allowed to run if that <em>TaskDependency</em> fails.</p>
<section id="task-attributes-table">
<h3>Task Attributes Table<a class="headerlink" href="#task-attributes-table" title="Link to this heading"></a></h3>
<p>This table contains all of the properties that are shared by all tasks. Different types
of tasks will have other unique properties in addition to all of the properties in the table
below.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>String</p></td>
<td><p>my-task, my.task, my_task</p></td>
<td><ul class="simple">
<li><p>Must be unique within the pipeline that it belongs to</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td><p>Enum</p></td>
<td><p>image_build, tapis_job, tapis_actor, request, container_run, function</p></td>
<td><ul class="simple">
<li><p>Only <em>image_build</em> is fully supported. Partial support for the <em>request</em> type exists; HTTP GET requests only</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>depends_on</p></td>
<td><p>Array[TaskDependency]</p></td>
<td><p><strong>see table below</strong></p></td>
<td><ul class="simple">
<li><p>Explicitly declares this task’s dependencies. Task with the specified <code class="docutils literal notranslate"><span class="pre">id</span></code> must exist or the pipeline will not run.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>execution_profile</p></td>
<td><p>Object</p></td>
<td><p><strong>see execution profile table in the pipeline section</strong></p></td>
<td><ul class="simple">
<li><p>Inherits the <code class="docutils literal notranslate"><span class="pre">execution_profile</span></code> set in the pipeline definition.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>description</p></td>
<td><p>String</p></td>
<td><p>My task description</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>input</p></td>
<td><p>Object</p></td>
<td><p><strong>see input table below</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>output</p></td>
<td><p>Object</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>pipeline</p></td>
<td><p>String(UUIDv4)</p></td>
<td><p>5bd771ab-8df5-43cd-a059-fbaa2323841b</p></td>
<td><ul class="simple">
<li><p>UUID of the pipeline that this task is a part of</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>uuid</p></td>
<td><p>String(UUIDv4)</p></td>
<td><p>5bd771ab-8df5-43cd-a059-fbaa2323841b</p></td>
<td><ul class="simple">
<li><p>A globally unique identifier for this task</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="task-input">
<h3>Task Input<a class="headerlink" href="#task-input" title="Link to this heading"></a></h3>
<p>Task input is an object in which the keys are the id of the input(String) and the value is an
object that defines the type of data, and either the literal value of the data via the <em>data</em> property
or a reference to where that data can be found via the <em>data_from</em>.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key-Val</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>key</p></td>
<td><p>String</p></td>
<td><p>TAPIS_USERNAME, PATH_TO_FILES, _SOME_INPUT, etc.</p></td>
<td><ul class="simple">
<li><p>Must be an alpha numeric string that conforms to the following regex pattern: <code class="docutils literal notranslate"><span class="pre">^[_]?[a-zA-Z]+[a-zA-Z0-9_]*</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>value</p></td>
<td><p>InputValueObject</p></td>
<td><p><strong>see table below</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="inputvalue-object">
<h3>InputValue Object<a class="headerlink" href="#inputvalue-object" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attributes</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>type</p></td>
<td><p>Enum</p></td>
<td><p>string, number, tapis_file_input, tapis_file_input_array</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>value</p></td>
<td><p>String, Int, Float</p></td>
<td><p>123, “hello world”, 1.23</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>value_from</p></td>
<td><p>ValueFrom Object</p></td>
<td><p><strong>see table below</strong></p></td>
<td><ul class="simple">
<li><p>Used to reference data from a workflow definition (env, params, task_output)</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="valuefrom-object">
<h3>ValueFrom Object<a class="headerlink" href="#valuefrom-object" title="Link to this heading"></a></h3>
<p>The Value From object is a key value pair in which the <em>key</em> is an enum denoting the source object
of the value(pipeline envrionment, workflow submission parmeteters, and task outputs) and
the <em>value</em> is the key on that source where the value data can be found</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key-Val</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>key</p></td>
<td><p>Enum</p></td>
<td><p>env, params, task_output</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>value</p></td>
<td><p>String or TaskOutput Object(<strong>see table below</strong>)</p></td>
<td><p>TAPIS_USERNAME, PATH_TO_FILES</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="taskoutput-object">
<h3>TaskOutput Object<a class="headerlink" href="#taskoutput-object" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attributes</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>task_id</p></td>
<td><p>String</p></td>
<td><p>task_1, my-task</p></td>
<td><ul class="simple">
<li><p>The id of a previously run task</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>output_id</p></td>
<td><p>String</p></td>
<td><p>123, “hello world”, 1.23</p></td>
<td><ul class="simple">
<li><p>The id of the output for the specified task</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="example-task-definition-with-inputs">
<h3>Example Task Definition with Inputs<a class="headerlink" href="#example-task-definition-with-inputs" title="Link to this heading"></a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The example below is in yaml format for readability, but the Tapis Workflows API only accepts JSON</p>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">tasks</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">generate-manifests-and-process-next</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">function</span>
<span class="w">  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">Python script that creates manifest files and outputs a</span>
<span class="w">    </span><span class="no">tapis file inputs array to stdout</span>
<span class="w">  </span><span class="nt">runtime</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python3.9</span>
<span class="w">  </span><span class="nt">installer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip</span><span class="w"> </span><span class="c1"># poetry</span>
<span class="w">  </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">  </span><span class="nt">packages</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tapipy==1.2.20</span>
<span class="w">  </span><span class="nt">code</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;base64</span><span class="nv"> </span><span class="s">encoded</span><span class="nv"> </span><span class="s">user-defined</span><span class="nv"> </span><span class="s">code</span><span class="nv"> </span><span class="s">here&gt;&quot;</span>
<span class="w">  </span><span class="nt">input</span><span class="p">:</span>
<span class="w">    </span><span class="nt">TAPIS_USERNAME</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">      </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TAPIS_USERNAME</span>
<span class="w">    </span><span class="nt">TAPIS_PASSWORD</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">      </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">        </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TAPIS_PASSWORD</span>
<span class="w">    </span><span class="nt">TAPIS_SYSTEM_ID</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;some-system-id&quot;</span>
<span class="w">    </span><span class="nt">TARGET_DIR</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">target/dir/for/file-input-array</span>
<span class="w">    </span><span class="nt">INBOX</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/scratch/08294/jplneid/tacc_ep/INBOX&quot;</span>
<span class="w">    </span><span class="nt">MANIFESTS</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/scratch/08294/jplneid/tacc_ep/MANIFESTS&quot;</span>
<span class="w">    </span><span class="nt">TAPIS_BASE_URL</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<span class="w">      </span><span class="nt">value_from</span><span class="p">:</span>
<span class="w">        </span><span class="nt">params</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">base_url</span>
<span class="w">  </span><span class="nt">output</span><span class="p">:</span>
<span class="w">    </span><span class="nt">fileInputArrays</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tapis_file_input_arrays&quot;</span>
<span class="w">    </span><span class="nt">manifestFilePath</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;string&quot;</span>
</pre></div>
</div>
</section>
<section id="task-types">
<h3>Task Types<a class="headerlink" href="#task-types" title="Link to this heading"></a></h3>
<p>There are different types of <em>tasks</em> types users can leverage to perform diffent types of work.
These are called task <em>types</em> or <em>primitives</em>.
Task types include the <strong>image_build</strong> type, the <strong>request</strong> type, the <strong>tapis_job</strong> type, the <strong>tapis_actor</strong> type, the <strong>container_run</strong>
type, and the <strong>function</strong> task.</p>
<p>When defining tasks on a pipeline, the <strong>type</strong> must be present in the task definition
along with all other attributes specific to the task type.</p>
<hr class="docutils" />
<hr class="docutils" id="tasktypes" />
<p><a class="reference internal" href="#tasktypes"><span class="std std-ref">Back to tasks</span></a></p>
</section>
<hr class="docutils" />
<section id="id4">
<h3>Retrieval<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<p>Retrieve details for a specific task in a pipeline</p>
<p>The response should look similar to the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
   <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
   <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Success&quot;</span><span class="p">,</span>
   <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;build&quot;</span><span class="p">,</span>
     <span class="s2">&quot;cache&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">&quot;depends_on&quot;</span><span class="p">:</span> <span class="p">[],</span>
     <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Build an image from a repository and push it to an image registry&quot;</span><span class="p">,</span>
     <span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
     <span class="s2">&quot;invocation_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;async&quot;</span><span class="p">,</span>
     <span class="s2">&quot;max_exec_time&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
     <span class="s2">&quot;max_retries&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
     <span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
     <span class="s2">&quot;pipeline&quot;</span><span class="p">:</span> <span class="s2">&quot;ececc546-3ee0-437e-ae50-5882ec03356a&quot;</span><span class="p">,</span>
     <span class="s2">&quot;poll&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
     <span class="s2">&quot;retry_policy&quot;</span><span class="p">:</span> <span class="s2">&quot;exponential_backoff&quot;</span><span class="p">,</span>
     <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;image_build&quot;</span><span class="p">,</span>
     <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;01eac121-19bf-4d8e-957e-faa27bdaa1f8&quot;</span><span class="p">,</span>
     <span class="s2">&quot;builder&quot;</span><span class="p">:</span> <span class="s2">&quot;singularity&quot;</span><span class="p">,</span>
     <span class="s2">&quot;context&quot;</span><span class="p">:</span> <span class="s2">&quot;ea58c3ef-7175-41b0-9671-e50700a33c77&quot;</span><span class="p">,</span>
     <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="s2">&quot;6eac73da-5799-4e74-957c-03b5cee97149&quot;</span><span class="p">,</span>
     <span class="s2">&quot;auth&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
     <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
     <span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
     <span class="s2">&quot;http_method&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
     <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
     <span class="s2">&quot;query_params&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
     <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
     <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
     <span class="s2">&quot;tapis_job_def&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
     <span class="s2">&quot;tapis_actor_id&quot;</span><span class="p">:</span> <span class="n">null</span>
   <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id5">
<h3>Deletion<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<p>Deleting a task can only be done by a pipeline administrator. If any tasks depend on the
deleted task, the pipeline will fail when run</p>
</section>
</section>
<hr class="docutils" />
<section id="archives">
<h2>Archives<a class="headerlink" href="#archives" title="Link to this heading"></a></h2>
<p>Archives are the storage mechanisms for pipeline results. Without an archive,
the results produced by each task will be permanently deleted at the end of each pipeline run.
By default, archiving occurs at the end of a pipeline run when all tasks have reached a terminal state.</p>
<section id="archive-attributes-table">
<h3>Archive Attributes Table<a class="headerlink" href="#archive-attributes-table" title="Link to this heading"></a></h3>
<p>This table contains all of the properties that are shared by all archives. Different types
of archives will have other unique properties in addition to all of the properties in the table
below.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>String</p></td>
<td><p>my-task, my.task, my_task</p></td>
<td><ul class="simple">
<li><p>Must be unique within the group that it belongs to</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>archive_dir</p></td>
<td><p>String</p></td>
<td><p>path/to/archive/dir</p></td>
<td><ul class="simple">
<li><p>Relative to either the “root directory” of the archive’s file system</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>type</p></td>
<td><p>Enum</p></td>
<td><p>system, S3</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="archive-types">
<h3>Archive Types<a class="headerlink" href="#archive-types" title="Link to this heading"></a></h3>
<hr class="docutils" id="archivetypes" />
<p><a class="reference internal" href="#archivetypes"><span class="std std-ref">Back to archives</span></a></p>
</section>
</section>
<hr class="docutils" />
<section id="identities">
<h2>Identities<a class="headerlink" href="#identities" title="Link to this heading"></a></h2>
<p>Identities are mappings between a <em>Tapis identity</em> and some <em>external</em> identity.
An example of an external identity would be a <em>Github</em> user or <em>Dockerhub</em> user.</p>
<p>Identities have two primary functions. The first is it serves as a reference to some set of
credentials that are required to access a restricted external resource, such as a Github
repository or Dockerhub image registry. The second is for authenticating the identity of
a user that triggerred a webhook notification from some external resource.</p>
<dl class="simple">
<dt>For example, if:</dt><dd><ul class="simple">
<li><p><em>Github</em> user <strong>jsmith</strong> pushes code to some repository,</p></li>
<li><p>and has an “on-push” webhook notification configured to make a request the Workflows API(to trigger a pipeline)</p></li>
</ul>
</dd>
</dl>
<p>We need to know which Tapis user(if any) corresponds to that Github user <strong>jsmith</strong> so we can determine
if <strong>jsmith</strong> is permitted to trigger that pipeline.</p>
<section id="identities-attribues-table">
<h3>Identities Attribues Table<a class="headerlink" href="#identities-attribues-table" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Example</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>type</p></td>
<td><p>Enum</p></td>
<td><p>github, dockerhub</p></td>
<td><ul class="simple">
<li><p>For each type of identity, the <cite>credentials</cite> object of the identity will be different. Details to follow</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>name</p></td>
<td><p>String</p></td>
<td><p>my-github-identity</p></td>
<td><ul class="simple">
<li><p>Must be unique to the Tapis user.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>description</p></td>
<td><p>String</p></td>
<td><p>This is the identity to access my restricted github repo</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>credentials</p></td>
<td><p>Object</p></td>
<td></td>
<td><ul class="simple">
<li><p>Contains the secret values to access the restricted external resources</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Identity Examples</strong></p>
</section>
</section>
<hr class="docutils" />
<section id="directives-experimental">
<h2>Directives (experimental)<a class="headerlink" href="#directives-experimental" title="Link to this heading"></a></h2>
<p>Directives are a special set of commands that override the default execution behavior of a pipeline
or its tasks. Directives can be provided in either a commit message or the request body.</p>
<section id="commit-message-directives">
<h3>Commit Message Directives<a class="headerlink" href="#commit-message-directives" title="Link to this heading"></a></h3>
<p>Directives must be placed inside square brackets at the end of the commit message
Multiple Directives must be separated by a pipe “|”
Directives that require a key-value pair must have the key and value separated by a colon “:”
The directive string in a commit message must comply with the following regex(Python flavor) pattern:
<code class="docutils literal notranslate"><span class="pre">\[[a-zA-Z0-9\s:|._-]+\]</span></code></p>
<p><strong>Directive Usage Examples</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Some commit message [no_push]&quot;</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Some commit message [cache|custom_tag:my-custom-tagV.1]&quot;</span>
</pre></div>
</div>
<p><strong>List of Directives</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">custom_tag</span></code> - Overrides the destination <code class="docutils literal notranslate"><span class="pre">image_tag</span></code> on an <em>image_build</em> task. Tags an image with the value provided after “custom_tag:”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">commit_destination</span></code> - Overrides the destination <code class="docutils literal notranslate"><span class="pre">image_tag</span></code> on an <em>image_build</em> task. Dynamically tags the image with the short commit sha of the last commit(and push) that triggered the pipeline.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">no_push</span></code> (pending) - Overrides the image build destination. Creates a local file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dry_run</span></code> - prevents the pipeline from running. Used to test whether the desired Pipeline is matched.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nocache</span></code> (unsupported) - prevents the image builder in an “image_build” task from caching the image layers. This will result in longer build times for subsequent builds.</p></li>
</ul>
</div></blockquote>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, ICICLE.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>