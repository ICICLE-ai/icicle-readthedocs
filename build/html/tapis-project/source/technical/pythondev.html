<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Tapipy and TapisService &#8212; ICICLE-READTHEDOCS  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css?v=cb25574f" />
    <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tapipy-and-tapisservice">
<span id="pythondev"></span><h1>Tapipy and TapisService<a class="headerlink" href="#tapipy-and-tapisservice" title="Link to this heading">¶</a></h1>
<p>Tapipy and TapisService are powerful Python libraries for interacting with Tapis.</p>
<hr class="docutils" />
<section id="tapipy-user-guide">
<h2>Tapipy User Guide<a class="headerlink" href="#tapipy-user-guide" title="Link to this heading">¶</a></h2>
<section id="what-is-tapipy">
<h3>What is Tapipy<a class="headerlink" href="#what-is-tapipy" title="Link to this heading">¶</a></h3>
<p>Tapipy is a Python library for interacting with an instance of the Tapis API framework. The package is hosted
on <a class="reference external" href="https://pypi.org/project/tapipy/">PyPi - tapipy</a>. You can install it with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>tapipy
</pre></div>
</div>
<p>The library is automatically generated by referencing the OpenAPI spec files which a <code class="docutils literal notranslate"><span class="pre">Tapis</span></code> client built from the
OpenAPI spec files from TACC’s Tapis services. With this functionality a user is able to authorize itself with the
<code class="docutils literal notranslate"><span class="pre">Tapis</span></code> client and have a ‘live’ library in order to interact with all Tapis services. Usage of <code class="docutils literal notranslate"><span class="pre">tapipy</span></code> allows for
automatic token refreshing, verbose error messages regarding endpoint inputs, and up to date syntax for all services.</p>
<section id="links">
<h4>Links<a class="headerlink" href="#links" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line">PyPi Package: <a class="reference external" href="https://pypi.org/project/tapipy">https://pypi.org/project/tapipy</a></div>
<div class="line">Github Repo: <a class="reference external" href="https://github.com/tapis-project/tapipy">https://github.com/tapis-project/tapipy</a></div>
</div>
</section>
</section>
<section id="initializing-tapipy">
<h3>Initializing Tapipy<a class="headerlink" href="#initializing-tapipy" title="Link to this heading">¶</a></h3>
<p>To initialize a <code class="docutils literal notranslate"><span class="pre">Tapis</span></code> client object, <code class="docutils literal notranslate"><span class="pre">t</span></code>, you will replace <code class="docutils literal notranslate"><span class="pre">your_tacc_username</span></code> and <code class="docutils literal notranslate"><span class="pre">your_tacc_password</span></code> with your
TACC username and password, preserving the quotation marks shown in the command below. This command will authenticate
you with Tapis for your respective <code class="docutils literal notranslate"><span class="pre">base_url</span></code> and store your retrieved token for later <code class="docutils literal notranslate"><span class="pre">tapipy</span></code> calls.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tapipy.tapis</span> <span class="kn">import</span> <span class="n">Tapis</span>

<span class="c1"># Create python Tapis client for user</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tapis</span><span class="p">(</span><span class="n">base_url</span><span class="o">=</span> <span class="s2">&quot;https://tacc.tapis.io&quot;</span><span class="p">,</span>
          <span class="n">username</span><span class="o">=</span><span class="s2">&quot;your_tacc_username&quot;</span><span class="p">,</span>
          <span class="n">password</span><span class="o">=</span><span class="s2">&quot;your_tacc_password&quot;</span><span class="p">)</span>

<span class="c1"># Get tokens now that you&#39;re initialized</span>
<span class="n">t</span><span class="o">.</span><span class="n">get_tokens</span><span class="p">()</span>
</pre></div>
</div>
<p>These calls do not produce output. However you can use the following code to see the access token you just generated.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">access_token</span>
</pre></div>
</div>
<p>The output should look similar to the following; it describes the access token that was just created.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>access_token: *very long string of alphanumeric characters*
claims: {
    &#39;jti&#39;: &#39;007fa9e6-f044-4817-a812-12292b2bdbe3&#39;,
    &#39;iss&#39;: &#39;https://tacc.tapis.io/v3/tokens&#39;,
    &#39;sub&#39;: &#39;your_tacc_username&#39;,
    &#39;tapis/tenant_id&#39;: &#39;tacc&#39;,
    &#39;tapis/token_type&#39;: &#39;access&#39;,
    &#39;tapis/delegation&#39;: False,
    &#39;tapis/delegation_sub&#39;: None,
    &#39;tapis/username&#39;: &#39;your_tacc_username&#39;,
    &#39;tapis/account_type&#39;: &#39;user&#39;, &#39;exp&#39;: 1657686889,
    &#39;tapis/client_id&#39;: None,
    &#39;tapis/grant_type&#39;: &#39;password&#39;
}
expires_at: 2022-07-13 04:34:49+00:00
expires_in: &lt;function Tapis.add_claims_to_token.&lt;locals&gt;._expires_in at 0x10a070280&gt;
jti: 007fa9e6-f044-4817-a812-12292b2bdbe3
original_ttl: 14400
</pre></div>
</div>
<p>Where you will have your own access token and the placeholder <code class="docutils literal notranslate"><span class="pre">your_tacc_username</span></code> will be replaced with the username you used.</p>
</section>
<section id="using-tapipy">
<h3>Using Tapipy<a class="headerlink" href="#using-tapipy" title="Link to this heading">¶</a></h3>
<p>Now in order to use the <code class="docutils literal notranslate"><span class="pre">Tapis</span></code> client you can reference the <a class="reference external" href="https://tapis-project.github.io/live-docs">Tapis Live Docs</a> to
browse all service specifications. Tapipy is generated off of these specific specifications, so this is your most up-to-date
reference on <code class="docutils literal notranslate"><span class="pre">tapipy</span></code> functionality (if <code class="docutils literal notranslate"><span class="pre">tapipy</span></code> is fully updated).</p>
<p>For example, if you wanted to create a system using the Systems service you would navigate to the proper service in the top bar,
browse the sidebar for functions and view the specification in the main pane. An example is displayed below:</p>
<img alt="../../../_images/livedocssystems.png" src="../../../_images/livedocssystems.png" />
<p>For this example, creating a system, I can see I need to run the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">createSystem</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s2">&quot;host&quot;</span><span class="p">,</span> <span class="n">systemType</span><span class="o">=</span><span class="s2">&quot;LINUX&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Tapipy 1.3.2 introduces native support for <code class="docutils literal notranslate"><span class="pre">t.files.insert()</span></code>. Previous a workaround,
<code class="docutils literal notranslate"><span class="pre">t.upload(filePath,</span> <span class="pre">systemId,</span> <span class="pre">path)</span></code> was required. Read more <a class="reference internal" href="#tapipyuploadanchor"><span class="std std-ref">here</span></a>.</p>
</div>
<p>You can specify any parameter identified by the spec. Tapipy will detail missing required parameters if they’re missing.</p>
<p>The live-docs are a helpful GUI on top of OpenAPI v3 specifications that each service writes to detail endpoints, attributes,
proper content-types, return objects, etc. Depending on the verbosity of the specifications the site could detail what each
function and attribute is, along with defaults and type restrictions.</p>
</section>
<section id="special-user-query-parameters-and-headers">
<h3>Special User Query Parameters and Headers<a class="headerlink" href="#special-user-query-parameters-and-headers" title="Link to this heading">¶</a></h3>
<p>For the most part, arguments that can or should be passed to a Tapis endpoint are described in the OpenAPI definition files and
recognized automatically by <code class="docutils literal notranslate"><span class="pre">tapipy</span></code>. However, due to limitations in what can be expressed in OpenAPI, there are some paramaters
that are not defined in the definition files; for example, the search parameters for various endpoints.</p>
<p>To accommodate these cases, <code class="docutils literal notranslate"><span class="pre">tapipy</span></code> recognizes two special keyword arguments to all of its methods that correspond to Tapis API
calls (i.e., all of its “operations”). They are:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_tapis_headers</span></code> - dictionary-like object of header names (keys) and vales.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_tapis_query_parameters</span></code> - dictionary-like object of query parameter names (keys) and values.</p></li>
</ul>
</div></blockquote>
<p>Use the above two special arguments for passing headers (respectively, query parameters) that are not specified in the OpenAPI
definition of an endpoint.</p>
<p>For example, I can issue a search using the following syntax:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">getJobSearchList</span><span class="p">(</span>
    <span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">orderBy</span><span class="o">=</span><span class="s1">&#39;lastUpdated(desc),name(asc)&#39;</span><span class="p">,</span>
    <span class="n">_tapis_query_parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="s1">&#39;value&#39;</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="additional-tapipy-parameters">
<h3>Additional Tapipy Parameters<a class="headerlink" href="#additional-tapipy-parameters" title="Link to this heading">¶</a></h3>
<p>The tapipy package allows for spec file customization in <code class="docutils literal notranslate"><span class="pre">Tapis</span></code> client initialization:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">resource_set</span></code>: str in [“tapipy”, “prod”, “staging”, “dev”]</dt><dd><ul>
<li><p>Determines which set of resource to use, defaults to <code class="docutils literal notranslate"><span class="pre">tapipy</span></code>.</p></li>
<li><dl class="simple">
<dt>Important to note that if a <code class="docutils literal notranslate"><span class="pre">custom_spec_dictionary</span></code> is used, it is appended to this resource_set.</dt><dd><ul>
<li><p>For example, you would set <code class="docutils literal notranslate"><span class="pre">prod</span></code> and then specify a custom specs that will be added on.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">custom_spec_dict</span></code>: {resource_name: str, resource_url: str}</dt><dd><ul>
<li><dl class="simple">
<dt>Allows users to modify the base resource set urls.</dt><dd><ul>
<li><p>i.e. I can specify actor as a resource name and change the url.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Also allows users to add new resources to the set.</dt><dd><ul>
<li><p>i.e. I can add a new resource named “test” with a custom url.</p></li>
<li><p>Any new specs will be downloaded and added cached without an explicit recache.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Allows local resources.</dt><dd><ul>
<li><p>Specify an absolute path in the dict with local: prefixing it and tapipy will load in a local OpenAPI v3 yml spec file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">custom_spec_dict={'cactus':</span> <span class="pre">'local:</span> <span class="pre">/home/tapis/myfolder/cactusSpec.yml'}</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">download_latest_specs</span></code>: bool</dt><dd><ul>
<li><p>Allows users to re-download all specs regardless on if they already exist in the cache. Defaulted to False</p></li>
<li><dl class="simple">
<dt>This will happen every time the <code class="docutils literal notranslate"><span class="pre">Tapis</span></code> client is initialized, it’s a tad slower, and can cause live updates to specs.</dt><dd><ul>
<li><p>As such, be warned. There are functions to update spec files below.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">spec_dir</span></code>: str</dt><dd><ul>
<li><p>Allows users to specify folder to save specs to. Defaults to none which uses Tapipy’s install folder.</p></li>
<li><p>If you are updating specs it’s wise to use a different folder in order to not modify the base specs.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If your user account does not have permission to write to Tapipy’s install directory you will encounter an error due
to file system permissions. You can use <code class="docutils literal notranslate"><span class="pre">spec_dir</span></code> as highlighted above and use a directory you have permission
to write to. (Important for Docker containers)</p>
</div>
<section id="example">
<h4>Example<a class="headerlink" href="#example" title="Link to this heading">¶</a></h4>
<p>The following is an example of some custom parameter setting. As you can see, the abaco resource will now use the spec at
<code class="docutils literal notranslate"><span class="pre">URL#1</span></code>, overwriting the resource definition in the <code class="docutils literal notranslate"><span class="pre">tapipy</span></code> resource set, it’ll download it if it doesn’t exist. The
same for the longhorn resource. This means that the <code class="docutils literal notranslate"><span class="pre">Tapis</span></code> client will now have access to all specs in <code class="docutils literal notranslate"><span class="pre">tapipy</span></code> like normal,
but with a modified abaco and with a new longhorn resource. All of these are stored at the new spec_dir because you don’t want
to accidentally overwrite any packaged specs when call update_spec_cache() later (talked about in the next section).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tapipy.tapis</span> <span class="kn">import</span> <span class="n">Tapis</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">Tapis</span><span class="p">(</span><span class="n">base_url</span><span class="o">=</span><span class="s1">&#39;https://admin.develop.tapis.io&#39;</span><span class="p">,</span>
          <span class="n">username</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">,</span>
          <span class="n">password</span><span class="o">=</span><span class="s1">&#39;password&#39;</span><span class="p">,</span>
          <span class="n">resource_set</span><span class="o">=</span><span class="s1">&#39;tapipy&#39;</span><span class="p">,</span>
          <span class="n">custom_spec_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;abaco&#39;</span><span class="p">:</span> <span class="s1">&#39;URL#1&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;longhorn&#39;</span><span class="p">:</span> <span class="s1">&#39;URL#2&#39;</span><span class="p">},</span>
                            <span class="s1">&#39;cactus&#39;</span><span class="p">:</span> <span class="s1">&#39;local: /home/tapis/myfolder/cactusSpec.yml&#39;</span><span class="p">},</span>
          <span class="n">spec_dir</span><span class="o">=</span><span class="s1">&#39;/home/username/tapipy_specs&#39;</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">get_tokens</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="tapipy-instantiation-with-only-a-tapis-access-token">
<h3>Tapipy Instantiation with only a Tapis access token<a class="headerlink" href="#tapipy-instantiation-with-only-a-tapis-access-token" title="Link to this heading">¶</a></h3>
<p>Tapipy can be instantiated with only a Tapis access token. This is useful when you have a created token and don’t want to
provide username and password. The minimal instantiation requires the base_url and the token as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tapipy.tapis</span> <span class="kn">import</span> <span class="n">Tapis</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">Tapis</span><span class="p">(</span><span class="n">base_url</span><span class="o">=</span><span class="s1">&#39;https://admin.develop.tapis.io&#39;</span><span class="p">,</span>
          <span class="n">access_token</span><span class="o">=</span><span class="s1">&#39;tokenhere&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>As the token is already created users do not have to run <code class="docutils literal notranslate"><span class="pre">t.get_tokens()</span></code>. You can use the client as normal at this point.</p>
</section>
<section id="refresh-tapipy-s-cached-specs">
<h3>Refresh Tapipy’s Cached Specs<a class="headerlink" href="#refresh-tapipy-s-cached-specs" title="Link to this heading">¶</a></h3>
<p>Tapipy uses a cache to organize spec dictionaries as pickled files and has the ability to accept custom spec files.
By default Tapipy keeps a set of base spec files in the <code class="docutils literal notranslate"><span class="pre">{tapipyInstallDir}/specs</span></code> folder. These specs are pre-pickled at
package build time. To update specs,</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If your user account does not have permission to write to Tapipy’s install directory you will encounter an error due
to file system permissions. You can use <code class="docutils literal notranslate"><span class="pre">spec_dir</span></code> as highlighted above and use a directory you have permission
to write to. (Important for Docker containers)</p>
</div>
<section id="two-spec-refresh-methods">
<h4>Two Spec Refresh Methods<a class="headerlink" href="#two-spec-refresh-methods" title="Link to this heading">¶</a></h4>
<ol class="arabic">
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">t.update_spec_cache()</span></code> -  No inputs</dt><dd><ul class="simple">
<li><p>Will refresh client’s <code class="docutils literal notranslate"><span class="pre">t.resource_set</span></code> resources and save to <code class="docutils literal notranslate"><span class="pre">t.spec_dir</span></code>.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tapipy.tapis</span> <span class="kn">import</span> <span class="n">Tapis</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tapis</span><span class="p">()</span>
<span class="n">t</span><span class="o">.</span><span class="n">update_spec_cache</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">tapipy.tapis.update_spec_cache()</span></code> -  Takes <code class="docutils literal notranslate"><span class="pre">resources</span></code> and <code class="docutils literal notranslate"><span class="pre">spec_dir</span></code></dt><dd><ul class="simple">
<li><p>Will refresh specified resources and cache to inputted <code class="docutils literal notranslate"><span class="pre">spec_dir</span></code></p></li>
<li><p>Default to refreshing all resources from <code class="docutils literal notranslate"><span class="pre">tapipy</span></code> and saving to package install dir.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tapipy.tapis</span> <span class="kn">import</span> <span class="n">update_spec_cache</span>
<span class="n">Resources</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="n">ResourceName</span><span class="p">,</span> <span class="n">ResourceUrl</span><span class="p">]</span>
<span class="n">update_spec_cache</span><span class="p">(</span><span class="n">resources</span><span class="p">:</span> <span class="n">Resources</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">spec_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
</section>
</section>
<section id="creating-and-using-tapipy-refresh-tokens">
<h3>Creating and Using Tapipy Refresh tokens<a class="headerlink" href="#creating-and-using-tapipy-refresh-tokens" title="Link to this heading">¶</a></h3>
<p>Tapipy will authenticate you to Tapis and generate a token, however to activate automatic token refreshing via refresh token
you must also have a <code class="docutils literal notranslate"><span class="pre">Tapis</span></code> client created in order to provide <code class="docutils literal notranslate"><span class="pre">client_id</span></code> and <code class="docutils literal notranslate"><span class="pre">client_key</span></code> at Tapis initialization.</p>
<p>The following code will show you how to create a client if you don’t already have one and then initialize a <code class="docutils literal notranslate"><span class="pre">Tapis</span></code> client
with refresh capabilities by also providing <code class="docutils literal notranslate"><span class="pre">client_id</span></code> and <code class="docutils literal notranslate"><span class="pre">client_key</span></code>. If you already have a client created then you
can jump to the <code class="docutils literal notranslate"><span class="pre">Fourth</span></code> step. Feel free to run just the code you need.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tapipy.tapis</span> <span class="kn">import</span> <span class="n">Tapis</span>

<span class="c1"># First - Create your normal Tapis client so we can run create_client.</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tapis</span><span class="p">(</span><span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;https://tacc.tapis.io&#39;</span><span class="p">,</span>
          <span class="n">username</span> <span class="o">=</span> <span class="s1">&#39;cgarcia&#39;</span><span class="p">,</span>
          <span class="n">password</span> <span class="o">=</span> <span class="s1">&#39;password&#39;</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">get_tokens</span><span class="p">()</span>

<span class="c1"># Second - List your clients (check if you already have a client created)</span>
<span class="n">t</span><span class="o">.</span><span class="n">authenticator</span><span class="o">.</span><span class="n">list_clients</span><span class="p">()</span>

<span class="c1"># Third - If you don&#39;t have a client, create one.</span>
<span class="n">t</span><span class="o">.</span><span class="n">authenticator</span><span class="o">.</span><span class="n">create_client</span><span class="p">()</span>

<span class="c1"># Should result in:</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">[</span>
<span class="sd">active: True</span>
<span class="sd">callback_url:</span>
<span class="sd">client_id: my_client_id</span>
<span class="sd">client_key: my_client_key</span>
<span class="sd">create_time: Wed, 02 Nov 2022 20:18:01 GMT</span>
<span class="sd">description:</span>
<span class="sd">display_name: my_display_name</span>
<span class="sd">last_update_time: Wed, 02 Nov 2022 20:18:01 GMT</span>
<span class="sd">owner: cgarcia</span>
<span class="sd">tenant_id: icicle]</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1"># Fourth - Grab the client_id and client_key, add it to your new Tapis client initialization</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">Tapis</span><span class="p">(</span><span class="n">base_url</span><span class="o">=</span><span class="s1">&#39;https://tapis.io&#39;</span><span class="p">,</span>
        <span class="n">username</span><span class="o">=</span><span class="s1">&#39;cgarcia&#39;</span><span class="p">,</span>
        <span class="n">password</span><span class="o">=</span><span class="s1">&#39;pass&#39;</span><span class="p">,</span>
        <span class="n">client_id</span><span class="o">=</span><span class="s1">&#39;client_id&#39;</span><span class="p">,</span>
        <span class="n">client_key</span><span class="o">=</span><span class="s1">&#39;client_key&#39;</span><span class="p">)</span>
<span class="n">t2</span><span class="o">.</span><span class="n">get_tokens</span><span class="p">()</span>

<span class="c1"># You should now be able to run refresh_tokens with no errors. The t2 object will refresh when needed.</span>
<span class="n">t2</span><span class="o">.</span><span class="n">refresh_tokens</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="using-t-files-insert-with-tapipy-for-file-upload">
<span id="tapipyuploadanchor"></span><h3>Using <code class="docutils literal notranslate"><span class="pre">t.files.insert</span></code> with Tapipy for file upload.<a class="headerlink" href="#using-t-files-insert-with-tapipy-for-file-upload" title="Link to this heading">¶</a></h3>
<p>Introduced in Tapipy 1.3.2, the library now has native support for <code class="docutils literal notranslate"><span class="pre">multipart/form-data</span></code> input data and headers. This
allows us to natively support the <code class="docutils literal notranslate"><span class="pre">t.files.insert</span></code> operation. The following is an example of uploading a <code class="docutils literal notranslate"><span class="pre">filepath.ext</span></code> file to a specific
<code class="docutils literal notranslate"><span class="pre">path</span></code> in a users Tapis <code class="docutils literal notranslate"><span class="pre">system_id</span></code> system.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;filepath.ext&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">data_blob</span><span class="p">:</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">systemId</span><span class="o">=</span><span class="n">system_id</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="n">data_blob</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The previous static workaround, <code class="docutils literal notranslate"><span class="pre">t.upload(filePath,</span> <span class="pre">systemId,</span> <span class="pre">local_file_path)</span></code>, is now deprecated and will be removed in a future release.</p>
</div>
</section>
</section>
<hr class="docutils" />
<section id="tapisservice-user-guide">
<h2>TapisService User Guide<a class="headerlink" href="#tapisservice-user-guide" title="Link to this heading">¶</a></h2>
<section id="what-is-tapisservice">
<h3>What is TapisService<a class="headerlink" href="#what-is-tapisservice" title="Link to this heading">¶</a></h3>
<p>TapisService is a Python plugin for Tapipy which extends Tapipy with additional service oriented Python modules.
This plugin is useful when creating a Tapis service or using a Tapis service account. The package is hosted on
<a class="reference external" href="https://pypi.org/project/tapisservice/">PyPi - tapisservice</a>. You can install it with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>tapisservice
</pre></div>
</div>
<p>The plugin adds systems for authentication, configs, logging, Tapis errors, TenantCache, alongside
helper code for working in <code class="docutils literal notranslate"><span class="pre">Flask</span></code>, <code class="docutils literal notranslate"><span class="pre">FastAPI</span></code>, and <code class="docutils literal notranslate"><span class="pre">Django</span></code>, three popular Python web frameworks. Python based
Tapis services should make use of <code class="docutils literal notranslate"><span class="pre">tapisservice</span></code> for at least the authentication in order to not unneccessary rereplicate
code.</p>
<section id="id1">
<h4>Links<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line">PyPi Package: <a class="reference external" href="https://pypi.org/project/tapisservice">https://pypi.org/project/tapisservice</a></div>
<div class="line">Github Repo: <a class="reference external" href="https://github.com/tapis-project/tapipy-tapisservice">https://github.com/tapis-project/tapipy-tapisservice</a></div>
</div>
</section>
</section>
<section id="writing-a-new-service">
<h3>Writing a New Service<a class="headerlink" href="#writing-a-new-service" title="Link to this heading">¶</a></h3>
<section id="getting-started">
<h4>Getting Started<a class="headerlink" href="#getting-started" title="Link to this heading">¶</a></h4>
<p>When creating a new Tapis v3 service, use the following guidelines:</p>
<section id="create-a-git-repository-with-the-following">
<h5>Create a git repository with the following:<a class="headerlink" href="#create-a-git-repository-with-the-following" title="Link to this heading">¶</a></h5>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+ service: directory for API source code.
+ migrations: directory for migration scripts.
- config-local.json: API config values for local development
- configschema.json: jsonschema definition of the API config.
- Dockerfile: Build recipe for the API service Docker image.
- Dockerfile-migrations: Build recipe for the API service migrations Docker image.
- requirements.txt: Packages required for the API service or migrations scripts.
- docker-compose.yml: compose file for local development.
- CHANGELOG.md: Tracks releases for the service.
- README.md: High level description of the service.
- service.log: Mount into the API container to capture service logs during local development.
</pre></div>
</div>
</section>
<section id="service-configuration">
<h5>Service configuration<a class="headerlink" href="#service-configuration" title="Link to this heading">¶</a></h5>
<p>A description of all possible service configurations should be provided in the <code class="docutils literal notranslate"><span class="pre">configschema.json</span></code> file or example,
if your service requires a SQL database, you may have a property, <code class="docutils literal notranslate"><span class="pre">sql_db_url</span></code>, with the following definition in
your <code class="docutils literal notranslate"><span class="pre">configschema.json</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&quot;sql_db_url&quot;: {
    &quot;type&quot;: &quot;string&quot;,
    &quot;description&quot;: &quot;full URL, including protocol and database, to the SQL db.&quot;,
    &quot;default&quot;: &quot;postgres://myservice:mypassword@postgres:5432/mydb&quot;
},
</pre></div>
</div>
<p>The fields you define in your service’s <code class="docutils literal notranslate"><span class="pre">configschema.json</span></code> file will complement those defined in the <code class="docutils literal notranslate"><span class="pre">configschema.json</span></code> file
included in this repository. Any configs that will be used by all services, such as <code class="docutils literal notranslate"><span class="pre">service_password</span></code>, should be defined in
the common <code class="docutils literal notranslate"><span class="pre">configschema.json</span></code>. It is currently possible to override the definition of a config provided in this repository with
a new definition provided in your service’s <code class="docutils literal notranslate"><span class="pre">configschema.json</span></code> file, but this is not recommended.</p>
<p>Provide values for the configs in the <code class="docutils literal notranslate"><span class="pre">config-local.json</span></code> file. When deploying to a remote environment, such as the Tapis
develop environment, the <code class="docutils literal notranslate"><span class="pre">config-local.json</span></code> can be replaced with file mounted from a ConfigMap with different values.</p>
<ul class="simple">
<li><p>Add any packages required by your service to the <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file. Keep in mind that a number of packages are installed by this repository (such as jsonschema, pyjwt, etc.), so it is possible you will need to add few additional packages.</p></li>
<li><p>Create a Dockerfile to build your service. The image name for your service should be <code class="docutils literal notranslate"><span class="pre">tapis/&lt;service_name&gt;-api</span></code>; for example, <code class="docutils literal notranslate"><span class="pre">tapis/tokens-api</span></code> or <code class="docutils literal notranslate"><span class="pre">tapis/tenants-api</span></code>. Here is a general template for the Dockerfile for your service:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># inherit from the flaskbase image:</span>
<span class="n">FROM</span><span class="p">:</span> <span class="n">tapis</span><span class="o">/</span><span class="n">flaskbase</span>

<span class="c1"># set the name of the api, for use by some of the tapisservice modules.</span>
<span class="n">ENV</span> <span class="n">TAPIS_API</span> <span class="o">&lt;</span><span class="n">api_name</span><span class="o">&gt;</span>

<span class="c1"># install additional requirements for the service</span>
<span class="n">COPY</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">tapis</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">tapis</span><span class="o">/</span><span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>

<span class="c1"># copy service source code</span>
<span class="n">COPY</span> <span class="n">configschema</span><span class="o">.</span><span class="n">json</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">tapis</span><span class="o">/</span><span class="n">configschema</span><span class="o">.</span><span class="n">json</span>
<span class="n">COPY</span> <span class="n">config</span><span class="o">-</span><span class="n">local</span><span class="o">.</span><span class="n">json</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">tapis</span><span class="o">/</span><span class="n">config</span><span class="o">.</span><span class="n">json</span>
<span class="n">COPY</span> <span class="n">service</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">tapis</span><span class="o">/</span><span class="n">service</span>

<span class="c1"># run service as non-root tapis user</span>
<span class="n">RUN</span> <span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">tapis</span><span class="p">:</span><span class="n">tapis</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">tapis</span>
<span class="n">USER</span> <span class="n">tapis</span>
</pre></div>
</div>
</section>
<section id="migration-skeleton">
<h5>Migration skeleton<a class="headerlink" href="#migration-skeleton" title="Link to this heading">¶</a></h5>
<p>For services using Postgres, create migration skeleton. Migrations are based on the alembic package and must be
initialized. Run the following commands from a terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--entrypoint<span class="o">=</span>bash<span class="w"> </span>--network<span class="o">=</span>&lt;service&gt;-api_&lt;service&gt;<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/home/tapis/mig<span class="w"> </span>tapis/tenants-api
<span class="c1"># inside the container:</span>
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>mig<span class="p">;</span><span class="w"> </span>flask<span class="w"> </span>db<span class="w"> </span>init
$<span class="w"> </span>flask<span class="w"> </span>db<span class="w"> </span>migrate
$<span class="w"> </span>flask<span class="w"> </span>db<span class="w"> </span>upgrade
$<span class="w"> </span><span class="nb">exit</span>
</pre></div>
</div>
</section>
<section id="migrations-dockerfile">
<h5>Migrations Dockerfile<a class="headerlink" href="#migrations-dockerfile" title="Link to this heading">¶</a></h5>
<p>Create Dockerfile-migrations to containerize your migrations code. For simple cases, you may be able to just use
the following after change &lt;service&gt; to the name of your service.</p>
<div class="highlight-dockerfile notranslate"><div class="highlight"><pre><span></span><span class="c"># image: tapis/&lt;service&gt;-api-migrations</span>
<span class="k">from</span><span class="w"> </span><span class="s">tapis/&lt;service&gt;-api</span>

<span class="k">COPY</span><span class="w"> </span>migrations<span class="w"> </span>/home/tapis/migrations

<span class="k">ENTRYPOINT</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;flask&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;db&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="service-dockerfile">
<h5>Service Dockerfile<a class="headerlink" href="#service-dockerfile" title="Link to this heading">¶</a></h5>
<p>Write a docker-compose.yml file to facilitate local development.</p>
</section>
</section>
</section>
</section>
<section id="tapisservice-modules">
<h2>TapisService Modules<a class="headerlink" href="#tapisservice-modules" title="Link to this heading">¶</a></h2>
<p>Code for a number of common tasks has been packaged into <code class="docutils literal notranslate"><span class="pre">tapisservice</span></code> modules. In this section, we give an overview
of how to use some of the functionality in your service.</p>
<section id="accessing-tapisservice-modules">
<h3>Accessing TapisService Modules<a class="headerlink" href="#accessing-tapisservice-modules" title="Link to this heading">¶</a></h3>
<p>You can install <code class="docutils literal notranslate"><span class="pre">tapisservice</span></code> with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">tapisservice</span></code>. Services can import modules directly from this package;
for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tapisservice</span> <span class="kn">import</span> <span class="n">auth</span>
<span class="kn">from</span> <span class="nn">tapisservice.utils</span> <span class="kn">import</span> <span class="n">ok</span>
</pre></div>
</div>
</section>
<section id="service-configuration-and-initialization">
<h3>Service Configuration and Initialization<a class="headerlink" href="#service-configuration-and-initialization" title="Link to this heading">¶</a></h3>
<blockquote>
<div><p>Most services will need to do some initialization tasks before they are ready to respond to requests. For example,
they may need to connect to a database or make some requests to some other Tapis services. Initialization also
usually involves reading configuration data. <code class="docutils literal notranslate"><span class="pre">tapisservice</span></code> audits the supplied config file and makes configration
data available through a singelton object, <code class="docutils literal notranslate"><span class="pre">conf</span></code>, available from the <code class="docutils literal notranslate"><span class="pre">tapisservice.config</span></code> package. By importing the
object, for instance, in the API’s <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> module, the config file will be read and validated, and the resulting
configurations transformed to Python objects. For example, if a service requires a configuration, <code class="docutils literal notranslate"><span class="pre">max_number_retries</span></code>,
then it could use the following entry in its <code class="docutils literal notranslate"><span class="pre">configschema.json</span></code> file:</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="s2">&quot;max_number_retries&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Maximum number of times the service should retry some complicated logic...&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="c1"># additional properties</span>
<span class="p">},</span>
<span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;max_number_retries&quot;</span><span class="p">,</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span><span class="p">]</span>
</pre></div>
</div>
<p>and then, place the following code in its <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tapisservice.config</span> <span class="kn">import</span> <span class="n">conf</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;We&#39;ll be trying at most </span><span class="si">{</span><span class="n">conf</span><span class="o">.</span><span class="n">max_number_retries</span><span class="si">}</span><span class="s2"> times.&quot;</span>
</pre></div>
</div>
<p>By the time the import has completed, the service is guaranteed that <code class="docutils literal notranslate"><span class="pre">conf</span></code> contains all required fields and that
they conform to the requirements specified in the <code class="docutils literal notranslate"><span class="pre">configschema.json</span></code> file. In particular, the types of the
attributes are the same as that specified in the <code class="docutils literal notranslate"><span class="pre">configchema.json</span></code> file.</p>
</section>
<section id="making-service-requests">
<h3>Making Service Requests<a class="headerlink" href="#making-service-requests" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">tapisservice.auth</span></code> package provides a function, <code class="docutils literal notranslate"><span class="pre">get_service_tapis_client</span></code> which can be used to get a pre-configured
<code class="docutils literal notranslate"><span class="pre">Tapis</span></code> client for making service requests. A common technique is to fetch the service client in the <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> module
so that it is created at service initialization and available via import throughout the rest of the service code.</p>
<p>Within <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tapisservice.auth</span> <span class="kn">import</span> <span class="n">get_service_tapis_client</span>
<span class="kn">from</span> <span class="nn">tapisservice.tenants</span> <span class="kn">import</span> <span class="n">TenantCache</span>

<span class="n">Tenants</span> <span class="o">=</span> <span class="n">TenantCache</span><span class="p">()</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">get_service_tapis_client</span><span class="p">(</span><span class="n">tenants</span><span class="o">=</span><span class="n">Tenants</span><span class="p">)</span>
</pre></div>
</div>
<p>From within any other service modules:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__init__</span> <span class="kn">import</span> <span class="n">t</span>
<span class="o">.</span> <span class="o">.</span> <span class="o">.</span>
<span class="c1"># use the client within some method or function:</span>
<span class="n">t</span><span class="o">.</span><span class="n">sk</span><span class="o">.</span><span class="n">getUsersWithRole</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="authentication">
<h3>Authentication<a class="headerlink" href="#authentication" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">tapisservice.auth</span></code> module provides functions for resolving the authentication data contained in a reqeust to your
service.</p>
<section id="jwt-authentication">
<h4>JWT Authentication<a class="headerlink" href="#jwt-authentication" title="Link to this heading">¶</a></h4>
<p>The most common and straight-forward case is when an endpoint in your service requires a JWT. For this use case,
the <code class="docutils literal notranslate"><span class="pre">tapisservice.auth.authentication()</span></code> function can be used. This function does the following:</p>
<blockquote>
<div><ol class="arabic">
<li><p>Checks for a JWT in the <code class="docutils literal notranslate"><span class="pre">X-Tapis-Token</span></code> header, and checks the other <code class="docutils literal notranslate"><span class="pre">X-Tapis-</span></code> headers.</p></li>
<li><p>Validates the JWT, including checking the signature and expiration, and sets the following on the global thread-local, <code class="docutils literal notranslate"><span class="pre">g</span></code>:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p><code class="docutils literal notranslate"><span class="pre">g.x_tapis_token</span></code> - the raw JWT.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g.token_claims</span></code> - the claims object associated with the JWT, as a python dictionary.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g.username</span></code> - the username from the JWT <code class="docutils literal notranslate"><span class="pre">username</span></code> claim.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g.tenant_id</span></code> - the tenant id from the JWT <code class="docutils literal notranslate"><span class="pre">tenant_id</span></code> claim.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g.account_type</span></code> - the account type (either <code class="docutils literal notranslate"><span class="pre">user</span></code> or <code class="docutils literal notranslate"><span class="pre">service</span></code>) from the JWT.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g.delegation</span></code> - whether the token was a delegation token (True or False).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g.x_tapis_tenant</span></code> - the value of the <code class="docutils literal notranslate"><span class="pre">X-Tapis-Tenant</span></code> header.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g.x_tapis_user</span></code> - the value of the <code class="docutils literal notranslate"><span class="pre">X-Tapis-User</span></code> header.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g.request_tenant_id</span></code> - <strong>USE THIS</strong> JWT <code class="docutils literal notranslate"><span class="pre">tenant_id</span></code> or, if service, <code class="docutils literal notranslate"><span class="pre">X-Tapis-Tenant</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g.request_username</span></code> - <strong>USE THIS</strong> JWT <code class="docutils literal notranslate"><span class="pre">username</span></code> or, if service, <code class="docutils literal notranslate"><span class="pre">X-Tapis-User</span></code>.</p></li>
</ol>
</div></blockquote>
</li>
</ol>
</div></blockquote>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">g.request_tenant_id</span></code> and <code class="docutils literal notranslate"><span class="pre">g.request_username</span></code>. These both resolve to their respective values, obtained
from the incoming request JWT Tapis token. However, the values change when service accounts send “on behalf of” (obo)
requests. Only services within the same site may complete these request, this is checked by tapisservice.</p>
</div>
<dl class="simple">
<dt>This function raises the following exceptions:</dt><dd><ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tapisservice.errors.NoTokenError</span></code> - if no token was found.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tapisservice.errors.AuthenticationError</span></code> - the token was invalid.</p></li>
</ol>
</dd>
</dl>
</section>
<section id="other-types-of-authentication">
<h4>Other Types of Authentication<a class="headerlink" href="#other-types-of-authentication" title="Link to this heading">¶</a></h4>
<p>Some services, such as the Authenticator, use other types of authentication, including HTTP
Basic Auth. Several <code class="docutils literal notranslate"><span class="pre">tapisservice.auth</span></code> functions are provided to facilitate tasks related to
alternative authentication methods. TODO</p>
</section>
<section id="logging">
<h4>Logging<a class="headerlink" href="#logging" title="Link to this heading">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">tapisservice.logs</span></code> module provides basic logger with a file and stdout handler.
To use it, create an instance of the logger in each module where you want to add logs
by calling the <code class="docutils literal notranslate"><span class="pre">get_logger</span></code> function with the module name; for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tapisservice.logs</span> <span class="kn">import</span> <span class="n">get_logger</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</pre></div>
</div>
<p>Then add log statements using the logger:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;some debug message, x=</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">.&quot;</span>
</pre></div>
</div>
</section>
<section id="error-handling">
<h4>Error Handling<a class="headerlink" href="#error-handling" title="Link to this heading">¶</a></h4>
<p>For REST APIs, the <code class="docutils literal notranslate"><span class="pre">tapisservice.util</span></code> module provides the <code class="docutils literal notranslate"><span class="pre">TapisApi</span></code> class and the <code class="docutils literal notranslate"><span class="pre">flask_errors_dict</span></code>
dict and <code class="docutils literal notranslate"><span class="pre">handle_error()</span></code> function. Use them by adding the following to your <code class="docutils literal notranslate"><span class="pre">api.py</span></code> module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">tapisservice.utils</span> <span class="kn">import</span> <span class="n">TapisApi</span><span class="p">,</span> <span class="n">handle_error</span><span class="p">,</span> <span class="n">flask_errors_dict</span>

<span class="c1"># basic flask &quot;app&quot; object:</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># TapisApi object; created with the app object and the flask_errors_dict to establish the 4 stanza structure of error respones:</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">TapisApi</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="n">flask_errors_dict</span><span class="p">)</span>

<span class="c1"># Set up error handling to use the handle_error() function -</span>
<span class="n">api</span><span class="o">.</span><span class="n">handle_error</span> <span class="o">=</span> <span class="n">handle_error</span>
<span class="n">api</span><span class="o">.</span><span class="n">handle_exception</span> <span class="o">=</span> <span class="n">handle_error</span>
<span class="n">api</span><span class="o">.</span><span class="n">handle_user_exception</span> <span class="o">=</span> <span class="n">handle_error</span>
</pre></div>
</div>
<p>Now, from within a controller, raise an exception of type <code class="docutils literal notranslate"><span class="pre">tapisservice.errors.BaseTapisError</span></code> (or any child class). When
instantiating the exception to be raised, set values for the <code class="docutils literal notranslate"><span class="pre">msg</span></code> and <code class="docutils literal notranslate"><span class="pre">code</span></code> attributed to set the
message and HTTP response code. For example, in your controller, you could have:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">MyServiceError</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;Invalid sprocket; too many widgets.&#39;</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, as long as the <code class="docutils literal notranslate"><span class="pre">errors.MyServiceError</span></code> class descended from the <code class="docutils literal notranslate"><span class="pre">tapisservice.errors.BaseTapisError</span></code>, the
HTTP response returned to the user would be:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Invalid sprocket; too many widgets.&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;conf.version&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;result&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And the HTTP status code would be <code class="docutils literal notranslate"><span class="pre">400</span></code>.</p>
<p>Note that if your code (and, by extension, any code your code calls) raises an exception that does not descend
from the <code class="docutils literal notranslate"><span class="pre">tapisservice.errors.BaseTapisError</span></code> then the HTTP response will still contain the 4-stanza JSON response above
but the <code class="docutils literal notranslate"><span class="pre">message</span></code> field will contain “Unrecognized exception type..” to indicate that the exception was not a recognized
exception. In general, your service should not raise exceptions of types other than <code class="docutils literal notranslate"><span class="pre">tapisservice.errors.BaseTapisError</span></code> and
should instead handle all other exceptions and convert them to the appropriate Tapis Exceptions. This includes all
exceptions from the Python standard library, such as KeyError, AttributeError, etc.</p>
<p>For example, if code you are writing could raise a KeyError, you should catch that and then translate it appropriately.
Of course, different KeyErrors in different situations could translate into a user error, a service error, etc.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">app_id</span> <span class="o">=</span> <span class="n">post_data</span><span class="p">[</span><span class="s1">&#39;app_id&#39;</span><span class="p">]</span>
<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
    <span class="k">raise</span> <span class="n">errors</span><span class="o">.</span><span class="n">BadInputError</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="s1">&#39;The app_id parameter was missing. Please be sure to pass app_id.&#39;</span><span class="p">)</span>   <span class="c1"># &lt;- decends from BaseTapisError</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="working-with-tapisservice-need-to-knows">
<h2>Working with TapisService, Need to Knows<a class="headerlink" href="#working-with-tapisservice-need-to-knows" title="Link to this heading">¶</a></h2>
<p>If you’re developing with TapisService then please ensure you understand the following topics.</p>
<section id="framework-talk">
<h3>Framework Talk<a class="headerlink" href="#framework-talk" title="Link to this heading">¶</a></h3>
<p>Flaskbase is the original implementation of a <code class="docutils literal notranslate"><span class="pre">tapisservice</span></code> like scheme where we provide neccessary helper functions for dealing
with Tapis. It was a library packaged in a Docker container which services based (and still can) their containers off of for a working
coding environment. As the name says, this library was originally intended for <code class="docutils literal notranslate"><span class="pre">Flask</span></code> and overtime it was generalized for more frameworks
and to be used even without any specified framework. Alongside <code class="docutils literal notranslate"><span class="pre">Flask</span></code>, <code class="docutils literal notranslate"><span class="pre">FastAPI</span></code> has full support of all <code class="docutils literal notranslate"><span class="pre">tapisservice</span></code> features.
<code class="docutils literal notranslate"><span class="pre">Django</span></code> is also a supported framework, however all functionality is not yet at 100%.</p>
<p>These three frameworks already have Tapis services already built off of them. These can be great as example implementations to base
your own services off of. Information is as follows:</p>
<ul class="simple">
<li><dl class="simple">
<dt>Flask:</dt><dd><ul>
<li><p><a class="reference external" href="https://github.com/TACC/abaco/tree/dev-v3">Abaco</a>. The repository’s <code class="docutils literal notranslate"><span class="pre">/actors</span></code> folder contains <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> along with <code class="docutils literal notranslate"><span class="pre">auth.py</span></code>.</p></li>
<li><p>Abaco was the original user of Flaskbase and fully implements all <code class="docutils literal notranslate"><span class="pre">tapisservice</span></code> functionality.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>FastAPI:</dt><dd><ul>
<li><p><a class="reference external" href="https://github.com/tapis-project/pods_service">Pod Service</a>. The repository’s <code class="docutils literal notranslate"><span class="pre">/service</span></code> folder contains <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> along with <code class="docutils literal notranslate"><span class="pre">auth.py</span></code>.</p></li>
<li><p>Pods was the first implementation of <code class="docutils literal notranslate"><span class="pre">FastAPI</span></code> with <code class="docutils literal notranslate"><span class="pre">tapisservice</span></code>, it fully implements all <code class="docutils literal notranslate"><span class="pre">tapisservice</span></code> functionality.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Django:</dt><dd><ul>
<li><p><a class="reference external" href="https://github.com/tapis-project/paas">PgREST</a>. The repository’s <code class="docutils literal notranslate"><span class="pre">/pgrest</span></code> folder contains <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> along with <code class="docutils literal notranslate"><span class="pre">views.py</span></code>.</p></li>
<li><p>PgREST implemented most features, however it’s missing a full use of auth capabilities. Making use of only token resolution in the aforementioned <code class="docutils literal notranslate"><span class="pre">views.py</span></code>.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="framework-initialization">
<h3>Framework Initialization<a class="headerlink" href="#framework-initialization" title="Link to this heading">¶</a></h3>
<section id="flask">
<h4>Flask<a class="headerlink" href="#flask" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__init__</span> <span class="kn">import</span> <span class="n">Tenants</span> <span class="c1">## Expects &quot;init.py&quot; as described in &quot;Making Service Requests&quot;</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">tapisservice.tapisflask.utils</span> <span class="kn">import</span> <span class="n">TapisApi</span>
<span class="kn">from</span> <span class="nn">tapisservice.auth</span> <span class="kn">import</span> <span class="n">authn_and_authz</span>

<span class="k">def</span> <span class="nf">authentication</span><span class="p">():</span>
    <span class="c1">## You can write your own auth code here</span>
    <span class="c1">## This will run after tapisservice validates token and sets all valuable g object fields</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">request_username</span>
    <span class="n">tenant_id</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">request_tenant_id</span>


<span class="k">def</span> <span class="nf">authorization</span><span class="p">():</span>
    <span class="c1">## You can write your own auth code here</span>
    <span class="c1">## This will run after tapisservice validates token and sets all valuable g object fields</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">api</span> <span class="o">=</span> <span class="n">TapisApi</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>  <span class="c1">## Empty wrapper around &quot;flask.Flask.api&quot; for future use.</span>

<span class="c1"># tapisservice authn/authz</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">before_request</span>
<span class="k">def</span> <span class="nf">auth</span><span class="p">():</span>
    <span class="c1"># Provide callbacks for authn and authz which will have access to g object fields.</span>
    <span class="c1"># authentication runs, followed by authorization</span>
    <span class="n">authn_and_authz</span><span class="p">(</span><span class="n">tenant_cache</span><span class="o">=</span><span class="n">Tenants</span><span class="p">,</span>
                    <span class="n">authn_callback</span><span class="o">=</span><span class="n">authentication</span><span class="p">,</span>
                    <span class="n">authz_callback</span><span class="o">=</span><span class="n">authorization</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="fastapi">
<h4>FastAPI<a class="headerlink" href="#fastapi" title="Link to this heading">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__init__</span> <span class="kn">import</span> <span class="n">Tenants</span> <span class="c1">## Expects &quot;init.py&quot; as described in &quot;Making Service Requests&quot;</span>
<span class="kn">from</span> <span class="nn">tapisservice.tapisfastapi.utils</span> <span class="kn">import</span> <span class="n">GlobalsMiddleware</span>
<span class="kn">from</span> <span class="nn">tapisservice.tapisfastapi.auth</span> <span class="kn">import</span> <span class="n">TapisMiddleware</span>
<span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>
<span class="kn">from</span> <span class="nn">fastapi.middleware</span> <span class="kn">import</span> <span class="n">Middleware</span>

<span class="k">def</span> <span class="nf">authentication</span><span class="p">():</span>
    <span class="c1">## You can write your own auth code here</span>
    <span class="c1">## This will run after tapisservice validates token and sets all valuable g object fields</span>

<span class="k">def</span> <span class="nf">authorization</span><span class="p">():</span>
    <span class="c1">## You can write your own auth code here</span>
    <span class="c1">## This will run after tapisservice validates token and sets all valuable g object fields</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;MyService&quot;</span><span class="p">,</span>
    <span class="n">middleware</span><span class="o">=</span><span class="p">[</span>
        <span class="n">Middleware</span><span class="p">(</span><span class="n">GlobalsMiddleware</span><span class="p">),</span>
        <span class="n">Middleware</span><span class="p">(</span><span class="n">TapisMiddleware</span><span class="p">,</span>
                   <span class="n">tenant_cache</span><span class="o">=</span><span class="n">Tenants</span><span class="p">,</span>
                   <span class="n">authn_callback</span><span class="o">=</span><span class="n">authentication</span><span class="p">,</span>
                   <span class="n">authz_callback</span><span class="o">=</span><span class="n">authorization</span><span class="p">)</span>
    <span class="p">])</span>
</pre></div>
</div>
</section>
</section>
<section id="example-of-usual-api-file-imports">
<h3>Example of Usual API file imports<a class="headerlink" href="#example-of-usual-api-file-imports" title="Link to this heading">¶</a></h3>
<p>This applies most for FastAPI and Flask. Django can use some of this on a case by case basis.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__init__</span> <span class="kn">import</span> <span class="n">t</span> <span class="c1">## Expects &quot;init.py&quot; as described in &quot;Making Service Requests&quot;</span>
<span class="kn">from</span> <span class="nn">tapisservice.config</span> <span class="kn">import</span> <span class="n">conf</span>
<span class="kn">from</span> <span class="nn">tapisservice.errors</span> <span class="kn">import</span> <span class="n">BaseTapisError</span>
<span class="kn">from</span> <span class="nn">tapisservice.logs</span> <span class="kn">import</span> <span class="n">get_logger</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Use precreated t object with service</span>
<span class="n">t</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">get_systems</span><span class="p">(</span><span class="n">_tapis_set_x_headers_from_service</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Get config.json site_id key value</span>
<span class="n">site_id_to_use</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">site_id</span>

<span class="c1"># Use logger and Tapis error</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Writing logs to file described in config.json and configschema.json.&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">BaseTapisError</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Error found, will be given 400 status code and traditional Tapis 5 stanza output.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="global-g-object-flask-and-fastapi">
<h3>Global <code class="docutils literal notranslate"><span class="pre">g</span></code> object - Flask and FastAPI<a class="headerlink" href="#global-g-object-flask-and-fastapi" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">tapisservice</span></code> uses request thread local <code class="docutils literal notranslate"><span class="pre">g</span></code> objects to expose data globally. This object is created per request and lasts the
lifespan of said request. This allows <code class="docutils literal notranslate"><span class="pre">tapisservice</span></code> to write valuable information to it for reference by code. Key
variables to use are:
- <code class="docutils literal notranslate"><span class="pre">g.request_tenant_id</span></code> - Either incoming token <code class="docutils literal notranslate"><span class="pre">tenant_id</span></code> claim or “on behalf of” headers set by Tapis services.
- <code class="docutils literal notranslate"><span class="pre">g.request_username</span></code> - Either incoming token <code class="docutils literal notranslate"><span class="pre">username</span></code> claim or “on behalf of” headers set by Tapis services.
- <code class="docutils literal notranslate"><span class="pre">g.token_claims</span></code> - the claims object associated with the JWT, as a python dictionary.</p>
<p>Flask natively support a <code class="docutils literal notranslate"><span class="pre">g</span></code> object. <code class="docutils literal notranslate"><span class="pre">tapisservice</span></code> simply intercepts the object and writes to it during the <code class="docutils literal notranslate"><span class="pre">authn_and_authz</span></code>
phase. FastAPI does not natively use a <code class="docutils literal notranslate"><span class="pre">g</span></code> object, but <code class="docutils literal notranslate"><span class="pre">tapisservice</span></code> introduces the variable. You can think of both versions of
<code class="docutils literal notranslate"><span class="pre">g</span></code> to be the same in these docs, use it in both frameworks.</p>
</section>
<section id="use-g-request-tenant-id-and-g-request-username">
<h3>Use <code class="docutils literal notranslate"><span class="pre">g.request_tenant_id</span></code> and <code class="docutils literal notranslate"><span class="pre">g.request_username</span></code><a class="headerlink" href="#use-g-request-tenant-id-and-g-request-username" title="Link to this heading">¶</a></h3>
<p>Hammering home the point, <code class="docutils literal notranslate"><span class="pre">tapisservice</span></code> exposes two sets of similar variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">g.request_username</span></code> - <code class="docutils literal notranslate"><span class="pre">g.username</span></code> if not service and <code class="docutils literal notranslate"><span class="pre">g.x_tapis_user</span></code> otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g.username</span></code> - incoming request token’s <code class="docutils literal notranslate"><span class="pre">username</span></code> claim</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g.x_tapis_user</span></code> - the value of the <code class="docutils literal notranslate"><span class="pre">X-Tapis-Tenant</span></code> header</p></li>
</ul>
<p>and</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">g.request_tenant_id</span></code> - <code class="docutils literal notranslate"><span class="pre">g.tenant_id</span></code> if not service and <code class="docutils literal notranslate"><span class="pre">g.x_tapis_tenant</span></code> otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g.tenant_id</span></code> - incoming request token’s <code class="docutils literal notranslate"><span class="pre">tenant_id</span></code> claim</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g.x_tapis_tenant</span></code> - the value of the <code class="docutils literal notranslate"><span class="pre">X-Tapis-User</span></code> header</p></li>
</ul>
<p>Use <code class="docutils literal notranslate"><span class="pre">g.request_tenant_id</span></code> and <code class="docutils literal notranslate"><span class="pre">g.request_username</span></code>. These both resolve to the values obtained from the incoming request JWT
Tapis token. However, the values change (to the <code class="docutils literal notranslate"><span class="pre">x_tapis_*</span></code> variants) when service accounts send “on behalf of” (obo) requests.
This allows services to reference only one variable versus choosing to use <code class="docutils literal notranslate"><span class="pre">g.username</span></code> or <code class="docutils literal notranslate"><span class="pre">g.x_tapis_user</span></code> at runtime.
To note, only services within the same site may complete these OBO requests, this is checked by tapisservice.</p>
<p>The remaining variables are useful for debugging or defining exactly who sent a request and exactly how.</p>
</section>
<section id="use-tapipy-as-a-service-account">
<h3>Use Tapipy as a Service Account<a class="headerlink" href="#use-tapipy-as-a-service-account" title="Link to this heading">¶</a></h3>
<p>A service account can still make use of the <code class="docutils literal notranslate"><span class="pre">tapipy</span></code> client, some changes will apply though.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__init__</span> <span class="kn">import</span> <span class="n">t</span> <span class="c1">## Expects &quot;init.py&quot; as described in &quot;Making Service Requests&quot;</span>

<span class="c1"># Uses tenant and username from client, meaning service&#39;s tenant and username.</span>
<span class="n">t</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">get_systems</span><span class="p">(</span><span class="n">_tapis_set_x_headers_from_service</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># Use specified _x_tapis_user and _x_tapis_tenant_id rather than service&#39;s values.</span>
<span class="n">t</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">get_systems</span><span class="p">(</span><span class="n">_x_tapis_user</span> <span class="o">=</span> <span class="s2">&quot;cgarcia&quot;</span><span class="p">,</span>
                      <span class="n">_x_tapis_tenant_id</span> <span class="o">=</span> <span class="s2">&quot;tacc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">ICICLE-READTHEDOCS</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">AI for CI-for-AI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../harp/README.html">HARP - HPC Application Runtime Predictor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../harp/README.html#acknowledgements">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../iSpLib/README.html">iSpLib - An Intelligent Sparse Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../iSpLib/README.html#acknowledgements">Acknowledgements</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software Architecture and Design</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../README.html">Base ICICLE Tapis Software - Tapis is a hosted, web-based API framework for securely managing computational workloads across infrastructure and institutions so that experts can focus on their research instead of the technology.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../event-engine/README.html">Event Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../event-engine/README.html#acknowledgement">Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hello_icicle_auth_clients/README.html">Hello ICICLE Authentication Clients - Hello ICICLE Authentication consists of two command line interface (CLI) tools to authenticate with the Tapis Pods service. The first tool, ICICONSOLE, is specifically tailored to working with Neo4j databases hosted through the Tapis Pods. The second tool, TapisCL-ICICLE, allows the user to manage, operate, and interactively explore Tapis services.</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, ICICLE.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../../_sources/tapis-project/source/technical/pythondev.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>