<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jobs &mdash; ICICLE-READTHEDOCS  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="https://aiinstitutes.org/wp-content/uploads/2022/07/icicle.jpeg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">AI for CI-for-AI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/ICICLE_Foodshed_Parser.html">Constrained Language Models Yield Few-Shot Semantic Parsers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/PPOD_CA.html">PPOD_CA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/Region2vec.html">Region2vec</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/Species-Classification-Multimodal-Context.html">Species Classification using Multimodal Heterogeneous Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/Store_Closure_Website.html">Store_Closure_Website (Version 1)</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ICICLE-READTHEDOCS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Jobs</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/tapis-project/source/technical/jobs.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="jobs">
<span id="id1"></span><h1>Jobs<a class="headerlink" href="#jobs" title="Link to this heading"></a></h1>
<style> .red {color:#FF4136; font-weight:bold; font-size:20px} </style><hr class="docutils" />
<section id="introduction-to-jobs">
<h2>Introduction to Jobs<a class="headerlink" href="#introduction-to-jobs" title="Link to this heading"></a></h2>
<p>The Tapis v3 Jobs service is specialized to run containerized applications on any host that supports container runtimes.  Currently, Docker and Singularity containers are supported.  The Jobs service uses the Systems, Apps, Files and Security Kernel services to process jobs.</p>
<section id="implementation-status">
<h3>Implementation Status<a class="headerlink" href="#implementation-status" title="Link to this heading"></a></h3>
<p>The following table describes the current state of the Beta release of Jobs.  All UrlPaths shown start with /v3/jobs.  The unauthenticated health check, ready and hello APIs do not require a Tapis JWT in the request header.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Method</p></th>
<th class="head"><p>UrlPath</p></th>
<th class="head"><p>Status</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Submit</p></td>
<td><p>POST</p></td>
<td><p>/submit</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-odd"><td><p>Resubmit</p></td>
<td><p>POST</p></td>
<td><p>/{JobUUID}/resubmit</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>List</p></td>
<td><p>GET</p></td>
<td><p>/list</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-even"><td><p>Search</p></td>
<td><p>GET</p></td>
<td><p>/search</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-odd"><td><p>Search</p></td>
<td><p>POST</p></td>
<td><p>/search</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Get</p></td>
<td><p>GET</p></td>
<td><p>/{JobUUID}</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-even"><td><p>Get Status</p></td>
<td><p>GET</p></td>
<td><p>/{JobUUID}/status</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-odd"><td><p>Get History</p></td>
<td><p>GET</p></td>
<td><p>/{JobUUID}/history</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-even"><td><p>Get Output list</p></td>
<td><p>GET</p></td>
<td><p>/{JobUUID}/output/list/{outputPath}</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-odd"><td><p>Download Output</p></td>
<td><p>GET</p></td>
<td><p>/{JobUUID}/output/download/{outputPath}</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-even"><td><p>Resubmit Request</p></td>
<td><p>GET</p></td>
<td><p>/{JobUUID}/resubmit_request</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Cancel</p></td>
<td><p>POST</p></td>
<td><p>/{JobUUID}/cancel</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-odd"><td><p>Hide</p></td>
<td><p>POST</p></td>
<td><p>/{JobUUID}/hide</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-even"><td><p>Unhide</p></td>
<td><p>POST</p></td>
<td><p>/{JobUUID}/unhide</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-odd"><td><p>SendEvent</p></td>
<td><p>POST</p></td>
<td><p>/{JobUUID}/sendEvent</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Post Share</p></td>
<td><p>POST</p></td>
<td><p>/{JobUUID}/share</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-even"><td><p>Get Share</p></td>
<td><p>GET</p></td>
<td><p>/{JobUUID}/share</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-odd"><td><p>Delete Share</p></td>
<td><p>DELETE</p></td>
<td><p>/{JobUUID}/share/{user}</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Health Check</p></td>
<td><p>GET</p></td>
<td><p>/healthcheck</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-even"><td><p>Ready</p></td>
<td><p>GET</p></td>
<td><p>/ready</p></td>
<td><p>Implemented</p></td>
</tr>
<tr class="row-odd"><td><p>Hello</p></td>
<td><p>GET</p></td>
<td><p>/hello</p></td>
<td><p>Implemented</p></td>
</tr>
</tbody>
</table>
</section>
<section id="job-processing-overview">
<h3>Job Processing Overview<a class="headerlink" href="#job-processing-overview" title="Link to this heading"></a></h3>
<p>Before discussing the details of how to construct a job request, we take this opportunity to describe overall lifecycle of a job.  When a job request is recieved as the payload of an POST call, the following steps are taken:</p>
<ol class="arabic simple">
<li><p><strong>Request authorization</strong> - The tenant, owner, and user values from the request and Tapis JWT are used to authorize access to the application, execution system and, if specified, archive system.</p></li>
<li><p><strong>Request validation</strong> - Request values are checked for missing, conflicting or improper values; all paths are assigned; required paths are created on the execution system; and macro substitution is performed to finalize all job parameters.</p></li>
<li><p><strong>Job creation</strong> - A Tapis job object is written to the database.</p></li>
<li><p><strong>Job queuing</strong> - The Tapis job is queue on an internal queue serviced by one or more Job Worker processes.</p></li>
<li><p><strong>Response</strong> - The initial Job object is sent back to the caller in the response.  This ends the synchronous portion of job submission.</p></li>
</ol>
<p>Once a response to the submission request is sent to the caller, job processing proceeds asynchronously.  Job worker processes read jobs from their work queues.  The number of workers and queues is limited only by hardware resource constraints.  Each job is assigned a worker thread.  This thread shepards a job through its lifecycle until the job completes, fails or becomes blocked due to a transient resource constraint.  The job lifecycle is reflected in the <a class="reference internal" href="#job-status">Job Status</a> and generally progresses as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">)</span> <span class="n">Stage</span> <span class="n">inputs</span> <span class="n">to</span> <span class="n">execution</span> <span class="n">system</span>
<span class="n">b</span><span class="p">)</span> <span class="n">Stage</span> <span class="n">application</span> <span class="n">artifacts</span> <span class="n">to</span> <span class="n">execution</span> <span class="n">system</span>
<span class="n">c</span><span class="p">)</span> <span class="n">Queue</span> <span class="ow">or</span> <span class="n">invoke</span> <span class="n">job</span> <span class="n">on</span> <span class="n">execution</span> <span class="n">system</span>
<span class="n">d</span><span class="p">)</span> <span class="n">Monitor</span> <span class="n">job</span> <span class="n">until</span> <span class="n">it</span> <span class="n">terminates</span>
<span class="n">e</span><span class="p">)</span> <span class="n">Collect</span> <span class="n">job</span> <span class="n">exit</span> <span class="n">code</span>
<span class="n">f</span><span class="p">)</span> <span class="n">Archive</span> <span class="n">job</span> <span class="n">output</span>
</pre></div>
</div>
</section>
<section id="simple-job-submission-example">
<h3>Simple Job Submission Example<a class="headerlink" href="#simple-job-submission-example" title="Link to this heading"></a></h3>
<p>The POST payload for the simplest job submission request looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;myJob&quot;</span>
 <span class="s2">&quot;appId&quot;</span><span class="p">:</span> <span class="s2">&quot;myApp&quot;</span>
 <span class="s2">&quot;appVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this example, all input and output directories are either specified in the <em>myApp</em> definition or are assigned their default values.  Currently, the execution system on which an application runs must be specified in either the application definition or job request.  Our example assumes that <em>myApp</em> assigns the execution system.  Future versions of the Jobs service will support dynamic execution system selection.</p>
<p>An archive system can also be specified in the application or job request; the default is for it to be the same as the execution system.</p>
</section>
</section>
<hr class="docutils" />
<section id="the-job-submission-request">
<h2>The Job Submission Request<a class="headerlink" href="#the-job-submission-request" title="Link to this heading"></a></h2>
<p>A job submission request must contain the name, appId and appVersion values as shown in the <a class="reference internal" href="#simple-job-submission-example">Simple Job Submission Example</a>.  Those values are marked <em>Required</em> in the list below, a list of all possible values allowed in a submission request.  If a parameter has a default value, that value is also shown.</p>
<p>In addition, some parameters can inherit their values from the application or system definitions as discussed in <a class="reference internal" href="#parameter-precedence">Parameter Precedence</a>.  These parameters are marked <em>Inherit</em>.  Parameters that merge inherited values (rather than override them) are marked <em>InheritMerge</em>.</p>
<p>Parameters that do not need to be set are marked <em>Not Required</em>.  Finally, parameters that allow macro substitution are marked <em>MacroEnabled</em> (see <a class="reference internal" href="#id2">Macro Substitution</a> for details).</p>
<dl class="simple">
<dt><strong>name</strong></dt><dd><p>The user chosen name of the job.  <em>MacroEnabled</em>, <em>Required.</em></p>
</dd>
<dt><strong>appId</strong></dt><dd><p>The Tapis application to execute. <em>Required.</em></p>
</dd>
<dt><strong>appVersion</strong></dt><dd><p>The version of the application to execute. <em>Required.</em></p>
</dd>
<dt><strong>jobType</strong></dt><dd><p>A job’s type can be either FORK or BATCH.</p>
</dd>
<dt><strong>owner</strong></dt><dd><p>User ID under which the job runs.  Administrators can designate a user other than themselves.</p>
</dd>
<dt><strong>tenant</strong></dt><dd><p>Tenant of job owner.  Default is job owner’s tenant.</p>
</dd>
<dt><strong>description</strong></dt><dd><p>Human readable job description.  <em>MacroEnabled</em>, <em>Not Required</em></p>
</dd>
<dt><strong>archiveOnAppError</strong></dt><dd><p>Whether archiving should proceed even when the application reports an error.  Default is <em>true</em>.</p>
</dd>
<dt><strong>dynamicExecSystem</strong></dt><dd><p>Whether the best fit execution system should be chosen using <em>execSystemConstraints</em>.  Default is <em>false</em>.</p>
</dd>
<dt><strong>execSystemId</strong></dt><dd><p>Tapis execution system ID.  <em>Inherit</em>.</p>
</dd>
<dt><strong>execSystemExecDir</strong></dt><dd><p>Directory into which application assets are staged.  <em>Inherit</em>, see <a class="reference internal" href="#directories">Directories</a> for default.</p>
</dd>
<dt><strong>execSystemInputDir</strong></dt><dd><p>Directory into which input files are staged.  <em>Inherit</em>, see <a class="reference internal" href="#directories">Directories</a> for default.</p>
</dd>
<dt><strong>execSystemOutputDir</strong></dt><dd><p>Directory into which the application writes its output.  <em>Inherit</em>, see <a class="reference internal" href="#directories">Directories</a> for default.</p>
</dd>
<dt><strong>execSystemLogicalQueue</strong></dt><dd><p>Tapis-defined queue that corresponds to a batch queue on the execution system.  <em>Inherit</em> when applicable.</p>
</dd>
<dt><strong>archiveSystemId</strong></dt><dd><p>Tapis archive system ID.  <em>Inherit</em>, defaults to <em>execSystemId</em>.</p>
</dd>
<dt><strong>archiveSystemDir</strong></dt><dd><p>Directory into which output files are archived after application execution.  <em>Inherit</em>, see <a class="reference internal" href="#directories">Directories</a> for default.</p>
</dd>
<dt><strong>nodeCount</strong></dt><dd><p>Number of nodes required for application execution.  <em>Inherit</em>, default is 1.</p>
</dd>
<dt><strong>coresPerNode</strong></dt><dd><p>Number of cores to use on each node.  <em>Inherit</em>, default is 1.</p>
</dd>
<dt><strong>memoryMB</strong></dt><dd><p>Megabytes of memory to use on each node.  <em>Inherit</em>, default is 100.</p>
</dd>
<dt><strong>maxMinutes</strong></dt><dd><p>Maximum number of minutes allowed for job execution.  <em>Inherit</em>, default is 10.</p>
</dd>
<dt><strong>fileInputs</strong></dt><dd><p>Input files that need to be staged for the application.  <em>InheritMerge</em>.</p>
</dd>
<dt><strong>fileInputArrays</strong></dt><dd><p>Arrays of input files that need to be staged for the application.  <em>InheritMerge</em>.</p>
</dd>
<dt><strong>parameterSet</strong></dt><dd><p>Runtime parameters organized by category.  <em>Inherit</em>.</p>
</dd>
<dt><strong>execSystemConstraints</strong></dt><dd><p>Constraints applied against execution system capabilities to validate application/system compatibility. <em>InheritMerge</em>.</p>
</dd>
<dt><strong>subscriptions</strong></dt><dd><p>Subscribe to the job’s events.  <em>InheritMerge</em>.</p>
</dd>
<dt><strong>tags</strong></dt><dd><p>An array of user-chosen strings that are associated with a job.  <em>InheritMerge</em>.</p>
</dd>
<dt><strong>notes</strong></dt><dd><p>A JSON object containing any user-chosen data.  <em>Inherit</em>.</p>
</dd>
<dt><strong>isMpi</strong></dt><dd><p>Indicates whether this job is an MPI job.  <em>Inherit</em>, default is false.</p>
</dd>
<dt><strong>mpiCmd</strong></dt><dd><p>Specify the MPI launch command.  Conflicts with cmdPrefix if isMpi is set.  <em>Inherit</em>.</p>
</dd>
<dt><strong>cmdPrefix</strong></dt><dd><p>String prepended to the application invocation command.  Conflicts with mpiCmd if isMpi is set.  <em>Inherit</em>.</p>
</dd>
<dt><strong>notes</strong></dt><dd><p>Optional JSON object containing arbitrary user data, maximum length 65536 bytes.  <em>Inherit</em>.</p>
</dd>
</dl>
<p>The following subsections discuss the meaning and usage of each of the parameters available in a job request.  The <a class="reference external" href="https://github.com/tapis-project/tapis-jobs/blob/dev/tapis-jobsapi/src/main/resources/edu/utexas/tacc/tapis/jobs/api/jsonschema/SubmitJobRequest.json">schema</a> and its referenced <a class="reference external" href="https://github.com/tapis-project/tapis-shared-java/blob/dev/tapis-shared-lib/src/main/resources/edu/utexas/tacc/tapis/shared/jsonschema/defs/TapisDefinitions.json">library</a> comprise the actual JSON schema definition for job requests.</p>
<section id="parameter-precedence">
<h3>Parameter Precedence<a class="headerlink" href="#parameter-precedence" title="Link to this heading"></a></h3>
<p>The runtime environment of a Tapis job is determined by values in system definitions, the app definition and the job request, in low to high precedence order as listed.  Generally speaking, for values that can be assigned in multiple definitions, the values in job requests override those in app definitions, which override those in system definitions.  There are special cases, however, where the values from different definitions are merged.</p>
<p>See the jobs/apps/systems parameter <a class="reference external" href="https://drive.google.com/file/d/1BrY6tHzOegwsgDMrhcKE7RHH7HRAA0Do/view?usp=sharing">matrix</a> for a detailed description of how each parameter is handled.</p>
</section>
<section id="job-type">
<h3>Job Type<a class="headerlink" href="#job-type" title="Link to this heading"></a></h3>
<p>An execution system can run jobs using a batch scheduler (e.g., Slurm or Condor) or a native runtime (e.g., Docker or Singularity) or both.  Users specify how to run a job using the <em>jobType</em> parameter, which is set to “BATCH” to use a batch scheduler or “FORK” to use a native runtime.  The jobType can also be specified in application definitions.  The final value assigned to the jobType of a job is calculated as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">If</span> <span class="n">the</span> <span class="n">user</span> <span class="n">specifies</span> <span class="n">jobType</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">job</span> <span class="n">request</span><span class="p">,</span> <span class="n">use</span> <span class="n">it</span><span class="o">.</span>
<span class="mf">2.</span> <span class="n">Otherwise</span><span class="p">,</span> <span class="k">if</span> <span class="n">the</span> <span class="n">app</span><span class="o">.</span><span class="n">jobType</span> <span class="o">!=</span> <span class="n">null</span><span class="p">,</span> <span class="n">use</span> <span class="n">it</span><span class="o">.</span>
<span class="mf">3.</span> <span class="n">Otherwise</span><span class="p">,</span> <span class="n">query</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">system</span> <span class="ow">and</span> <span class="nb">set</span> <span class="n">jobType</span><span class="o">=</span><span class="n">BATCH</span> <span class="k">if</span> <span class="n">execSys</span><span class="o">.</span><span class="n">canRunBatch</span><span class="o">==</span><span class="n">true</span><span class="o">.</span>
<span class="mf">4.</span> <span class="n">Otherwise</span><span class="p">,</span> <span class="nb">set</span> <span class="n">jobType</span><span class="o">=</span><span class="n">FORK</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="directories">
<h3>Directories<a class="headerlink" href="#directories" title="Link to this heading"></a></h3>
<p>The execution and archive system directories are calculated before the submission response is sent.  This calculation can include the use of macro definitions that get replaced by values at submission request time.  The <a class="reference internal" href="#id2">Macro Substitution</a> section discusses what macro definitions are available and how substitution works.  In this section, we document the default directory assignments which may include macro definitions.</p>
<section id="directory-definitions">
<span id="dir-definitions"></span><h4>Directory Definitions<a class="headerlink" href="#directory-definitions" title="Link to this heading"></a></h4>
<p>The directories assigned when a system is defined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rootDir</span> <span class="o">-</span> <span class="n">the</span> <span class="n">root</span> <span class="n">of</span> <span class="n">the</span> <span class="n">file</span> <span class="n">system</span> <span class="n">that</span> <span class="ow">is</span> <span class="n">accessible</span> <span class="n">through</span> <span class="n">this</span> <span class="n">Tapis</span> <span class="n">system</span><span class="o">.</span>
<span class="n">jobWorkingDir</span> <span class="o">-</span> <span class="n">the</span> <span class="n">default</span> <span class="n">directory</span> <span class="k">for</span> <span class="n">temporary</span> <span class="n">files</span> <span class="n">used</span> <span class="ow">or</span> <span class="n">created</span> <span class="n">during</span> <span class="n">job</span> <span class="n">execution</span><span class="o">.</span>
<span class="n">dtnMountPoint</span> <span class="o">-</span> <span class="n">the</span> <span class="n">path</span> <span class="n">relative</span> <span class="n">to</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">system</span><span class="s1">&#39;s rootDir where the DTN file system is mounted.</span>
</pre></div>
</div>
<p>An execution system may define a <em>Data Transfer Node</em> (DTN).  A DTN is a high throughput node used to stage job inputs and to archive job outputs.  The goal is to improve transfer performance.  The execution system mounts the DTN’s file system at the <em>dtnMountPoint</em> so that executing jobs have access to its data, but Tapis will connect to the DTN rather than the execution system during transfers.  See <a class="reference internal" href="#data-transfer-nodes">Data Transfer Nodes</a> for details.</p>
<p>The directories assigned in application definitions and/or in a job submission requests:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">execSystemExecDir</span>
<span class="n">execSystemInputDir</span>
<span class="n">execSystemOutputDir</span>
<span class="n">archiveSystemDir</span>
</pre></div>
</div>
</section>
<section id="directory-assignments">
<h4>Directory Assignments<a class="headerlink" href="#directory-assignments" title="Link to this heading"></a></h4>
<p>The rootDir and jobWorkingDir are always assigned upon system creation, so they are available for use as macros when assigning directories in applications or job submission requests.</p>
<p>When a job request is submitted, each of the job’s four execution and archive system directories are assigned as follows:</p>
<ol class="arabic simple">
<li><p>If the job submission request assigns the directory, that value is used.  Otherwise,</p></li>
<li><p>If the application definition assigns the directory, that value is used.  Otherwise,</p></li>
<li><p>The default values shown below are assigned:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>No DTN defined:
  execSystemExecDir:    ${JobWorkingDir}/jobs/${JobUUID}
  execSystemInputDir:   ${JobWorkingDir}/jobs/${JobUUID}
  execSystemOutputDir:  ${JobWorkingDir}/jobs/${JobUUID}/output
  archiveSystemDir:     /jobs/${JobUUID}/archive                 (if archiveSystemId is set)
DTN defined:
  execSystemExecDir:    ${DtnMountPoint}/jobs/${JobUUID}
  execSystemInputDir:   ${DtnMountPoint}/jobs/${JobUUID}
  execSystemOutputDir:  ${DtnMountPoint}/jobs/${JobUUID}/output
  archiveSystemDir:     ${DtnMountPoint}/jobs/${JobUUID}/archive (if archiveSystemId is set)
</pre></div>
</div>
</section>
</section>
<section id="fileinputs">
<h3>FileInputs<a class="headerlink" href="#fileinputs" title="Link to this heading"></a></h3>
<p>The <em>fileInputs</em> in <a class="reference external" href="https://tapis.readthedocs.io/en/latest/technical/apps.html">Applications</a> definitions are merged with those in job submission requests to produce the complete list of inputs to be staged for a job.  The following rules govern how job inputs are calculated.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The effective inputs to a job are the combined inputs from the application and job request.</p></li>
<li><p>Only named inputs are allowed in application definitions.</p></li>
<li><p>Application defined inputs are either REQUIRED, OPTIONAL or FIXED.</p></li>
<li><p>Applications can restrict the number and definitions of inputs (<em>strictFileInputs=true</em>).</p></li>
<li><p>Anonymous (unnamed) inputs can be specified in the job request unless prohibited by the application definition (<em>strictFileInputs=true</em>).</p></li>
<li><p>Job request inputs override values set in the application except for FIXED inputs.</p></li>
<li><p>The <em>tapislocal</em> URL scheme specifies in-place inputs for which transfers are not performed.</p></li>
</ol>
</div></blockquote>
<p>The fileInputs array in job requests contains elements that conform to the following JSON schema.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;JobFileInput&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;$comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Used to specify file inputs on Jobs submission requests&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;maxLength&quot;</span><span class="p">:</span> <span class="mi">80</span> <span class="p">},</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;maxLength&quot;</span><span class="p">:</span> <span class="mi">8096</span> <span class="p">},</span>
            <span class="s2">&quot;autoMountLocal&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">},</span>
            <span class="s2">&quot;sourceUrl&quot;</span><span class="p">:</span>  <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;uri&quot;</span><span class="p">},</span>
            <span class="s2">&quot;targetPath&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
            <span class="s2">&quot;notes&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="p">},</span>
    <span class="s2">&quot;additionalProperties&quot;</span><span class="p">:</span> <span class="n">false</span>
<span class="p">}</span>
</pre></div>
</div>
<p>JobFileInputs can be named or unnamed.  When the <em>name</em> field is assigned, Jobs will look for an input with the same name in the application definition (all application inputs are named).  When a match is found, values from the AppFileInput are merged into unassigned fields in the JobFileInput.</p>
<p>The <em>name</em> must start with an alphabetic character or an underscore (_) followed by zero or more alphanumberic or underscore characters.  If the name does not match one of the input names defined in the application, then the application must have <em>strictFileInputs=false</em>.  If the name matches an input name defined in the application, then the application’s inputMode must be REQUIRED or OPTIONAL.  An error occurs if the inputMode is FIXED and there is a name match–job inputs cannot override FIXED application inputs.</p>
<p>The optional <em>notes</em> field can contain any valid user-specified JSON object.</p>
<p>Except for in-place inputs discussed below, the <em>sourceUrl</em> is the location from which data are copied to the <em>targetPath</em>.  In Posix systems the sourceUrl can reference a file or a directory.  When a directory is specified, the complete directory subtree is copied.</p>
<p>Any URL protocol accepted by the Tapis <a class="reference external" href="https://tapis.readthedocs.io/en/latest/technical/files.html">Files</a> service can be used in a <em>sourceUrl</em>.  The most common protocols used are tapis, http, and https.  The standard tapis URL format is <em>tapis://&lt;tapis-system&gt;/&lt;path&gt;</em>; please see the <a class="reference external" href="https://tapis.readthedocs.io/en/latest/technical/files.html">Files</a> service for the complete list of supported protocols.</p>
<p>The <em>targetPath</em> is the location to which data are copied from the <em>sourceUrl</em>.  The target is rooted at the <em>execSystemInputDir</em> except, possibly, when HOST_EVAL() is used, in which case it is still relative to the execution system’s rootDir.</p>
<p>A JobFileInput object is <strong>complete</strong> when its <em>sourceUrl</em> and <em>targetPath</em> are assigned; this provides the minimal information needed to effect a transfer.  If only the <em>sourceUrl</em> is set, Jobs will use the simple directory or file name from the URL to automatically assign the <em>targetPath</em>.  Specifying a <em>targetPath</em> as “*” results in the same automatic assignment.  Whether assigned by the user or Jobs, all job inputs that are not in-place and do not use the HOST_EVAL() function are copied into the <em>execSystemInputDir</em> subtree.</p>
<p>After application inputs are added to or merged with job request inputs, all complete JobFileInput objects are designated for staging.  Incomplete objects are ignored only if they were specified as OPTIONAL in the application definition.  Otherwise, an incomplete input object causes the job request to be rejected.</p>
<section id="in-place-inputs-tapislocal">
<h4>In-Place Inputs (tapislocal)<a class="headerlink" href="#in-place-inputs-tapislocal" title="Link to this heading"></a></h4>
<p>Job inputs already present on an execution system do not need to be transferred, yet users may still want to declare them for documentation purposes or to control how they are mounted into containers.  It’s common, for example, for large data sets that cannot reasonably be copied to be mounted directly onto execution systems.  The Jobs and Applications services provide custom syntax that allows such input to be declared, but instructs the Jobs service to <strong>not</strong> copy that input.</p>
<p>Tapis introduces a new URL scheme, <em>tapislocal</em>, that is only recognized by the Applications and Jobs services.  Here are example URLs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tapislocal</span><span class="p">:</span><span class="o">//</span><span class="n">exec</span><span class="o">.</span><span class="n">tapis</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bud</span><span class="o">/</span><span class="n">mymri</span><span class="o">.</span><span class="n">dcm</span>
<span class="n">tapislocal</span><span class="p">:</span><span class="o">//</span><span class="n">exec</span><span class="o">.</span><span class="n">tapis</span><span class="o">/</span><span class="n">corral</span><span class="o">/</span><span class="n">repl</span><span class="o">/</span><span class="n">shared</span>
</pre></div>
</div>
<p>Like the <em>tapis</em> scheme and all common schemes (https, sftp, etc.), the first segment following the double slashes designates a host.  For <em>tapislocal</em>, the host is always the literal <strong>exec.tapis</strong>, which serves as a placeholder for a job’s execution system.  The remainder of the URL is the path on the Tapis system.  All paths on Tapis systems, including those using the HOST_EVAL() function and the tapislocal URL, are rooted at the Tapis system’s rootDir.</p>
<p>A <em>tapislocal</em> URL can only appear in the sourceUrl field of AppFileInput and JobFileInput parameters.</p>
<p>The <em>tapislocal</em> scheme indicates to Jobs that a filepath already exists on the execution system and, therefore, does not require data transfer during job execution.  If targetPath is “*”, the Jobs service will assign the target path inside the container to be the last segment of the tapislocal URL path (/mymri.dcm and /shared in the examples above).</p>
<p>In container systems that require the explicit mounting of host filepaths, such as Docker, the Jobs service can mount the filepath into the container.  Both application definitions and job requests support the <em>autoMountLocal</em> boolean parameter.  This parameter is true by default, which causes Jobs to automatically mount the filepath into containers.  Setting autoMountLocal to false allows the user complete control over mounting using a <em>containerArgs</em> parameter.</p>
</section>
</section>
<section id="fileinputarrays">
<h3>FileInputArrays<a class="headerlink" href="#fileinputarrays" title="Link to this heading"></a></h3>
<p>The <em>fileInputArrays</em> parameter provides an alternative syntax for specifying inputs in <a class="reference external" href="https://tapis.readthedocs.io/en/latest/technical/apps.html">Applications</a> and job requests.  This syntax is convenient for specifying multiple inputs destined for the same target directory, an I/O pattern sometimes refered to as <em>scatter-gather</em>.  Generally, input arrays support the same semantics as <a class="reference internal" href="#fileinputs">FileInputs</a> with some restrictions.</p>
<p>The fileInputArrays parameter in job requests contains elements that conform to the following JSON schema.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;JobFileInputArray&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
     <span class="s2">&quot;additionalProperties&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
     <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;maxLength&quot;</span><span class="p">:</span> <span class="mi">80</span> <span class="p">},</span>
         <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;maxLength&quot;</span><span class="p">:</span> <span class="mi">8096</span><span class="p">},</span>
         <span class="s2">&quot;sourceUrls&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;array&quot;</span><span class="p">,</span> <span class="s2">&quot;null&quot;</span><span class="p">],</span>
                         <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;uri&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">},</span>
         <span class="s2">&quot;targetDir&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">},</span>
         <span class="s2">&quot;notes&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A fileInputArrays parameter is an array of JobFileInputArray objects, each of which contains an array of <em>sourceUrls</em> and a single <em>targetDir</em>.  One restriction is that <em>tapislocal</em> URLs cannot appear in <em>sourceUrls</em> fields.</p>
<p>An application’s fileInputArrays are added to or merged with those in a job request following the same rules established for fileInputs in the previous section.  In particular, when names match, the <em>sourceUrls</em> defined in a job request override (i.e., completely replace) those defined in an application.  After merging, each JobFileInputArray must have a non-empty <em>sourceUrls</em> array.  See <a class="reference internal" href="#fileinputs">FileInputs</a> and <a class="reference external" href="https://tapis.readthedocs.io/en/latest/technical/apps.html">Applications</a> for related information.</p>
<p>Each <em>sourceUrls</em> entry is a location from which data is copied to the <em>targetDir</em>.  In Posix systems each URL can reference a file or a directory.  In the latter case, the complete directory subtree is transferred.  All URLs recognized by the Tapis <a class="reference external" href="https://tapis.readthedocs.io/en/latest/technical/files.html">Files</a> service can be used (<em>tapislocal</em> is not recognized by Files).</p>
<p>The <em>targetDir</em> is the directory into which all <em>sourceUrls</em> are copied.  The <em>targetDir</em> is always rooted at the <em>ExecSystemInputDir</em> and if <em>targetDir</em> is “*” or not specified, then it is assigned <em>ExecSystemInputDir</em>.  The simple name of each <em>sourceUrls</em> entry is the destination name used in <em>targetDir</em>.  Use different JobFileInputArrays with different targetDir’s if name conflicts between <em>sourceUrls</em> entries exist.</p>
<p>The optional <em>notes</em> field can contain any valid user-specified JSON object.</p>
</section>
<section id="parameterset">
<h3>ParameterSet<a class="headerlink" href="#parameterset" title="Link to this heading"></a></h3>
<p>The job <em>parameterSet</em> argument is comprised of these objects:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>JSON Schema Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>appArgs</p></td>
<td><p><a class="reference internal" href="#jobargspec">JobArgSpec</a> array</p></td>
<td><p>Arguments passed to user’s application</p></td>
</tr>
<tr class="row-odd"><td><p>containerArgs</p></td>
<td><p><a class="reference internal" href="#jobargspec">JobArgSpec</a> array</p></td>
<td><p>Arguments passed to container runtime</p></td>
</tr>
<tr class="row-even"><td><p>schedulerOptions</p></td>
<td><p><a class="reference internal" href="#jobargspec">JobArgSpec</a> array</p></td>
<td><p>Arguments passed to HPC batch scheduler</p></td>
</tr>
<tr class="row-odd"><td><p>envVariables</p></td>
<td><p><a class="reference internal" href="#keyvaluepair">KeyValuePair</a> array</p></td>
<td><p>Environment variables injected into application container</p></td>
</tr>
<tr class="row-even"><td><p>archiveFilter</p></td>
<td><p>object</p></td>
<td><p>File archiving selector</p></td>
</tr>
<tr class="row-odd"><td><p>logConfig</p></td>
<td><p><a class="reference internal" href="#logconfig">LogConfig</a></p></td>
<td><p>User-specified stdout and stderr redirection</p></td>
</tr>
</tbody>
</table>
<p>Each of these objects can be specifed in Tapis application definitions and/or in job submission requests.  In addition, the execution system can also specify environment variable settings.</p>
<section id="appargs">
<h4>appArgs<a class="headerlink" href="#appargs" title="Link to this heading"></a></h4>
<p>Specify one or more command line arguments for the user application using the <em>appArgs</em> parameter.  Arguments specified in the application definition are appended to those in the submission request.</p>
</section>
<section id="containerargs">
<h4>containerArgs<a class="headerlink" href="#containerargs" title="Link to this heading"></a></h4>
<p>Specify one or more command line arguments for the container runtime using the <em>containerArgs</em> parameter.  Arguments specified in the application definition are appended to those in the submission request.</p>
</section>
<section id="scheduleroptions">
<h4>schedulerOptions<a class="headerlink" href="#scheduleroptions" title="Link to this heading"></a></h4>
<p>Specify HPC batch scheduler arguments for the container runtime using the <em>schedulerOptions</em> parameter.  Arguments specified in the application definition are appended to those in the submission request.  The arguments for each scheduler are passed using that scheduler’s conventions.</p>
<p>Tapis defines a special scheduler option, <strong>–tapis-profile</strong>, to support local scheduler conventions.  Data centers sometimes customize their schedulers or restrict how those schedulers can be used.  The <a class="reference external" href="https://tapis.readthedocs.io/en/latest/technical/systems.html">Systems</a> service manages <em>SchedulerProfile</em> resources that are separate from any system definition, but can be referenced from system definitions.  The Jobs service uses directives contained in profiles to tailor application execution to local requirements.</p>
<p>As an example, below is the JSON input used to create the TACC scheduler profile.  The <em>moduleLoads</em> array contains one or more objects. Each object contains a <em>moduleLoadCommand</em>, which specifies the local command used to load each of the modules (in order) in its <em>modulesToLoad</em> list.  <em>hiddenOptions</em> identifies scheduler options that the local implementation prohibits.  In this case, “MEM” indicates that the <em>–mem</em> option should never be passed to Slurm.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;TACC&quot;</span><span class="p">,</span>
    <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;user1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Test profile for TACC Slurm&quot;</span><span class="p">,</span>
    <span class="s2">&quot;moduleLoads&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;moduleLoadCommand&quot;</span><span class="p">:</span> <span class="s2">&quot;module load&quot;</span><span class="p">,</span>
            <span class="s2">&quot;modulesToLoad&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;tacc-singularity&quot;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;hiddenOptions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;MEM&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Scheduler-Specific Processing</strong></p>
<p>Jobs will perform <a class="reference internal" href="#macro-substitution">macro-substitution</a> on Slurm scheduler options <em>–job-name</em> or <em>-J</em>.  This substitution allows Slurm job names to be dynamically generated before submitting them.</p>
</section>
<section id="envvariables">
<h4>envVariables<a class="headerlink" href="#envvariables" title="Link to this heading"></a></h4>
<p>Specify key/value pairs that will be injected as environment variables into the application’s container when it’s launched.  Key/value pairs specified in the execution system definition, application definition, and job submission request are aggregated using precedence ordering (system &lt; app &lt; request) to resolve conflicts.</p>
</section>
<section id="archivefilter">
<h4>archiveFilter<a class="headerlink" href="#archivefilter" title="Link to this heading"></a></h4>
<p>The <em>archiveFilter</em> conforms to this JSON schema:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;archiveFilter&quot;</span><span class="p">:</span> <span class="p">{</span>
   <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
   <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;includes&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span> <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="s2">&quot;uniqueItems&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">},</span>
      <span class="s2">&quot;excludes&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span> <span class="s2">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="s2">&quot;uniqueItems&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">},</span>
      <span class="s2">&quot;includeLaunchFiles&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span><span class="p">}</span>
   <span class="p">},</span>
   <span class="s2">&quot;additionalProperties&quot;</span><span class="p">:</span> <span class="n">false</span>
<span class="p">}</span>
</pre></div>
</div>
<p>An <em>archiveFilter</em> can be specified in the application definition and/or the job submission request.  The <em>includes</em> and <em>excludes</em> arrays are merged by appending entries from the application definition to those in the submission request.</p>
<p>The <em>excludes</em> filter is applied first, so it takes precedence over <em>includes</em>.  If <em>excludes</em> is empty, then no output file or directory will be explicitly excluded from archiving.  If <em>includes</em> is empty, then all files in <em>execSystemOutputDir</em> will be archived unless explicitly excluded.  If <em>includes</em> is not empty, then only files and directories that match an entry and not explicitly excluded will be archived.</p>
<p>Each <em>includes</em> and <em>excludes</em> entry is a string, a string with wildcards or a regular expression.  Entries represent directories or files.  The wildcard semantics are that of glob (*), which is commonly used on the command line.  Tapis implements Java <a class="reference external" href="https://docs.oracle.com/javase/tutorial/essential/io/fileOps.html#glob">glob</a> semantics.  To filter using a regular expression, construct the pattern using Java <a class="reference external" href="https://docs.oracle.com/en/java/javase/15/docs/api/java.base/java/util/regex/Pattern.html">regex</a> semantics and then preface it with <strong>REGEX:</strong> (case sensitive).  Here are examples of globs and regular expressions that could appear in a filter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;myfile.*&quot;</span>
<span class="s2">&quot;*2021-*-events.log&quot;</span>
<span class="s2">&quot;REGEX:^[</span><span class="se">\\</span><span class="s2">p</span><span class="si">{IsAlphabetic}</span><span class="se">\\</span><span class="s2">p</span><span class="si">{IsDigit}</span><span class="s2">_</span><span class="se">\\</span><span class="s2">.</span><span class="se">\\</span><span class="s2">-]+$&quot;</span>
<span class="s2">&quot;REGEX:</span><span class="se">\\</span><span class="s2">s+&quot;</span>
</pre></div>
</div>
<p>When <em>includeLaunchFiles</em> is true (the default), then the script (<em>tapisjob.sh</em>) and environment (<em>tapisjob.env</em>) files that Tapis generates in the <em>execSystemExecDir</em> are also archived.  These launch files provide valuable information about how a job was configured and launched, so archiving them can help with debugging and improve reproducibility.  Since these files may contain application secrets, such database passwords or other credentials, care must be taken to not expose private data through archiving.</p>
<p>If no filtering is specified at all, then all files in <em>execSystemOutputDir</em> and the launch files are archived.</p>
</section>
<section id="logconfig-spec">
<h4>logConfig Spec<a class="headerlink" href="#logconfig-spec" title="Link to this heading"></a></h4>
<p>A <a class="reference internal" href="#logconfig">LogConfig</a> can be supplied in the job submission request and/or in the application definition, with the former overriding the latter when both are supplied.  In supported runtimes (currently Singularity), the <em>logConfig</em> parameter can be used to redirect the application container’s stdout and stderr to user-specified files.</p>
</section>
</section>
<section id="mpi-and-related-support">
<h3>MPI and Related Support<a class="headerlink" href="#mpi-and-related-support" title="Link to this heading"></a></h3>
<p>On many systems, running Message Passing Interface (MPI) jobs is simply a matter of launching programs that have been configured or compiled with the proper MPI libraries.  Most of the work in employing MPI involves parallelizing program logic and specifying the correct libraries for the target execution system.  Once that’s done, a command such as <em>mpirun</em> (or on TACC systems, <em>ibrun</em>) is passed the program’s pathname and arguments to kick off parallel execution.</p>
<p>Tapis’s <em>mpiCmd</em> parameter lets users set the MPI launch command in a system definition, application definition and/or job submission request (lowest to highest priority).  For example, if <em>mpiCmd=mpirun</em>, then the string “mpirun ” will be prepended to the command normally used to execute the application.  Some MPI launchers have their own parameters, for instance, <em>mpiCmd=ibrun -n 4</em> requests 4 MPI tasks.</p>
<p>The <em>isMpi</em> parameter is specified in an application definition and/or job request to toggle MPI launching on or off.  This switch allows the same system to run both MPI and non-MPI jobs depending on the needs of particular jobs or applications.  The <em>isMpi</em> default is false, so this switch must be explicitly turned on to run an MPI job.  When turned on, <em>isMpi</em> requires <em>cmdMpi</em> be assigned in the system, application and/or job request.</p>
<p>The <em>cmdPrefix</em> parameter provides generalized support for launchers and is available in application definitions and job submission requests.  Like <em>mpiCmd</em>, a <em>cmdPrefix</em> value is simply prepended to a program’s pathname and arguments.  Being more general, <em>cmdPrefix</em> could specify an MPI launcher, but it’s not supported in system definitions and does not have a toggle to control usage.</p>
<p><em>mpiCmd</em> and <em>cmdPrefix</em> are mutually exclusive; so if <em>isMpi</em> is true, then <em>cmdPrefix</em> must not be set.</p>
</section>
<section id="execsystemconstraints">
<h3>ExecSystemConstraints<a class="headerlink" href="#execsystemconstraints" title="Link to this heading"></a></h3>
<p>Not implementated yet.</p>
</section>
<section id="subscriptions">
<h3>Subscriptions<a class="headerlink" href="#subscriptions" title="Link to this heading"></a></h3>
<p>Users can subscribe to job execution events.  Subscriptions specified in the application definition and those specified in the job request are merged to produce a job’s initial subscription list.  New subscriptions can be added while a job is running, but not after the job has terminated.  A job’s subscriptions can be listed and deleted.  Only job owners or tenant administrators can subscribe to a job, see the <a class="reference external" href="https://tapis-project.github.io/live-docs/?service=Jobs#tag/subscriptions">subscription</a> APIs for details.</p>
<p>When creating a subscription the <em>ttlminutes</em> parameter can specify up to 4 weeks.  If the parameter is not specified or if it’s set to 0, a default value of 1 week is used.</p>
<p>Subscribers are notified of job events by the <a class="reference external" href="https://tapis-project.github.io/live-docs/?service=Notifications">Notifications</a> service.  Currently, only email and webhook delivery methods are supported.  The event types to which users can subscribe are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Event Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>JOB_NEW_STATUS</p></td>
<td><p>When the job transitions to a new status</p></td>
</tr>
<tr class="row-odd"><td><p>JOB_INPUT_TRANSACTION_ID</p></td>
<td><p>When an input file staging request is made</p></td>
</tr>
<tr class="row-even"><td><p>JOB_ARCHIVE_TRANSACTION_ID</p></td>
<td><p>When an archive file transfer request is made</p></td>
</tr>
<tr class="row-odd"><td><p>JOB_SUBSCRIPTION</p></td>
<td><p>When a change to the job’s subscriptions is made</p></td>
</tr>
<tr class="row-even"><td><p>JOB_SHARE_EVENT</p></td>
<td><p>When a job resource has been shared or unshared</p></td>
</tr>
<tr class="row-odd"><td><p>JOB_ERROR_MESSAGE</p></td>
<td><p>When the job experienced an error</p></td>
</tr>
<tr class="row-even"><td><p>JOB_USER_EVENT</p></td>
<td><p>When a user sends the job a custom event</p></td>
</tr>
<tr class="row-odd"><td><p>ALL</p></td>
<td><p>When any of the above occur</p></td>
</tr>
</tbody>
</table>
<p>All event types other than JOB_USER_EVENT are generated by Tapis. See <a class="reference internal" href="#notification-messages">Notification Messages</a> for a description of what Jobs returns for each of the Tapis-generated event.</p>
<p>A JOB_USER_EVENT contains a user-specified payload that can be sent to an active job using the job’s UUID.  The payload must contain a JSON key named <em>eventData</em> and a string value of at least 1 character and no more than 16,384 characters.  The string can be unstructured or structured (such as a JSON object) as determined by the sender. The payload can optionally contain an <em>eventDetail</em> key with a string value of no more than 64 characters. This key is used to further categorize events and, if not provided, will default to “DEFAULT”.  User events are always added to the job history and notifications are sent to subscribers interested in those events.</p>
</section>
<section id="shared-components">
<h3>Shared Components<a class="headerlink" href="#shared-components" title="Link to this heading"></a></h3>
<section id="jobargspec">
<h4>JobArgSpec<a class="headerlink" href="#jobargspec" title="Link to this heading"></a></h4>
<p>Simple argument strings can be specified in application definitions (AppArgSpec) and in job submission requests (JobArgSpec).  These argument strings are passed to specific components in the runtime system, such as the batch scheduler (<a class="reference internal" href="#scheduleroptions">schedulerOptions</a>), the container runtime (<a class="reference internal" href="#containerargs">containerArgs</a>) or the user’s application (<a class="reference internal" href="#appargs">appArgs</a>).</p>
<p>The following rules govern how job arguments are calculated.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>All argument in application definitions must be named.</p></li>
<li><p>Application arguments are either REQUIRED, FIXED or one of two optional types.</p></li>
<li><p>Anonymous (unnamed) argument can be specified in job requests.</p></li>
<li><p>Job request argument override values set in the application except for FIXED arguments.</p></li>
<li><p>The final argument ordering is the same as the order specified in the definitions, with application arguments preceding those from the job request.  Application arguments maintain their place even when overridden in the job request.</p></li>
<li><p>The notes field can be any JSON object, i.e., JSON that begins with a brace (“{“).</p></li>
</ol>
</div></blockquote>
<p>We define a <strong>complete</strong> AppArgSpec as one that has a non-empty name and arg value.  We define a <strong>complete</strong> JobArgSpec as one that has a non-empty arg value.  A JobArgSpec with the same name as an AppArgSpec inherits from the application and may override the AppArgSpec values.</p>
<p>This is the JSON schema used to define runtime arguments in <a class="reference internal" href="#parameterset">ParameterSet</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;JobArgSpec&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;$comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Used to specify parameters on Jobs submission requests&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;maxLength&quot;</span><span class="p">:</span> <span class="mi">80</span> <span class="p">},</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;maxLength&quot;</span><span class="p">:</span> <span class="mi">8096</span> <span class="p">},</span>
            <span class="s2">&quot;include&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span> <span class="p">},</span>
            <span class="s2">&quot;arg&quot;</span><span class="p">:</span>  <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
            <span class="s2">&quot;notes&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">object</span><span class="p">}</span>
        <span class="p">},</span>
    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;arg&quot;</span><span class="p">],</span>
    <span class="s2">&quot;additionalProperties&quot;</span><span class="p">:</span> <span class="n">false</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As mentioned, the JobArgSpec is used in conjunction with the AppArgSpec defined in <a class="reference external" href="https://tapis.readthedocs.io/en/latest/technical/apps.html">Applications</a>.  Arguments in application definitions are merged into job request arguments using the same name matching alorithm as in <a class="reference internal" href="#fileinputs">FileInputs</a>.</p>
<p>The <em>name</em> identifies the input argument.  If present, the name must start with an alphabetic character or an underscore (_) followed by zero or more alphanumeric or underscore characters.</p>
<p>The <em>description</em> is used to convey usage information to job requester.  If both application and request descriptions are provided, then the request description is appended as a separate paragraph to the application description.</p>
<p>The required <em>arg</em> value is an arbitrary string and is used as-is.  If this argument’s name matches that of an application argument, this <em>arg</em> value overrides the application’s value except when <em>inputMode=FIXED</em> in the application.</p>
<p>The <em>include</em> field applies only on named arguments that are also defined in the application definition with <em>inputMode</em> INCLUDE_ON_DEMAND or INCLUDE_BY_DEFAULT; this parameter is ignored on all other inputModes.  Argument inclusion is discussed in greater detail in following subsection.</p>
<section id="argument-processing">
<h5>Argument Processing<a class="headerlink" href="#argument-processing" title="Link to this heading"></a></h5>
<p><a class="reference external" href="https://tapis.readthedocs.io/en/latest/technical/apps.html">Applications</a> use their AppArgSpecs to pass default values to job requests.  The AppArgSpec’s <em>inputMode</em> determines how to handle arguments during job processing.  An <em>inputMode</em> field can have these values:</p>
<dl class="simple">
<dt>REQUIRED</dt><dd><p>The argument must be provided for the job to run.  If an arg value is not specified in the application       definition, then it must be specified in the job request.  When provided in both, the job request arg value overrides the one in application.</p>
</dd>
<dt>FIXED</dt><dd><p>The argument is completely defined in the application and not overridable in a job request.</p>
</dd>
<dt>INCLUDE_ON_DEMAND</dt><dd><p>The argument, if complete, will only be included in the final argument list constructed by Jobs if it’s explicitly referenced and included in the Job request.  This is the default value.</p>
</dd>
<dt>INCLUDE_BY_DEFAULT</dt><dd><p>The argument, if complete, will automatically be included in the final argument list constructed by Jobs unless explicitly excluded in the Job request.</p>
</dd>
</dl>
<p>The truth table below defines how the AppArgSpec’s <em>inputMode</em> and JobArgSpec’s <em>include</em> settings interact to determine whether an argument is accepted or ignored during job processing.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>AppArgSpec
<em>inputMode</em></p></th>
<th class="head"><p>JobArgSpec
<em>include</em></p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>INCLUDE_ON_DEMAND</p></td>
<td><p>True</p></td>
<td><p>include arg</p></td>
</tr>
<tr class="row-odd"><td><p>INCLUDE_ON_DEMAND</p></td>
<td><p>False</p></td>
<td><p>exclude arg</p></td>
</tr>
<tr class="row-even"><td><p>INCLUDE_ON_DEMAND</p></td>
<td><p>undefined</p></td>
<td><p>include arg</p></td>
</tr>
<tr class="row-odd"><td><p>INCLUDE_BY_DEFAULT</p></td>
<td><p>True</p></td>
<td><p>include arg</p></td>
</tr>
<tr class="row-even"><td><p>INCLUDE_BY_DEFAULT</p></td>
<td><p>False</p></td>
<td><p>exclude arg</p></td>
</tr>
<tr class="row-odd"><td><p>INCLUDE_BY_DEFAULT</p></td>
<td><p>undefined</p></td>
<td><p>include arg</p></td>
</tr>
</tbody>
</table>
<p>The JobArgSpec <em>include</em> value has no effect on REQUIRED or FIXED arguments.  In the cases where the value does apply, not specifying <em>include</em> in a named JobArgSpec that matches an AppArgSpec is effectively the same as setting <em>include=True</em>.  By setting <em>include=False</em>, a JobArgSpec can exclude any INCLUDE_ON_DEMAND or INCLUDE_BY_DEFAULT arguments.</p>
</section>
</section>
<section id="keyvaluepair">
<h4>KeyValuePair<a class="headerlink" href="#keyvaluepair" title="Link to this heading"></a></h4>
<p>The JSON schema for defining key/value pairs of strings in various <a class="reference internal" href="#parameterset">ParameterSet</a> components is below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;KeyValuePair&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;$comment&quot;</span><span class="p">:</span> <span class="s2">&quot;A simple key/value pair&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span>   <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;maxLength&quot;</span><span class="p">:</span> <span class="mi">2048</span><span class="p">}</span>
        <span class="p">},</span>
     <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">],</span>
     <span class="s2">&quot;additionalProperties&quot;</span><span class="p">:</span> <span class="n">false</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Both the <em>key</em> and <em>value</em> are required, though the <em>value</em> can be an empty string.  Descriptions are optional.</p>
</section>
<section id="logconfig">
<h4>LogConfig<a class="headerlink" href="#logconfig" title="Link to this heading"></a></h4>
<p>The JSON schema for used to redirect stdout and stderr to named file(s) in supported runtimes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;logConfig&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;$comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Log file redirection and customization in supported runtimes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
    <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;stdoutFilename&quot;</span><span class="p">,</span> <span class="s2">&quot;stderrFilename&quot;</span> <span class="p">],</span>
    <span class="s2">&quot;additionalProperties&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;stdoutFilename&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
            <span class="s2">&quot;stderrFilename&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="s2">&quot;minLength&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Currently, only the Singularity (Apptainer) runtime is supported.</p>
<p>When specified, both file name fields must be explicitly assigned, though they can be assigned to the same file.  If a <em>logConfig</em> object is not specified, or in runtimes where it’s not supported, then both stdout and stderr are directed to the default <strong>tapisjob.out</strong> file in the job’s output directory.  Output files, even when <em>logConfig</em> is used, are always relative to the ExecSystemOuputDir (see <a class="reference internal" href="#directory-definitions">Directory Definitions</a>).</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="job-execution">
<h2>Job Execution<a class="headerlink" href="#job-execution" title="Link to this heading"></a></h2>
<section id="environment-variables">
<h3>Environment Variables<a class="headerlink" href="#environment-variables" title="Link to this heading"></a></h3>
<p>The following standard environment variables are passed into each application container run by Tapis as long as they have been assigned a value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">_tapisAppId</span> <span class="o">-</span> <span class="n">Tapis</span> <span class="n">app</span> <span class="n">ID</span>
<span class="n">_tapisAppVersion</span> <span class="o">-</span> <span class="n">Tapis</span> <span class="n">app</span> <span class="n">version</span>
<span class="n">_tapisArchiveOnAppError</span> <span class="o">-</span> <span class="n">true</span> <span class="n">means</span> <span class="n">archive</span> <span class="n">even</span> <span class="k">if</span> <span class="n">the</span> <span class="n">app</span> <span class="n">returns</span> <span class="n">a</span> <span class="n">non</span><span class="o">-</span><span class="n">zero</span> <span class="n">exit</span> <span class="n">code</span>
<span class="n">_tapisArchiveSystemDir</span> <span class="o">-</span> <span class="n">the</span> <span class="n">archive</span> <span class="n">system</span> <span class="n">directory</span> <span class="n">on</span> <span class="n">which</span> <span class="n">app</span> <span class="n">output</span> <span class="ow">is</span> <span class="n">archived</span>
<span class="n">_tapisArchiveSystemId</span> <span class="o">-</span> <span class="n">Tapis</span> <span class="n">system</span> <span class="n">used</span> <span class="k">for</span> <span class="n">archiving</span> <span class="n">app</span> <span class="n">output</span>
<span class="n">_tapisCoresPerNode</span> <span class="o">-</span> <span class="n">number</span> <span class="n">of</span> <span class="n">cores</span> <span class="n">used</span> <span class="n">per</span> <span class="n">node</span> <span class="n">by</span> <span class="n">app</span>
<span class="n">_tapisDtnMountPoint</span> <span class="o">-</span> <span class="n">the</span> <span class="n">mountpoint</span> <span class="n">on</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">system</span> <span class="k">for</span> <span class="n">the</span> <span class="n">source</span> <span class="n">DTN</span> <span class="n">directory</span>
<span class="n">_tapisDtnMountSourcePath</span> <span class="o">-</span> <span class="n">the</span> <span class="n">directory</span> <span class="n">exported</span> <span class="n">by</span> <span class="n">the</span> <span class="n">DTN</span> <span class="ow">and</span> <span class="n">mounted</span> <span class="n">on</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">system</span>
<span class="n">_tapisDtnSystemId</span> <span class="o">-</span> <span class="n">the</span> <span class="n">Data</span> <span class="n">Transfer</span> <span class="n">Node</span> <span class="n">system</span> <span class="n">ID</span>
<span class="n">_tapisDynamicExecSystem</span> <span class="o">-</span> <span class="n">true</span> <span class="k">if</span> <span class="n">dynamic</span> <span class="n">system</span> <span class="n">selection</span> <span class="n">was</span> <span class="n">used</span>
<span class="n">_tapisEffeciveUserId</span> <span class="o">-</span> <span class="n">the</span> <span class="n">user</span> <span class="n">ID</span> <span class="n">under</span> <span class="n">which</span> <span class="n">the</span> <span class="n">app</span> <span class="n">runs</span>
<span class="n">_tapisExecSystemExecDir</span> <span class="o">-</span> <span class="n">the</span> <span class="n">exec</span> <span class="n">system</span> <span class="n">directory</span> <span class="n">where</span> <span class="n">app</span> <span class="n">artifacts</span> <span class="n">are</span> <span class="n">staged</span>
<span class="n">_tapisExecSystemHPCQueue</span> <span class="o">-</span> <span class="n">the</span> <span class="n">actual</span> <span class="n">batch</span> <span class="n">queue</span> <span class="n">name</span> <span class="n">on</span> <span class="n">an</span> <span class="n">HPC</span> <span class="n">host</span>
<span class="n">_tapisExecSystemId</span> <span class="o">-</span> <span class="n">the</span> <span class="n">Tapis</span> <span class="n">system</span> <span class="n">where</span> <span class="n">the</span> <span class="n">app</span> <span class="n">runs</span>
<span class="n">_tapisExecSystemInputDir</span> <span class="o">-</span> <span class="n">the</span> <span class="n">exec</span> <span class="n">system</span> <span class="n">directory</span> <span class="n">where</span> <span class="nb">input</span> <span class="n">files</span> <span class="n">are</span> <span class="n">staged</span>
<span class="n">_tapisExecSystemLogicalQueue</span> <span class="o">-</span> <span class="n">the</span> <span class="n">Tapis</span> <span class="n">queue</span> <span class="n">definition</span> <span class="n">that</span> <span class="n">specifies</span> <span class="n">an</span> <span class="n">HPC</span> <span class="n">queue</span>
<span class="n">_tapisExecSystemOutputDir</span> <span class="o">-</span> <span class="n">the</span> <span class="n">exec</span> <span class="n">system</span> <span class="n">directory</span> <span class="n">where</span> <span class="n">the</span> <span class="n">app</span> <span class="n">writes</span> <span class="n">its</span> <span class="n">output</span>
<span class="n">_tapisJobCreateDate</span> <span class="o">-</span> <span class="n">ISO</span> <span class="mi">8601</span> <span class="n">date</span><span class="p">,</span> <span class="n">example</span><span class="p">:</span> <span class="mi">2021</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">26</span><span class="n">Z</span>
<span class="n">_tapisJobCreateTime</span> <span class="o">-</span> <span class="n">ISO</span> <span class="mi">8601</span> <span class="n">time</span><span class="p">,</span> <span class="n">example</span><span class="p">:</span> <span class="mi">18</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mf">55.544145884</span><span class="n">Z</span>
<span class="n">_tapisJobCreateTimestamp</span> <span class="o">-</span> <span class="n">ISO</span> <span class="mi">8601</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">example</span><span class="p">:</span> <span class="mi">2021</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">26</span><span class="n">T18</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mf">55.544145884</span><span class="n">Z</span>
<span class="n">_tapisJobName</span> <span class="o">-</span> <span class="n">the</span> <span class="n">user</span><span class="o">-</span><span class="n">chosen</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">Tapis</span> <span class="n">job</span>
<span class="n">_tapisJobOwner</span> <span class="o">-</span> <span class="n">the</span> <span class="n">Tapis</span> <span class="n">job</span><span class="s1">&#39;s owner</span>
<span class="n">_tapisJobUUID</span> <span class="o">-</span> <span class="n">the</span> <span class="n">UUID</span> <span class="n">of</span> <span class="n">the</span> <span class="n">Tapis</span> <span class="n">job</span>
<span class="n">_tapisJobWorkingDir</span> <span class="o">-</span> <span class="n">exec</span> <span class="n">system</span> <span class="n">directory</span> <span class="n">that</span> <span class="n">the</span> <span class="n">app</span> <span class="n">should</span> <span class="n">use</span> <span class="k">for</span> <span class="n">temporary</span> <span class="n">files</span>
<span class="n">_tapisMaxMinutes</span> <span class="o">-</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">minutes</span> <span class="n">allowed</span> <span class="k">for</span> <span class="n">the</span> <span class="n">job</span> <span class="n">to</span> <span class="n">run</span>
<span class="n">_tapisMemoryMB</span> <span class="o">-</span> <span class="n">the</span> <span class="n">memory</span> <span class="n">required</span> <span class="n">per</span> <span class="n">node</span> <span class="n">by</span> <span class="n">the</span> <span class="n">app</span>
<span class="n">_tapisNodes</span> <span class="o">-</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">nodes</span> <span class="n">on</span> <span class="n">which</span> <span class="n">the</span> <span class="n">app</span> <span class="n">runs</span>
<span class="n">_tapisSysBatchScheduler</span> <span class="o">-</span> <span class="n">the</span> <span class="n">HPC</span> <span class="n">scheduler</span> <span class="n">on</span> <span class="n">the</span> <span class="n">execution</span> <span class="n">system</span>
<span class="n">_tapisSysBucketName</span> <span class="o">-</span> <span class="n">an</span> <span class="nb">object</span> <span class="n">store</span> <span class="n">bucket</span> <span class="n">name</span>
<span class="n">_tapisSysHost</span> <span class="o">-</span> <span class="n">the</span> <span class="n">IP</span> <span class="n">address</span> <span class="ow">or</span> <span class="n">DNS</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">exec</span> <span class="n">system</span>
<span class="n">_tapisSysRootDir</span> <span class="o">-</span> <span class="n">the</span> <span class="n">root</span> <span class="n">directory</span> <span class="n">on</span> <span class="n">the</span> <span class="n">exec</span> <span class="n">system</span>
<span class="n">_tapisTenant</span> <span class="o">-</span> <span class="n">the</span> <span class="n">tenant</span> <span class="ow">in</span> <span class="n">which</span> <span class="n">the</span> <span class="n">job</span> <span class="n">runs</span>
</pre></div>
</div>
</section>
<section id="macro-substitution">
<span id="id2"></span><h3>Macro Substitution<a class="headerlink" href="#macro-substitution" title="Link to this heading"></a></h3>
<p>Tapis defines macros or template variables that get replaced with actual values at well-defined points during job creation.  The act of replacing a macro with a value is often called macro substitution or macro expansion.  The complete list of Tapis macros can be found at <a class="reference external" href="https://github.com/tapis-project/tapis-jobs/blob/dev/tapis-jobslib/src/main/java/edu/utexas/tacc/tapis/jobs/model/enumerations/JobTemplateVariables.java">JobTemplateVariables</a>.</p>
<p>There is a close relationship between these macro definitions and the Tapis environment variables just discussed:  Macros that have values assigned are passed as environment variables into application containers.  This makes macros used during job creation available to applications at runtime.</p>
<p>Most macro definitions are <em>ground</em> definitions because their values do not depend on any other macros.  On the other hand, <em>derived</em> macro definitions can include other macro definitions.  For example, in <a class="reference internal" href="#directory-assignments">Directory Assignments</a> the default input file directory is constructed with two macro definitions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>execSystemInputDir = ${JobWorkingDir}/jobs/${JobUUID}
</pre></div>
</div>
<p>Macro values are referenced using the ${Macro-name} notation.  Since derived macro definitions reference other macros, there is the possibility of circular references.  Tapis detects these errors and aborts job creation.</p>
<p>Below is the complete, ordered list of derived macros.  Each macro in the list can be defined using any ground macro and any macro that preceeds it in the list.  Result are undefined if a derived macro references a macro that follows it in the derived list.</p>
<ol class="arabic simple">
<li><p>JobName</p></li>
<li><p>JobWorkingDir</p></li>
<li><p>ExecSystemInputDir</p></li>
<li><p>ExecSystemExecDir</p></li>
<li><p>ExecSystemOutputDir</p></li>
<li><p>ArchiveSystemDir</p></li>
</ol>
<p>Finally, macro substitution is applied to the job <em>description</em> field, whether the description is specified in an application or a submission request.</p>
<section id="macro-functions">
<h4>Macro Functions<a class="headerlink" href="#macro-functions" title="Link to this heading"></a></h4>
<p>Directory assignments in systems, applications and job requests can also use the <strong>HOST_EVAL($var)</strong> function at the beginning of their path assignments.  This function dynamically extracts the named environment variable’s value from an execution or archive host <em>at the time the job request is made</em>.  Specifically, the environment variable’s value is retrieved by logging into the host as the Job owner and issuing “echo $var”.  The example in <a class="reference internal" href="#data-transfer-nodes">Data Transfer Nodes</a> uses this function.</p>
<p>To increase application portability, an optional default value can be passed into the <strong>HOST_EVAL</strong> function.  The function’s complete signature with the optional path parameter is:</p>
<blockquote>
<div><p><strong>HOST_EVAL($VAR, path)</strong></p>
</div></blockquote>
<p>If the environment variable VAR does not exist on the host, then the literal path parameter is returned by the function.  This added flexibility allows applications to run in different environments, such as on TACC HPC systems that automatically expose certain environment variables and VMs that might not.  If the environment variable does not exist and no optional path parameter is provided, the job fails due to invalid input.</p>
</section>
</section>
<section id="job-status">
<h3>Job Status<a class="headerlink" href="#job-status" title="Link to this heading"></a></h3>
<p>The list below contains all possible states of a Tapis job, which are indicated in the <em>status</em> field of a job record.  The initial state is PENDING.  Terminal states are FINISHED, CANCELLED and FAILED.  The BLOCKED state indicates that the job is recovering from a resource constraint, network problem or other transient problem.  When the problem clears, the job will restart from the state in which blocking occurred.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PENDING</span> <span class="o">-</span> <span class="n">Job</span> <span class="n">processing</span> <span class="n">beginning</span>
<span class="n">PROCESSING_INPUTS</span> <span class="o">-</span> <span class="n">Identifying</span> <span class="nb">input</span> <span class="n">files</span> <span class="k">for</span> <span class="n">staging</span>
<span class="n">STAGING_INPUTS</span> <span class="o">-</span> <span class="n">Transferring</span> <span class="n">job</span> <span class="nb">input</span> <span class="n">data</span> <span class="n">to</span> <span class="n">execution</span> <span class="n">system</span>
<span class="n">STAGING_JOB</span> <span class="o">-</span> <span class="n">Staging</span> <span class="n">runtime</span> <span class="n">assets</span> <span class="n">to</span> <span class="n">execution</span> <span class="n">system</span>
<span class="n">SUBMITTING_JOB</span> <span class="o">-</span> <span class="n">Submitting</span> <span class="n">job</span> <span class="n">to</span> <span class="n">execution</span> <span class="n">system</span>
<span class="n">QUEUED</span> <span class="o">-</span> <span class="n">Job</span> <span class="n">queued</span> <span class="n">to</span> <span class="n">execution</span> <span class="n">system</span> <span class="n">queue</span>
<span class="n">RUNNING</span> <span class="o">-</span> <span class="n">Job</span> <span class="n">running</span> <span class="n">on</span> <span class="n">execution</span> <span class="n">system</span>
<span class="n">ARCHIVING</span> <span class="o">-</span> <span class="n">Transferring</span> <span class="n">job</span> <span class="n">output</span> <span class="n">to</span> <span class="n">archive</span> <span class="n">system</span>
<span class="n">BLOCKED</span> <span class="o">-</span> <span class="n">Job</span> <span class="n">blocked</span>
<span class="n">PAUSED</span> <span class="o">-</span> <span class="n">Job</span> <span class="n">processing</span> <span class="n">suspended</span>
<span class="n">FINISHED</span> <span class="o">-</span> <span class="n">Job</span> <span class="n">completed</span> <span class="n">successfully</span>
<span class="n">CANCELLED</span> <span class="o">-</span> <span class="n">Job</span> <span class="n">execution</span> <span class="n">intentionally</span> <span class="n">stopped</span>
<span class="n">FAILED</span> <span class="o">-</span> <span class="n">Job</span> <span class="n">failed</span>
</pre></div>
</div>
<p>Normal processing of a successfully executing job proceeds as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PENDING</span><span class="o">-&gt;</span><span class="n">PROCESSING_INPUTS</span><span class="o">-&gt;</span><span class="n">STAGING_INPUTS</span><span class="o">-&gt;</span><span class="n">STAGING_JOB</span><span class="o">-&gt;</span><span class="n">SUBMITTING_JOB</span><span class="o">-&gt;</span>
  <span class="n">QUEUED</span><span class="o">-&gt;</span><span class="n">RUNNING</span><span class="o">-&gt;</span><span class="n">ARCHIVING</span><span class="o">-&gt;</span><span class="n">FINISHED</span>
</pre></div>
</div>
</section>
<section id="notification-messages">
<h3>Notification Messages<a class="headerlink" href="#notification-messages" title="Link to this heading"></a></h3>
<p>Notifications are the messages sent to subscribers who have registered interest in certain job events.  See <a class="reference external" href="#subscriptions">Subscriptions</a> for an introduction to the different event types and a discussion of JOB_USER_EVENT content.  In this section, we specify the messages sent to subscribers for Jobs-generated events.</p>
<p>For events generated by the Jobs service, the <em>data</em> field in notification messages received by subscribers contains a JSON object that always include these fields:</p>
<ul class="simple">
<li><p><em>jobName</em> - the user-specified job name</p></li>
<li><p><em>jobOwner</em> - the user who submitted the job</p></li>
<li><p><em>jobUuid</em> - the unique job ID</p></li>
<li><p><em>message</em> - a human readable message</p></li>
</ul>
<p>Each of the Job event types also include additional fields as shown:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Job Event Type</p></th>
<th class="head"><p>Additional Fields</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>JOB_NEW_STATUS</p></td>
<td><p>newJobStatus, oldJobStatus</p></td>
</tr>
<tr class="row-odd"><td><p>JOB_INPUT_TRANSACTION_ID</p></td>
<td><p>transferStatus, transactionId</p></td>
</tr>
<tr class="row-even"><td><p>JOB_ARCHIVE_TRANSACTION_ID</p></td>
<td><p>transferStatus, transactionId</p></td>
</tr>
<tr class="row-odd"><td><p>JOB_SUBSCRIPTION</p></td>
<td><p>action, numSubscriptions</p></td>
</tr>
<tr class="row-even"><td><p>JOB_SHARE_EVENT</p></td>
<td><p>resourceType, shareType,
grantee, grantor</p></td>
</tr>
<tr class="row-odd"><td><p>JOB_ERROR_MESSAGE</p></td>
<td><p>jobStatus</p></td>
</tr>
</tbody>
</table>
<p>Additionally, when either of these conditions hold:</p>
<ol class="arabic simple">
<li><p>JOB_NEW_STATUS messages indicate a <strong>terminal</strong> <em>newJobStatus</em>, or</p></li>
<li><p>JOB_ERROR_MESSAGE messages have <em>eventDetail</em> = “FINAL_MESSAGE”,</p></li>
</ol>
<p>then the following additional fields are included in the notification:</p>
<ul class="simple">
<li><p><em>blockedCount</em> - the number of times the job blocked (JSON number)</p></li>
<li><p><em>remoteJobId</em> - execution system job id (ex: pid, slurm id, docker hash, etc.)</p></li>
<li><p><em>remoteJobId2</em> - execution system auxilliary id associated with a job</p></li>
<li><p><em>remoteOutcome</em> - FINISHED, FAILED, FAILED_SKIP_ARCHIVE</p></li>
<li><p><em>remoteResultInfo</em> - application exit code</p></li>
<li><p><em>remoteQueue</em> - execution system scheduler queue</p></li>
<li><p><em>remoteSubmitted</em> - time job was submitted on remote system</p></li>
<li><p><em>remoteStarted</em> - time job started running on remote system</p></li>
<li><p><em>remoteEnded</em> - time job stopped running on remote system</p></li>
</ul>
<p>Job terminal statuses are FINISHED, CANCELLED and FAILED.</p>
</section>
<section id="dynamic-execution-system-selection">
<h3>Dynamic Execution System Selection<a class="headerlink" href="#dynamic-execution-system-selection" title="Link to this heading"></a></h3>
<p>Not implementated yet.</p>
</section>
<section id="data-transfer-nodes">
<h3>Data Transfer Nodes<a class="headerlink" href="#data-transfer-nodes" title="Link to this heading"></a></h3>
<p>A Tapis system can be designated as a Data Transfer Node (DTN) as part of its definition.  When an execution system specifies DTN usage in its definition, then the Jobs service will use the DTN to stage input files and archive output files.</p>
<p>The DTN usage pattern is effective when (1) the DTN has high performance network and storage capabilities, and (2) an execution system can mount the DTN’s file system.  In this situation, bulk data transfers performed by Jobs benefit from the DTN’s high performance capabilities, while applications continue to access their execution system’s files as usual.  From an application’s point of view, its data are simply where they are expected to be, though they may have gotten there in a more expeditious manner.</p>
<p>DTN usage requires the coordinated configuration of a DTN, an execution system and a job.  In addition, outside of Tapis, a system administrator must mount the exported DTN file system at the expected mountpoint on an execution system.  We use the example below to illustrate DTN configuration and usage.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>System: ds-exec
  rootDir: /execRoot
  dtnMountSourcePath: tapis://corral-dtn/
  dtnMountPoint: /corral-repl
  jobWorkingDir: HOST_EVAL($SCRATCH)

System: corral-dtn
  host: cic-dtn01
  isDtn: true
  rootDir: /gpfs/corral3/repl

Job Request effective values:
  execSystemId:         ds-exec
  execSystemExecDir:    ${JobWorkingDir}/jobs/${JobUUID}
  execSystemInputDir:   ${DtnMountPoint}/projects/NHERI/shared/${JobOwner}/jobs/${JobUUID}
  execSystemOutputDir:  ${DtnMountPoint}/projects/NHERI/shared/${JobOwner}/jobs/${JobUUID}/output

NFS Mount on ds-exec (done outside of Tapis):
  mount -t nfs cic-dtn01:/gpfs/corral3/repl /execRoot/corral-repl
</pre></div>
</div>
<p>The example execution system, <strong>ds-exec</strong>, defines two DTN related values (both required to configure DTN usage):</p>
<dl class="simple">
<dt><strong>dtnMountSourcePath</strong></dt><dd><p>The tapis URL specifying the exported DTN path; the path is relative to the DTN system’s rootDir (which is just “/” in this example).</p>
</dd>
<dt><strong>dtnMountPoint</strong></dt><dd><p>The path relative to the execution system’s rootDir where the DtnMountSourcePath is mounted.</p>
</dd>
</dl>
<p>The execution system’s jobWorkingDir is defined to be the runtime value of the $SCRATCH environment variable; its rootDir is defined at /execRoot.</p>
<p>The Tapis DTN system, <strong>corral-dtn</strong>, host machine is cic-dtn01.  The DTN’s rootDir (/gpfs/corral3/repl) is the directory prefix used on all mounts.  Mounting takes place outside of Tapis by system administrators.  The actual NFS mount command has this general format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mount</span> <span class="o">-</span><span class="n">t</span> <span class="n">nfs</span> <span class="o">&lt;</span><span class="n">dtn_host</span><span class="o">&gt;</span><span class="p">:</span><span class="o">/&lt;</span><span class="n">dtn_root_dir</span><span class="o">&gt;/&lt;</span><span class="n">path</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">exec_system_mount_point</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The Job Request effective values depend on the DTN configuration are also shown.  These values could have been set in the application definition, the job request or in both.  Values set in the job request are given priority.  The execSystemId refers to the <strong>ds-exec</strong> system, which in this case specifies a DTN.</p>
<p>Continuing with the above example, let’s say user <em>Bud</em> issues an Opensees job request that creates a job with id 123.  The Jobs service will stage the application’s input files using the DTN.  The transfer request to the <a class="reference external" href="https://tapis.readthedocs.io/en/latest/technical/files.html">Files</a> service will write to this target URL:</p>
<blockquote>
<div><p>tapis://corral-dtn/gpfs/corral3/repl/projects/NHERI/shared/Bud/jobs/123</p>
</div></blockquote>
<p>This is the standard tapis URL format:  tapis://&lt;tapis-system&gt;/&lt;path&gt;.  After inputs are staged, the Job service will inject this environment variable value (among others) into the launched job’s container:</p>
<blockquote>
<div><p>execSystemInputDir=/corral-repl/projects/NHERI/shared/Bud/jobs/123</p>
</div></blockquote>
<p>Since <strong>ds-exec</strong> mounts the corral root directory, the files staged to corral /gpfs/corral3/repl are accessible at execSystemInputDir on <strong>ds-exec</strong>, relative to rootDir /execRoot. A similar approach would be used to transfer files to an archive system using the DTN, except this time <strong>corral-dtn</strong> is the source of the file transfers rather than the target.</p>
</section>
</section>
<hr class="docutils" />
<section id="container-runtimes">
<h2>Container Runtimes<a class="headerlink" href="#container-runtimes" title="Link to this heading"></a></h2>
<p>The Tapis v3 Jobs service currently supports Docker and Singularity containers run natively (i.e., not run using a batch scheduler like Slurm).  In general, Jobs launches an application’s container on a remote system, monitors the container’s execution, and captures the application’s exit code after it terminates.  Jobs uses SSH to connect to the execution system to issue Docker, Singularity or native operating system commands.</p>
<p>To launch a job, the Jobs service creates a bash script, <strong>tapisjob.sh</strong>, with the runtime-specific commands needed to execute the container.  This script references <strong>tapisjob.env</strong>, a file Jobs creates to pass environment variables to application containers.  Both files are staged in the job’s execSystemExecDir and, by default, are archived with job output on the archive system.  See <a class="reference internal" href="#archivefilter">archiveFilter</a> to override this default behavior, especially if archives will be shared and the scripts pass sensitive information into containers.</p>
<section id="docker">
<h3>Docker<a class="headerlink" href="#docker" title="Link to this heading"></a></h3>
<p>To launch a Docker container, the Jobs service will SSH to the target host and issue a command using this template:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="p">[</span><span class="n">docker</span> <span class="n">options</span><span class="p">]</span> <span class="n">image</span><span class="p">[:</span><span class="n">tag</span><span class="o">|</span><span class="nd">@digest</span><span class="p">]</span> <span class="p">[</span><span class="n">application</span> <span class="n">args</span><span class="p">]</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>docker options:  (optional) user-specified arguments passed to docker</p></li>
<li><p>image:  (required) user-specified docker application image</p></li>
<li><p>application arguments:  (optional) user-specified command line arguments passed to the application</p></li>
</ol>
<p>The docker <a class="reference external" href="https://docs.docker.com/engine/reference/commandline/run/">run-command</a> options <em>–cidfile</em>, <em>-d</em>, <em>-e</em>, <em>–env</em>, <em>–name</em>, <em>–rm</em>, and <em>–user</em> are reserved for use by Tapis.  Most other Docker options are available to the user.  The Jobs service implements these calling conventions:</p>
<ol class="arabic simple">
<li><p>The container name is set to the job UUID.</p></li>
<li><p>The container’s user is set to the user ID used to establish the SSH session.</p></li>
<li><p>The container ID file is specified as <em>&lt;JobUUID&gt;.cid</em> in the execSystemExecDir, i.e., the directory from which the container is launched.</p></li>
<li><p>The container is removed after execution using the <em>-rm</em> option or by calling <em>docker rm</em>.</p></li>
</ol>
<section id="logging">
<h4>Logging<a class="headerlink" href="#logging" title="Link to this heading"></a></h4>
<p>Logging should be considered up front when defining Tapis applications to run under Docker.  Since Jobs removes Docker containers after they execute, the container’s log is lost under the default Docker <a class="reference external" href="https://docs.docker.com/config/containers/logging/">logging</a> configuration.  Typically, Docker pipes <em>stdout</em> and <em>stderr</em> to the container’s log, which requires the application to take deliberate steps to preserve these outputs.</p>
<p>An application can maintain control over its log output by logging to a file outside of the container.  The application can do this by redirecting <em>stdout</em> and <em>stderr</em> or by explicitly writing to a file.  As discussed in <a class="reference internal" href="#dir-definitions">dir-definitions</a>, the application always has read/write access to the host’s <em>execSystemOutputDir</em>, which is mounted at /TapisOutput in the container (see next section).</p>
<p>On the other hand, applications can run on machines where the default Docker log driver is configured to write to files or services outside of containers.  In addition, Tapis passes any user-specified <em>log-driver</em> and <em>log-opts</em> options to <em>docker run</em>, so all <a class="reference external" href="https://docs.docker.com/config/containers/logging/configure/">customizations</a> supported by Docker are possible.</p>
</section>
<section id="volume-mounts">
<h4>Volume Mounts<a class="headerlink" href="#volume-mounts" title="Link to this heading"></a></h4>
<p>In addition to the above conventions, <a class="reference external" href="https://docs.docker.com/storage/bind-mounts/">bind</a> mounts are used to mount the execution system’s standard Tapis directories at the same locations in every application container.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">execSystemExecDir</span>   <span class="n">on</span> <span class="n">host</span> <span class="ow">is</span> <span class="n">mounted</span> <span class="n">at</span> <span class="o">/</span><span class="n">TapisExec</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">container</span><span class="o">.</span>
<span class="n">execSystemInputDir</span>  <span class="n">on</span> <span class="n">host</span> <span class="ow">is</span> <span class="n">mounted</span> <span class="n">at</span> <span class="o">/</span><span class="n">TapisInput</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">container</span><span class="o">.</span>
<span class="n">execSystemOutputDir</span> <span class="n">on</span> <span class="n">host</span> <span class="ow">is</span> <span class="n">mounted</span> <span class="n">at</span> <span class="o">/</span><span class="n">TapisOutput</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">container</span><span class="o">.</span>
</pre></div>
</div>
</section>
</section>
<section id="singularity">
<h3>Singularity<a class="headerlink" href="#singularity" title="Link to this heading"></a></h3>
<p>Tapis provides two distinct ways to launch a Singularity containers, using <em>singluarity instance start</em> or <em>singularity run</em>.</p>
<section id="singularity-start">
<h4>Singularity Start<a class="headerlink" href="#singularity-start" title="Link to this heading"></a></h4>
<p>Singularity’s support for detached processes and services is implemented natively by its instance <a class="reference external" href="https://sylabs.io/guides/3.7/user-guide/cli/singularity_instance_start.html">start</a>, <a class="reference external" href="https://sylabs.io/guides/3.7/user-guide/cli/singularity_instance_stop.html">stop</a> and <a class="reference external" href="https://sylabs.io/guides/3.7/user-guide/cli/singularity_instance_list.html">list</a> commands.  To launch a container, the Jobs service will SSH to the target host and issue a command using this template:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">singularity</span> <span class="n">instance</span> <span class="n">start</span> <span class="p">[</span><span class="n">singularity</span> <span class="n">options</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">image</span> <span class="nb">id</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">application</span> <span class="n">arguments</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">job</span> <span class="n">uuid</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>where:</p>
<ol class="arabic simple">
<li><p>singularity options:  (optional) user-specified argument passed to singularity start</p></li>
<li><p>image id:  (required) user-specified singularity application image</p></li>
<li><p>application arguments:  (optional) user-specified command line arguments passed to the application</p></li>
<li><p>job uuid:  the job uuid used to name the instance (always set by Jobs)</p></li>
</ol>
<p>The singularity options <em>–pidfile</em>, <em>–env</em> and <em>–name</em> are reserved for use by Tapis.  Users specify the environment variables to be injected into their application containers via the <a class="reference internal" href="#envvariables">envVariables</a> parameter.  Most other singularity options are available to users.</p>
<p>Jobs will then issue <em>singularity instance list</em> to obtain the container’s process id (PID).  Jobs determines that the application has terminated when the PID is no longer in use by the operating system.</p>
<p>By convention, Jobs will look for a <strong>tapisjob.exitcode</strong> file in the Job’s output directory after containers terminate.  If found, the file should contain only the integer code the application reported when it exited.  If not found, Jobs assumes the application exited normally with a zero exit code.</p>
<p>Finally, Jobs issues a <em>singularity instance stop &lt;job uuid&gt;</em> to clean up the singularity runtime environment and terminate all processes associated with the container.</p>
</section>
<section id="singularity-run">
<h4>Singularity Run<a class="headerlink" href="#singularity-run" title="Link to this heading"></a></h4>
<p>Jobs also supports a more do-it-yourself approach to running containers on remote system using singularity <a class="reference external" href="https://sylabs.io/guides/3.7/user-guide/cli/singularity_run.html">run</a>.  To launch a container, the Jobs service will SSH to the target host and issue a command using this template:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nohup</span> <span class="n">singularity</span> <span class="n">run</span> <span class="p">[</span><span class="n">singularity</span> <span class="n">options</span><span class="o">.</span><span class="p">]</span> <span class="o">&lt;</span><span class="n">image</span> <span class="nb">id</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">application</span> <span class="n">arguments</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">tapisjob</span><span class="o">.</span><span class="n">out</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span> <span class="o">&amp;</span>
</pre></div>
</div>
<p>where:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Nohup">nohup</a>:  allows the background process to continue running even if the SSH session ends.</p></li>
<li><p>singularity options:  (optional) user-specified arguments passed to singularity run.</p></li>
<li><p>image id:  (required) user-specified singularity application image.</p></li>
<li><p>application arguments:  (optional) user-specified command line arguments passed to the application.</p></li>
<li><p>redirection:  stdout and stderr are redirected to <strong>tapisjob.out</strong> in the job’s output directory.</p></li>
</ol>
<p>The singularity <em>–env</em> option is reserved for use by Tapis.  Users specify the environment variables to be injected into their application containers via the <a class="reference internal" href="#envvariables">envVariables</a> parameter.  Most other singularity options are available to users.</p>
<p>Jobs will use the PID returned when issuing the background command to monitor the container’s execution.  Jobs determines that the application has terminated when the PID is no longer in use by the operating system.</p>
<p>Jobs uses the same <strong>TapisJob.exitcode</strong> file convention introduced above to attain the application’s exit code (if the file exists).</p>
</section>
<section id="required-scripts">
<h4>Required Scripts<a class="headerlink" href="#required-scripts" title="Link to this heading"></a></h4>
<p>The Singularity Start and Singularity Run approaches boath allow SSH sessions between Jobs and execution hosts to end without interrupting container execution.  Each approach, however, requires that the application image be appropriately constructed.  Specifically,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Singularity</span> <span class="n">start</span> <span class="n">requires</span> <span class="n">the</span> <span class="n">startscript</span> <span class="n">to</span> <span class="n">be</span> <span class="n">defined</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">image</span><span class="o">.</span>
<span class="n">Singularity</span> <span class="n">run</span> <span class="n">requires</span> <span class="n">the</span> <span class="n">runscript</span> <span class="n">to</span> <span class="n">be</span> <span class="n">defined</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">image</span><span class="o">.</span>
</pre></div>
</div>
</section>
<section id="required-termination-order">
<h4>Required Termination Order<a class="headerlink" href="#required-termination-order" title="Link to this heading"></a></h4>
<p>Since Jobs monitors container execution by querying the operating system using the PID obtained at launch time, the initially launched program should be the last part of the application to terminate.  The program specified in the image script can spawn any number of processes (and threads), but it should not exit before those processes complete.</p>
</section>
<section id="optional-exit-code-convention">
<h4>Optional Exit Code Convention<a class="headerlink" href="#optional-exit-code-convention" title="Link to this heading"></a></h4>
<p>Applications are not required to support the <strong>TapisJob.exitcode</strong> file convention as described above, but it is the only way in which Jobs can report the application specified exit status to the user.</p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="querying-jobs">
<h2>Querying Jobs<a class="headerlink" href="#querying-jobs" title="Link to this heading"></a></h2>
<section id="get-jobs-list">
<h3>Get Jobs list<a class="headerlink" href="#get-jobs-list" title="Link to this heading"></a></h3>
<p>With PySDK:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ t.jobs.getJobList(limit=2, orderBy=&#39;lastUpdated(desc),name(asc)&#39;, computeTotal=True)
</pre></div>
</div>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -H &quot;X-Tapis-Token:$jwt&quot; $BASE_URL/v3/jobs/list?limit=2&amp;orderBy=lastUpdated(desc),name(asc)&amp;computeTotal=true
</pre></div>
</div>
<p>The response will look something like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;731b65f4-43e9-4a7a-b3a0-68644b53c1cb-007&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SyRunSleepSecondsNoIPFiles-2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;appId&quot;</span><span class="p">:</span> <span class="s2">&quot;SyRunSleepSecondsNoIPFiles-2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-21T19:56:02.163984Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;FINISHED&quot;</span><span class="p">,</span>
        <span class="s2">&quot;remoteStarted&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-21T19:56:18.628448Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ended&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-21T19:56:52.637554Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tenant&quot;</span><span class="p">:</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
        <span class="s2">&quot;execSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;archiveSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;appVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-21T19:56:52.637554Z&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;79dfaba5-bfb4-4c6d-a198-643bda211dbf-007&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SlurmSleepSeconds&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;appId&quot;</span><span class="p">:</span> <span class="s2">&quot;SlurmSleepSecondsVM&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-21T19:16:02.019916Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;FINISHED&quot;</span><span class="p">,</span>
        <span class="s2">&quot;remoteStarted&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-21T19:16:35.102868Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ended&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-21T19:16:57.909940Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tenant&quot;</span><span class="p">:</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
        <span class="s2">&quot;execSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec2-slurm&quot;</span><span class="p">,</span>
        <span class="s2">&quot;archiveSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec2-slurm&quot;</span><span class="p">,</span>
        <span class="s2">&quot;appVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-21T19:16:57.909940Z&quot;</span>
    <span class="p">}</span>
<span class="p">],</span>
<span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_LIST_RETRIVED Jobs list for the user testuser2 in the tenant dev retrived.&quot;</span><span class="p">,</span>
<span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0-rc1&quot;</span><span class="p">,</span>
<span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;recordCount&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;recordLimit&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;recordsSkipped&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;orderBy&quot;</span><span class="p">:</span> <span class="s2">&quot;lastUpdated(desc),name(asc)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;startAfter&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;totalCount&quot;</span><span class="p">:</span> <span class="mi">1799</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="get-job-details">
<h3>Get Job Details<a class="headerlink" href="#get-job-details" title="Link to this heading"></a></h3>
<p>With PySDK:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ t.jobs.getJob(jobUuid=&#39;ba34f946-8a18-44c4-9b25-19e21dfadf69-007&#39;)
</pre></div>
</div>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -H &quot;X-Tapis-Token:$jwt&quot; $BASE_URL/v3/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007
</pre></div>
</div>
<p>The response will look something like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="p">{</span>
  <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1711</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SyRunSleepSecondsNoIPFiles-2&quot;</span><span class="p">,</span>
      <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tenant&quot;</span><span class="p">:</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Sleep for a specified amount of time&quot;</span><span class="p">,</span>
      <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;FINISHED&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lastMessage&quot;</span><span class="p">:</span> <span class="s2">&quot;Setting job status to FINISHED.&quot;</span><span class="p">,</span>
      <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:01.790165Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ended&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:55.962694Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:55.962694Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;ba34f946-8a18-44c4-9b25-19e21dfadf69-007&quot;</span><span class="p">,</span>
      <span class="s2">&quot;appId&quot;</span><span class="p">:</span> <span class="s2">&quot;SyRunSleepSecondsNoIPFiles-2&quot;</span><span class="p">,</span>
      <span class="s2">&quot;appVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;archiveOnAppError&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;dynamicExecSystem&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
      <span class="s2">&quot;execSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec2&quot;</span><span class="p">,</span>
      <span class="s2">&quot;execSystemExecDir&quot;</span><span class="p">:</span> <span class="s2">&quot;/workdir/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007&quot;</span><span class="p">,</span>
      <span class="s2">&quot;execSystemInputDir&quot;</span><span class="p">:</span> <span class="s2">&quot;/workdir/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007&quot;</span><span class="p">,</span>
      <span class="s2">&quot;execSystemOutputDir&quot;</span><span class="p">:</span> <span class="s2">&quot;/workdir/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/output&quot;</span><span class="p">,</span>
      <span class="s2">&quot;execSystemLogicalQueue&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;archiveSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec&quot;</span><span class="p">,</span>
      <span class="s2">&quot;archiveSystemDir&quot;</span><span class="p">:</span> <span class="s2">&quot;/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/archive&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dtnSystemId&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;dtnMountSourcePath&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;dtnMountPoint&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;nodeCount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;coresPerNode&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;memoryMB&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s2">&quot;maxMinutes&quot;</span><span class="p">:</span> <span class="mi">240</span><span class="p">,</span>
      <span class="s2">&quot;fileInputs&quot;</span><span class="p">:</span> <span class="s2">&quot;[]&quot;</span><span class="p">,</span>
      <span class="s2">&quot;parameterSet&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="se">\&quot;</span><span class="s2">appArgs</span><span class="se">\&quot;</span><span class="s2">: [], </span><span class="se">\&quot;</span><span class="s2">envVariables</span><span class="se">\&quot;</span><span class="s2">: [{</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisAppId</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">SyRunSleepSecondsNoIPFiles-2</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisAppVersion</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">0.0.1</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisArchiveOnAppError</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">true</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisArchiveSystemDir</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/archive</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisArchiveSystemId</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">tapisv3-exec</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisCoresPerNode</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisDynamicExecSystem</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">false</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisEffeciveUserId</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">testuser2</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisExecSystemExecDir</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">/workdir/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisExecSystemId</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">tapisv3-exec2</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisExecSystemInputDir</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">/workdir/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisExecSystemOutputDir</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">/workdir/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/output</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisJobCreateDate</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">2021-07-12Z</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisJobCreateTime</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">23:56:01.790165454Z</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisJobCreateTimestamp</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">2021-07-12T23:56:01.790165454Z</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisJobName</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">SyRunSleepSecondsNoIPFiles-2</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisJobOwner</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">testuser2</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisJobUUID</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">ba34f946-8a18-44c4-9b25-19e21dfadf69-007</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisJobWorkingDir</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">workdir</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisMaxMinutes</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">240</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisMemoryMB</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">100</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisNodes</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">1</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisSysHost</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">129.114.17.113</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisSysRootDir</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">/home/testuser2</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">_tapisTenant</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">dev</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">JOBS_PARMS</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">15</span><span class="se">\&quot;</span><span class="s2">}, {</span><span class="se">\&quot;</span><span class="s2">key</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">MAIN_CLASS</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">value</span><span class="se">\&quot;</span><span class="s2">: </span><span class="se">\&quot;</span><span class="s2">edu.utexas.tacc.testapps.tapis.SleepSecondsSy</span><span class="se">\&quot;</span><span class="s2">}], </span><span class="se">\&quot;</span><span class="s2">archiveFilter</span><span class="se">\&quot;</span><span class="s2">: {</span><span class="se">\&quot;</span><span class="s2">excludes</span><span class="se">\&quot;</span><span class="s2">: [], </span><span class="se">\&quot;</span><span class="s2">includes</span><span class="se">\&quot;</span><span class="s2">: [</span><span class="se">\&quot;</span><span class="s2">Sleep*</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">tapisjob.*</span><span class="se">\&quot;</span><span class="s2">], </span><span class="se">\&quot;</span><span class="s2">includeLaunchFiles</span><span class="se">\&quot;</span><span class="s2">: true}, </span><span class="se">\&quot;</span><span class="s2">containerArgs</span><span class="se">\&quot;</span><span class="s2">: [], </span><span class="se">\&quot;</span><span class="s2">schedulerOptions</span><span class="se">\&quot;</span><span class="s2">: []}&quot;</span><span class="p">,</span>
      <span class="s2">&quot;execSystemConstraints&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;subscriptions&quot;</span><span class="p">:</span> <span class="s2">&quot;[]&quot;</span><span class="p">,</span>
      <span class="s2">&quot;blockedCount&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;remoteJobId&quot;</span><span class="p">:</span> <span class="s2">&quot;1466046&quot;</span><span class="p">,</span>
      <span class="s2">&quot;remoteJobId2&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;remoteOutcome&quot;</span><span class="p">:</span> <span class="s2">&quot;FINISHED&quot;</span><span class="p">,</span>
      <span class="s2">&quot;remoteResultInfo&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
      <span class="s2">&quot;remoteQueue&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;remoteSubmitted&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;remoteStarted&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:20.900039Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;remoteEnded&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:42.411522Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;remoteSubmitRetries&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;remoteChecksSuccess&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
      <span class="s2">&quot;remoteChecksFailed&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;remoteLastStatusCheck&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:42.382661Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;inputTransactionId&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;inputCorrelationId&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;archiveTransactionId&quot;</span><span class="p">:</span> <span class="s2">&quot;66bc6c9a-210b-4ee6-9da3-252922928e7b&quot;</span><span class="p">,</span>
      <span class="s2">&quot;archiveCorrelationId&quot;</span><span class="p">:</span> <span class="s2">&quot;87f62e69-c180-4ad1-9aa7-ac5ada78e1b6&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tapisQueue&quot;</span><span class="p">:</span> <span class="s2">&quot;tapis.jobq.submit.DefaultQueue&quot;</span><span class="p">,</span>
      <span class="s2">&quot;visible&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
      <span class="s2">&quot;createdby&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
      <span class="s2">&quot;createdbyTenant&quot;</span><span class="p">:</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="s2">&quot;singularity&quot;</span><span class="p">,</span>
          <span class="s2">&quot;sleep&quot;</span><span class="p">,</span>
          <span class="s2">&quot;test&quot;</span>
      <span class="p">],</span>
      <span class="s2">&quot;_fileInputsSpec&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;_parameterSetModel&quot;</span><span class="p">:</span> <span class="n">null</span>
  <span class="p">},</span>
  <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
  <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_RETRIEVED Job ba34f946-8a18-44c4-9b25-19e21dfadf69-007 retrieved.&quot;</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0-rc1&quot;</span><span class="p">,</span>
<span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">null</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="get-job-status">
<h3>Get Job Status<a class="headerlink" href="#get-job-status" title="Link to this heading"></a></h3>
<p>With PySDK:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ t.jobs.getJobStatus(jobUuid=&#39;ba34f946-8a18-44c4-9b25-19e21dfadf69-007&#39;)
</pre></div>
</div>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -H &quot;X-Tapis-Token:$jwt&quot; $BASE_URL/v3/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/status
</pre></div>
</div>
<p>The response will look something like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;FINISHED&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_STATUS_RETRIEVED Status of the Job ba34f946-8a18-44c4-9b25-19e21dfadf69-007 retrieved.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0-rc1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">null</span>
    <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="get-job-history">
<h3>Get Job History<a class="headerlink" href="#get-job-history" title="Link to this heading"></a></h3>
<p>With PySDK:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ t.jobs.getJobHistory(jobUuid=&#39;ba34f946-8a18-44c4-9b25-19e21dfadf69-007&#39;)
</pre></div>
</div>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -H &quot;X-Tapis-Token:$jwt&quot; $BASE_URL/v3/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/history
</pre></div>
</div>
<p>The response will look something like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB_NEW_STATUS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:02.365996Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;PENDING&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The job has transitioned to a new status: PENDING.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transferTaskUuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;transferSummary&quot;</span><span class="p">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB_NEW_STATUS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:02.799166Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;PROCESSING_INPUTS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The job has transitioned to a new status: PROCESSING_INPUTS. The previous job status was PENDING.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transferTaskUuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;transferSummary&quot;</span><span class="p">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB_NEW_STATUS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:10.203007Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;STAGING_INPUTS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The job has transitioned to a new status: STAGING_INPUTS. The previous job status was PROCESSING_INPUTS.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transferTaskUuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;transferSummary&quot;</span><span class="p">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB_NEW_STATUS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:10.226013Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;STAGING_JOB&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The job has transitioned to a new status: STAGING_JOB. The previous job status was STAGING_INPUTS.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transferTaskUuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;transferSummary&quot;</span><span class="p">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB_NEW_STATUS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:20.720637Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;SUBMITTING_JOB&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The job has transitioned to a new status: SUBMITTING_JOB. The previous job status was STAGING_JOB.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transferTaskUuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;transferSummary&quot;</span><span class="p">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB_NEW_STATUS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:20.888569Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;QUEUED&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The job has transitioned to a new status: QUEUED. The previous job status was SUBMITTING_JOB.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transferTaskUuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;transferSummary&quot;</span><span class="p">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB_NEW_STATUS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:20.902511Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;RUNNING&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The job has transitioned to a new status: RUNNING. The previous job status was QUEUED.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transferTaskUuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;transferSummary&quot;</span><span class="p">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB_NEW_STATUS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:42.427492Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;ARCHIVING&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The job has transitioned to a new status: ARCHIVING. The previous job status was RUNNING.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transferTaskUuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;transferSummary&quot;</span><span class="p">:</span> <span class="p">{}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;event&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB_NEW_STATUS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:55.966883Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;FINISHED&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The job has transitioned to a new status: FINISHED. The previous job status was ARCHIVING.&quot;</span><span class="p">,</span>
        <span class="s2">&quot;transferTaskUuid&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;transferSummary&quot;</span><span class="p">:</span> <span class="p">{}</span>
    <span class="p">}</span>
<span class="p">],</span>
<span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_HISTORY_RETRIEVED Job ba34f946-8a18-44c4-9b25-19e21dfadf69-007 history retrieved for user testuser2 tenant dev&quot;</span><span class="p">,</span>
<span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0-rc1&quot;</span><span class="p">,</span>
<span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;recordCount&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
    <span class="s2">&quot;recordLimit&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;recordsSkipped&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;orderBy&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;startAfter&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;totalCount&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="get-job-output-listing">
<h3>Get Job Output Listing<a class="headerlink" href="#get-job-output-listing" title="Link to this heading"></a></h3>
<p>With PySDK:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ t.jobs.getJobOutputList(jobUuid=&#39;ba34f946-8a18-44c4-9b25-19e21dfadf69-007&#39;, outputPath=&#39;/&#39;)
</pre></div>
</div>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -H &quot;X-Tapis-Token:$jwt&quot; $BASE_URL/v3/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/output/list/
</pre></div>
</div>
<p>The response will look something like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;mimeType&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;1003&quot;</span><span class="p">,</span>
        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;1003&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nativePermissions&quot;</span><span class="p">:</span> <span class="s2">&quot;rw-rw-r--&quot;</span><span class="p">,</span>
        <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;tapis://dev/tapisv3-exec/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/archive/SleepSeconds.out&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lastModified&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:54Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SleepSeconds.out&quot;</span><span class="p">,</span>
        <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/archive/SleepSeconds.out&quot;</span><span class="p">,</span>
        <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">3538</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;mimeType&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;1003&quot;</span><span class="p">,</span>
        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;1003&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nativePermissions&quot;</span><span class="p">:</span> <span class="s2">&quot;rw-rw-r--&quot;</span><span class="p">,</span>
        <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;tapis://dev/tapisv3-exec/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/archive/tapisjob.env&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lastModified&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:53Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisjob.env&quot;</span><span class="p">,</span>
        <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/archive/tapisjob.env&quot;</span><span class="p">,</span>
        <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">1051</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;mimeType&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;1003&quot;</span><span class="p">,</span>
        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;1003&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nativePermissions&quot;</span><span class="p">:</span> <span class="s2">&quot;rw-rw-r--&quot;</span><span class="p">,</span>
        <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;tapis://dev/tapisv3-exec/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/archive/tapisjob.exitcode&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lastModified&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:54Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisjob.exitcode&quot;</span><span class="p">,</span>
        <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/archive/tapisjob.exitcode&quot;</span><span class="p">,</span>
        <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;mimeType&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;1003&quot;</span><span class="p">,</span>
        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;1003&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nativePermissions&quot;</span><span class="p">:</span> <span class="s2">&quot;rw-rw-r--&quot;</span><span class="p">,</span>
        <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;tapis://dev/tapisv3-exec/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/archive/tapisjob.out&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lastModified&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:54Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisjob.out&quot;</span><span class="p">,</span>
        <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/archive/tapisjob.out&quot;</span><span class="p">,</span>
        <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">3566</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;mimeType&quot;</span><span class="p">:</span> <span class="s2">&quot;application/x-shar&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;1003&quot;</span><span class="p">,</span>
        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;1003&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nativePermissions&quot;</span><span class="p">:</span> <span class="s2">&quot;rw-rw-r--&quot;</span><span class="p">,</span>
        <span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;tapis://dev/tapisv3-exec/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/archive/tapisjob.sh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lastModified&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-12T23:56:54Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisjob.sh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/archive/tapisjob.sh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="mi">979</span>
    <span class="p">}</span>
<span class="p">],</span>
<span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_OUTPUT_FILES_LIST_RETRIEVED Job ba34f946-8a18-44c4-9b25-19e21dfadf69-007 output files list retrieved for the user testuser2 in the tenant dev.&quot;</span><span class="p">,</span>
<span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0-rc1&quot;</span><span class="p">,</span>
<span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;recordCount&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s2">&quot;recordLimit&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;recordsSkipped&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;orderBy&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;startAfter&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;totalCount&quot;</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The Job output list API retrieves job’s output files list for a previously submitted job by its UUID.
By default, the job must be in a terminal state (FINISHED or FAILED or CANCELLED) for the API to list the job’s output files .
There is a query parameter allowIfRunning set to false by default.
If allowIfRunning=true, the API returns the job output files list even if the job is not in the terminal state.
Note that if a file is being written, still the file is listed.</p>
</section>
<section id="get-job-output-download">
<h3>Get Job Output Download<a class="headerlink" href="#get-job-output-download" title="Link to this heading"></a></h3>
<p>With PySDK:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ t.jobs.getJobOutputDownload(jobUuid=&#39;ba34f946-8a18-44c4-9b25-19e21dfadf69-007&#39;, outputPath=&#39;/&#39;)
</pre></div>
</div>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -H &quot;X-Tapis-Token:$jwt&quot; $BASE_URL/v3/jobs/ba34f946-8a18-44c4-9b25-19e21dfadf69-007/output/download/ --output joboutput.zip
</pre></div>
</div>
<p>All the files in the the requested outputPath get downloaded in a zip file.</p>
<p>The Jobs output download API retrieves the job’s output files for a previously submitted job by its UUID.
By default, the job must be in a terminal state (FINISHED or FAILED or CANCELLED) for the API to download the job’s output files.
There is a query parameter allowIfRunning set to false by default.
If allowIfRunning=true, the API allows downloading the job output files even if the job is not in the terminal state.
Note that if a file is being written at the time of the request, the file is still downloaded with the current content.</p>
</section>
</section>
<section id="dedicated-search-endpoint">
<h2>Dedicated Search Endpoint<a class="headerlink" href="#dedicated-search-endpoint" title="Link to this heading"></a></h2>
<p>The jobs service provides dedicated search end-points to query jobs based on different conditions. The GET end-point allows to specify the query in the query parameters while the POST end-point allows complex queries in the request body using SQL-like syntax.</p>
<section id="search-using-get-on-dedicated-endpoint">
<h3>Search using GET on Dedicated Endpoint<a class="headerlink" href="#search-using-get-on-dedicated-endpoint" title="Link to this heading"></a></h3>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -H &quot;X-Tapis-Token:$jwt&quot; $BASE_URL/v3/jobs/search?limit=2&amp;status.eq=FINISHED&amp;created.between=2021-07-01,2021-07-21&amp;orderBy=lastUpdated(desc),name(asc)&amp;computeTotal=True
</pre></div>
</div>
<p>The response will look something like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
          <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;79234b2a-0995-4632-956e-b940d10607ba-007&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SyRunSleepSecondsNoIPFiles-2&quot;</span><span class="p">,</span>
          <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
          <span class="s2">&quot;appId&quot;</span><span class="p">:</span> <span class="s2">&quot;SyRunSleepSecondsNoIPFiles-2&quot;</span><span class="p">,</span>
          <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-20T23:56:02.616Z&quot;</span><span class="p">,</span>
          <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;FINISHED&quot;</span><span class="p">,</span>
          <span class="s2">&quot;remoteStarted&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-20T23:56:20.368Z&quot;</span><span class="p">,</span>
          <span class="s2">&quot;ended&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-20T23:56:54.409Z&quot;</span><span class="p">,</span>
          <span class="s2">&quot;tenant&quot;</span><span class="p">:</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
          <span class="s2">&quot;execSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec2&quot;</span><span class="p">,</span>
          <span class="s2">&quot;archiveSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec&quot;</span><span class="p">,</span>
          <span class="s2">&quot;appVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-20T23:56:54.409Z&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
          <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;432f7018-070d-41c3-ba0e-a685f7f11e5c-007&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SlurmSleepSeconds&quot;</span><span class="p">,</span>
          <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
          <span class="s2">&quot;appId&quot;</span><span class="p">:</span> <span class="s2">&quot;SlurmSleepSecondsVM&quot;</span><span class="p">,</span>
          <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-20T23:16:01.629Z&quot;</span><span class="p">,</span>
          <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;FINISHED&quot;</span><span class="p">,</span>
          <span class="s2">&quot;remoteStarted&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-20T23:16:24.781Z&quot;</span><span class="p">,</span>
          <span class="s2">&quot;ended&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-20T23:16:58.745Z&quot;</span><span class="p">,</span>
          <span class="s2">&quot;tenant&quot;</span><span class="p">:</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
          <span class="s2">&quot;execSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec2-slurm&quot;</span><span class="p">,</span>
          <span class="s2">&quot;archiveSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec&quot;</span><span class="p">,</span>
          <span class="s2">&quot;appVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span>
          <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-07-20T23:16:58.745Z&quot;</span>
      <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
  <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_SEARCH_RESULT_LIST_RETRIEVED Jobs search list for the user testuser2 in the tenant dev retrieved.&quot;</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0-rc1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;recordCount&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;recordLimit&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;recordsSkipped&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;orderBy&quot;</span><span class="p">:</span> <span class="s2">&quot;lastUpdated(desc),name(asc)&quot;</span><span class="p">,</span>
      <span class="s2">&quot;startAfter&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
      <span class="s2">&quot;totalCount&quot;</span><span class="p">:</span> <span class="mi">246</span>
  <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="search-using-post-on-dedicated-endpoint">
<h3>Search using POST on Dedicated Endpoint<a class="headerlink" href="#search-using-post-on-dedicated-endpoint" title="Link to this heading"></a></h3>
<p>A user can make complex queries to Jobs service by specifying SQL-like syntax in the request body to the end-point /v3/jobs/search.
An example request body in json format is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;search&quot;</span><span class="p">:</span>
    <span class="p">[</span>
      <span class="s2">&quot;(status = &#39;FINISHED&#39; AND name = &#39;SleepSeconds&#39;) &quot;</span><span class="p">,</span>
      <span class="s2">&quot; OR (tags IN (&#39;test&#39;))&quot;</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With cURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>curl --location &#39;$BASE_URL/v3/jobs/search?listType=ALL_JOBS&amp;limit=2&amp;computeTotal=True&amp;select=name%2Ctags%2Cstatus%2CappId&#39; \
--header &#39;X-Tapis-Token: $jwt&#39; \
--header &#39;Content-Type: application/json&#39; \
--data &#39;{
  &quot;search&quot;:
  [
     &quot;(status = &#39;\&#39;&#39;FINISHED&#39;\&#39;&#39; AND name = &#39;\&#39;&#39;SleepSeconds&#39;\&#39;&#39;) &quot;,
     &quot; OR (tags IN (&#39;\&#39;&#39;test&#39;\&#39;&#39;))&quot;
     ]
   }&#39;
</pre></div>
</div>
<p>The response looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SleepSecondsLoadTest&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;FINISHED&quot;</span><span class="p">,</span>
        <span class="s2">&quot;appId&quot;</span><span class="p">:</span> <span class="s2">&quot;SleepSeconds-Load&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;sleep&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;e17edea6-33f8-441c-867c-d9d23509dd55-007&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SleepSecondsLoadTest&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;FINISHED&quot;</span><span class="p">,</span>
        <span class="s2">&quot;appId&quot;</span><span class="p">:</span> <span class="s2">&quot;SleepSeconds-Load&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;sleep&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;a3a539a9-c0e5-4a02-82c3-0dfbcada47f9-007&quot;</span>
    <span class="p">}</span>
<span class="p">],</span>
<span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_SEARCH_RESULT_LIST_RETRIEVED Jobs search list for the user testuser2 in the tenant dev retrieved. &quot;</span><span class="p">,</span>
<span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.3.0&quot;</span><span class="p">,</span>
<span class="s2">&quot;commit&quot;</span><span class="p">:</span> <span class="s2">&quot;ee1b3342&quot;</span><span class="p">,</span>
<span class="s2">&quot;build&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-03-01T15:42:55Z&quot;</span><span class="p">,</span>
<span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;recordCount&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;recordLimit&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;recordsSkipped&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;orderBy&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;startAfter&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;totalCount&quot;</span><span class="p">:</span> <span class="mi">27345</span>
<span class="p">}}</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="job-actions">
<h2>Job Actions<a class="headerlink" href="#job-actions" title="Link to this heading"></a></h2>
<section id="job-cancel">
<h3>Job Cancel<a class="headerlink" href="#job-cancel" title="Link to this heading"></a></h3>
<p>A previously submitted job not in terminal state can be cancelled by its UUID.</p>
<p>With PySDK:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ t.jobs.cancelJob(jobUuid=&#39;19b06299-4e7c-4b27-ae77-2258e9dc4734-007&#39;)
</pre></div>
</div>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -X POST -H &quot;X-Tapis-Token:$jwt&quot; $BASE_URL/v3/jobs/19b06299-4e7c-4b27-ae77-2258e9dc4734-007/cancel
</pre></div>
</div>
<p>The response will look something like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="p">{</span>
 <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_JOB_CANCEL_ACCEPTED Request to cancel job 19b06299-4e7c-4b27-ae77-2258e9dc4734-007 has been accepted. &quot;</span>
 <span class="p">},</span>
 <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
 <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_JOB_CANCEL_ACCEPTED_DETAILS Request to cancel job 19b06299-4e7c-4b27-ae77-2258e9dc4734-007 has been accepted. If the job is in a terminal state, the request will have no effect. If the job is transitioning between active and blocked states, another cancel request may need to be sent.&quot;</span><span class="p">,</span>
 <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.2.1&quot;</span><span class="p">,</span>
 <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">null</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="hide-job">
<h3>Hide Job<a class="headerlink" href="#hide-job" title="Link to this heading"></a></h3>
<p>With PySDK:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ t.jobs.hideJob(jobUuid=&#39;19b06299-4e7c-4b27-ae77-2258e9dc4734-007&#39;)
</pre></div>
</div>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -X POST -H &quot;X-Tapis-Token:$jwt&quot; $BASE_URL/v3/jobs/19b06299-4e7c-4b27-ae77-2258e9dc4734-007/hide
</pre></div>
</div>
<p>The response will look something like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="p">{</span>
 <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_JOB_CHANGED_VISIBILITY Job 19b06299-4e7c-4b27-ae77-2258e9dc4734-007 has been changed to hidden.&quot;</span>
 <span class="p">},</span>
 <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
 <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_JOB_CHANGED_VISIBILITY Job 19b06299-4e7c-4b27-ae77-2258e9dc4734-007 has been changed to hidden.&quot;</span><span class="p">,</span>
 <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.2.1&quot;</span><span class="p">,</span>
 <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">null</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="unhide-job">
<h3>Unhide Job<a class="headerlink" href="#unhide-job" title="Link to this heading"></a></h3>
<p>With PySDK:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ t.jobs.unhideJob(jobUuid=&#39;19b06299-4e7c-4b27-ae77-2258e9dc4734-007&#39;)
</pre></div>
</div>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -X POST -H &quot;X-Tapis-Token:$jwt&quot; $BASE_URL/v3/jobs/19b06299-4e7c-4b27-ae77-2258e9dc4734-007/unhide
</pre></div>
</div>
<p>The response will look something like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_JOB_CHANGED_VISIBILITY Job 19b06299-4e7c-4b27-ae77-2258e9dc4734-007 has been changed to unhidden.&quot;</span>
<span class="p">},</span>
<span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_JOB_CHANGED_VISIBILITY Job 19b06299-4e7c-4b27-ae77-2258e9dc4734-007 has been changed to unhidden.&quot;</span><span class="p">,</span>
<span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.2.1&quot;</span><span class="p">,</span>
<span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">null</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="job-sharing">
<h2>Job Sharing<a class="headerlink" href="#job-sharing" title="Link to this heading"></a></h2>
<section id="share-a-job">
<h3>Share a Job<a class="headerlink" href="#share-a-job" title="Link to this heading"></a></h3>
<p>A previously submitted job can be shared with a user in the same tenant. Job resources that can shared are: JOB_HISTORY, JOB_RESUBMIT_REQUEST, JOB_OUTPUT. Currently only READ permission on the resources are allowed.</p>
<p>With PySDK:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ t.jobs.shareJob(jobUuid=&#39;ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007&#39;,
     jobResource=[&quot;JOB_HISTORY&quot;,&quot;JOB_RESUBMIT_REQUEST&quot;,&quot;JOB_OUTPUT&quot;],
     jobPermission=&#39;READ&#39;,
     grantee=&#39;testuser6&#39;)
</pre></div>
</div>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -X POST -H &quot;X-Tapis-Token:$jwt&quot; $BASE_URL/v3/jobs/ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007/share -d &#39;{
 &quot;jobResource&quot;: [&quot;JOB_HISTORY&quot;, &quot;JOB_RESUBMIT_REQUEST&quot;, &quot;JOB_OUTPUT&quot;], &quot;jobPermission&quot;: &quot;READ&quot;, &quot;grantee&quot;: &quot;testuser6&quot;}&#39;
</pre></div>
</div>
<p>The response will look something like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="p">{</span>
 <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_JOB_SHARED The job ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007 resource is shared by testuser2 to testuser6 in tenant dev&quot;</span>
 <span class="p">},</span>
 <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
 <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_JOB_SHARED The job ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007 resource is shared by testuser2 to testuser6 in tenant dev&quot;</span><span class="p">,</span>
 <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.2.1&quot;</span><span class="p">,</span>
 <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">null</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="get-job-share-information">
<h3>Get Job Share Information<a class="headerlink" href="#get-job-share-information" title="Link to this heading"></a></h3>
<p>With PySDK:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ t.jobs.getJobShare(jobUuid=&#39;ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007&#39;)
</pre></div>
</div>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -H &quot;X-Tapis-Token:$jwt&quot; $BASE_URL/v3/jobs/ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007/share
</pre></div>
</div>
<p>The response will look something like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;tenant&quot;</span><span class="p">:</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
        <span class="s2">&quot;createdby&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobUuid&quot;</span><span class="p">:</span> <span class="s2">&quot;ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007&quot;</span><span class="p">,</span>
        <span class="s2">&quot;grantee&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobResource&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB_HISTORY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobPermission&quot;</span><span class="p">:</span> <span class="s2">&quot;READ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-06-16T14:53:31.899199Z&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;tenant&quot;</span><span class="p">:</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
        <span class="s2">&quot;createdby&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobUuid&quot;</span><span class="p">:</span> <span class="s2">&quot;ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007&quot;</span><span class="p">,</span>
        <span class="s2">&quot;grantee&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobResource&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB_OUTPUT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobPermission&quot;</span><span class="p">:</span> <span class="s2">&quot;READ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-06-16T14:53:32.004831Z&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;tenant&quot;</span><span class="p">:</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
        <span class="s2">&quot;createdby&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobUuid&quot;</span><span class="p">:</span> <span class="s2">&quot;ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007&quot;</span><span class="p">,</span>
        <span class="s2">&quot;grantee&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobResource&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB_HISTORY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobPermission&quot;</span><span class="p">:</span> <span class="s2">&quot;READ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-06-16T17:17:50.981844Z&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;tenant&quot;</span><span class="p">:</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
        <span class="s2">&quot;createdby&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobUuid&quot;</span><span class="p">:</span> <span class="s2">&quot;ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007&quot;</span><span class="p">,</span>
        <span class="s2">&quot;grantee&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobResource&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB_RESUBMIT_REQUEST&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobPermission&quot;</span><span class="p">:</span> <span class="s2">&quot;READ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-06-16T17:17:51.059726Z&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;tenant&quot;</span><span class="p">:</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
        <span class="s2">&quot;createdby&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobUuid&quot;</span><span class="p">:</span> <span class="s2">&quot;ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007&quot;</span><span class="p">,</span>
        <span class="s2">&quot;grantee&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser6&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobResource&quot;</span><span class="p">:</span> <span class="s2">&quot;JOB_OUTPUT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;jobPermission&quot;</span><span class="p">:</span> <span class="s2">&quot;READ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-07-14T19:57:15.838019Z&quot;</span>
    <span class="p">}</span>
<span class="p">],</span>
<span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_JOB_SHARE_INFO_RETRIEVED Share information retrieved for the job ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007 for user testuser2 in tenant dev.&quot;</span><span class="p">,</span>
<span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.2.1&quot;</span><span class="p">,</span>
<span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;recordCount&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s2">&quot;recordLimit&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;recordsSkipped&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;orderBy&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;startAfter&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;totalCount&quot;</span><span class="p">:</span> <span class="mi">5</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="unshare-job">
<h3>Unshare Job<a class="headerlink" href="#unshare-job" title="Link to this heading"></a></h3>
<p>With PySDK:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ t.jobs.deleteJobShare(jobUuid=&#39;ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007&#39;, user=&#39;testuser6&#39;)
</pre></div>
</div>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -X DELETE -H &quot;X-Tapis-Token:$jwt&quot; $BASE_URL/v3/jobs/ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007/share/testuser6
</pre></div>
</div>
<p>The response will look something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_JOB_UNSHARED The job ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007 resource is unshared by testuser2 to testuser6 in tenant dev&quot;</span>
<span class="p">},</span>
<span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_JOB_UNSHARED The job ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007 resource is unshared by testuser2 to testuser6 in tenant dev&quot;</span><span class="p">,</span>
<span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.2.1&quot;</span><span class="p">,</span>
<span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">null</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="list-shared-jobs">
<h3>List Shared Jobs<a class="headerlink" href="#list-shared-jobs" title="Link to this heading"></a></h3>
<p>The query parameter listType=SHARED_JOBS in the jobs list end-point allows to  list all shared jobs for a user, say testuser6, using testuser6’s JWT. Note testuser6 is not the owner of the jobs listed. Default value for listType is MY_JOBS and to list all jobs including both shared and testuser6 owned job, listType=ALL_JOBS.</p>
<p>With PySDK:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ t.jobs.getJobList(listType=&#39;SHARED_JOBS&#39;)
</pre></div>
</div>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -H &quot;X-Tapis-Token:$jwt&quot; $BASE_URL/v3/jobs/list?listType=SHARED_JOBS
</pre></div>
</div>
<p>The response will look something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
      <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;ccec730b-22ad-4088-a87e-bb8cfb2ab2e6-007&quot;</span><span class="p">,</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SleepSeconds&quot;</span><span class="p">,</span>
      <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
      <span class="s2">&quot;appId&quot;</span><span class="p">:</span> <span class="s2">&quot;SleepSeconds&quot;</span><span class="p">,</span>
      <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-04-09T02:47:57.760Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;FINISHED&quot;</span><span class="p">,</span>
      <span class="s2">&quot;remoteStarted&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-04-09T02:48:08.946Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;ended&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-04-09T02:48:16.669Z&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tenant&quot;</span><span class="p">:</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
      <span class="s2">&quot;execSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec2&quot;</span><span class="p">,</span>
      <span class="s2">&quot;archiveSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec&quot;</span><span class="p">,</span>
      <span class="s2">&quot;appVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-04-09T02:48:16.669Z&quot;</span>
  <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
  <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_LIST_RETRIVED Jobs list for the user testuser6 in the tenant dev retrived.&quot;</span><span class="p">,</span>
  <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.2.1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
  <span class="s2">&quot;recordCount&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;recordLimit&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
  <span class="s2">&quot;recordsSkipped&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s2">&quot;orderBy&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;startAfter&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
  <span class="s2">&quot;totalCount&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
  <span class="p">}</span>
  <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="job-search-on-shared-job">
<h3>Job Search on Shared Job<a class="headerlink" href="#job-search-on-shared-job" title="Link to this heading"></a></h3>
<p>Job search on a list of jobs can be performed using the query parameter listType=SHARED_JOBS in the search end-point.</p>
<p>In the following example, we use testuser5 JWT to do job search on list of jobs shared with testuser5.</p>
<p>With CURL:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>$ curl -H &quot;X-Tapis-Token:$jwt&quot; &#39;$BASE_URL/v3/jobs/search?listType=SHARED_JOBS&amp;name.eq=SleepSeconds&amp;created.between=2022-07-05,2022-07-06&#39;
</pre></div>
</div>
<p>The response will look something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;3b9cb514-4962-44e8-a851-55e933e558c0-007&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SleepSeconds&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;appId&quot;</span><span class="p">:</span> <span class="s2">&quot;SleepSeconds&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-07-05T21:34:11.355Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;FINISHED&quot;</span><span class="p">,</span>
        <span class="s2">&quot;remoteStarted&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-07-05T21:34:48.776Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ended&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-07-05T21:35:31.808Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tenant&quot;</span><span class="p">:</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
        <span class="s2">&quot;execSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;archiveSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec&quot;</span><span class="p">,</span>
        <span class="s2">&quot;appVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-07-05T21:35:31.808Z&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;uuid&quot;</span><span class="p">:</span> <span class="s2">&quot;eacde4c4-1d93-4393-b220-63aea509b32c-007&quot;</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;SleepSeconds&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;testuser2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;appId&quot;</span><span class="p">:</span> <span class="s2">&quot;SleepSeconds&quot;</span><span class="p">,</span>
        <span class="s2">&quot;created&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-07-05T21:43:05.371Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;FINISHED&quot;</span><span class="p">,</span>
        <span class="s2">&quot;remoteStarted&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-07-05T21:43:44.899Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ended&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-07-05T21:44:27.509Z&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tenant&quot;</span><span class="p">:</span> <span class="s2">&quot;dev&quot;</span><span class="p">,</span>
        <span class="s2">&quot;execSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;archiveSystemId&quot;</span><span class="p">:</span> <span class="s2">&quot;tapisv3-exec&quot;</span><span class="p">,</span>
        <span class="s2">&quot;appVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;0.0.1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lastUpdated&quot;</span><span class="p">:</span> <span class="s2">&quot;2022-07-05T21:44:27.509Z&quot;</span>
    <span class="p">}</span>
<span class="p">],</span>
<span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
<span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;JOBS_SEARCH_RESULT_LIST_RETRIEVED Jobs search list for the user testuser5 in the tenant dev retrieved.&quot;</span><span class="p">,</span>
<span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.2.1&quot;</span><span class="p">,</span>
<span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;recordCount&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;recordLimit&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;recordsSkipped&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;orderBy&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;startAfter&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s2">&quot;totalCount&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="share-job-output">
<h3>Share Job Output<a class="headerlink" href="#share-job-output" title="Link to this heading"></a></h3>
<p>As shown in the previous example of share a job, job output resource can be shared with a user, say testuser5, in the same tenant. This includes testuser5 can do job output listing and job output download with its own JWT even though its not the owner of the job.</p>
</section>
<section id="share-job-history">
<h3>Share Job History<a class="headerlink" href="#share-job-history" title="Link to this heading"></a></h3>
<p>As shown in the previous example of share a job, job history can be shared with a user, say testuser5, in the same tenant. This includes testuser5 can get job’s history, status and job’s detail information for jobs that are shared with it using its own JWT.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, ICICLE.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>